/*!
 * qlik-funnel-chart-ext v0.7.8
 * Copyright (c) 2019 QlikTech International AB
 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("qlik"));else if("function"==typeof define&&define.amd)define(["qlik"],e);else{var n="object"==typeof exports?e(require("qlik")):e(t.qlik);for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,c=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===a.call(t)},u=function(t){if(!t||"[object Object]"!==a.call(t))return!1;var e,n=i.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&i.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||i.call(t,e)},l=function(t,e){o&&"__proto__"===e.name?o(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},h=function(t,e){if("__proto__"===e){if(!i.call(t,e))return;if(s)return s(t,e).value}return t[e]};t.exports=function t(){var e,n,i,a,o,s,f=arguments[0],d=1,p=arguments.length,g=!1;for("boolean"==typeof f&&(g=f,f=arguments[1]||{},d=2),(null==f||"object"!==r(f)&&"function"!=typeof f)&&(f={});d<p;++d)if(null!=(e=arguments[d]))for(n in e)i=h(f,n),f!==(a=h(e,n))&&(g&&a&&(u(a)||(o=c(a)))?(o?(o=!1,s=i&&c(i)?i:[]):s=i&&u(i)?i:{},l(f,{name:n,newValue:t(g,s,a)})):void 0!==a&&l(f,{name:n,newValue:a}));return f}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={};function i(){i.init.call(this)}r.isObject=function(t){return"object"===n(t)&&null!==t},r.isNumber=function(t){return"number"==typeof t},r.isUndefined=function(t){return void 0===t},r.isFunction=function(t){return"function"==typeof t},t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(t){if(!r.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,a,o,s;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],r.isUndefined(n))return!1;if(r.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];n.apply(this,a)}else if(r.isObject(n)){for(i=arguments.length,a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];for(i=(s=n.slice()).length,o=0;o<i;o++)s[o].apply(this,a)}return!0},i.prototype.addListener=function(t,e){var n;if(!r.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r.isFunction(e.listener)?e.listener:e),this._events[t]?r.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r.isObject(this._events[t])&&!this._events[t].warned)&&((n=r.isUndefined(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,r.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),r.isFunction(console.trace)&&console.trace()));return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!r.isFunction(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var n,i,a,o;if(!r.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(n=this._events[t]).length,i=-1,n===e||r.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r.isObject(n)){for(o=a;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){i=o;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?r.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){return t._events&&t._events[e]?r.isFunction(t._events[e])?1:t._events[e].length:0}},function(t,e,n){"use strict";(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return(r="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(t){return n(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e,n){return(u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&c(i,n.prototype),i}).apply(null,arguments)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=Object.prototype.hasOwnProperty,d=Object.prototype.toString,p=Object.defineProperty,g=Object.getOwnPropertyDescriptor,y=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===d.call(t)},v=function(t){if(!t||"[object Object]"!==d.call(t))return!1;var e,n=f.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&f.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||f.call(t,e)},m=function(t,e){p&&"__proto__"===e.name?p(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},x=function(t,e){if("__proto__"===e){if(!f.call(t,e))return;if(g)return g(t,e).value}return t[e]},b=function t(){var e,r,i,a,o,s,c=arguments[0],u=1,l=arguments.length,h=!1;for("boolean"==typeof c&&(h=c,c=arguments[1]||{},u=2),(null==c||"object"!==n(c)&&"function"!=typeof c)&&(c={});u<l;++u)if(null!=(e=arguments[u]))for(r in e)i=x(c,r),c!==(a=x(e,r))&&(h&&a&&(v(a)||(o=y(a)))?(o?(o=!1,s=i&&y(i)?i:[]):s=i&&v(i)?i:{},m(c,{name:r,newValue:t(h,s,a)})):void 0!==a&&m(c,{name:r,newValue:a}));return c};function w(t,e,n){if(!t)return-1;var r=n.cache,i=t.origin?t.origin():null;i&&(t=i);var a=r.fields.indexOf(t),o=-1,s=-1;if(-1===a)for(var c=0;c<r.wrappedFields.length;c++)if(s=r.wrappedFields[c].attrDims.map(function(t){return t.instance}).indexOf(t),o=r.wrappedFields[c].attrExps.map(function(t){return t.instance}).indexOf(t),-1!==s||-1!==o){a=c;break}return(a-=e.qArea.qLeft)<0||a>=e.qArea.qWidth?-1:s>=0?function(t){return t[a].qAttrDims.qValues[s]}:o>=0?function(t){return t[a].qAttrExps.qValues[o]}:function(t){return t[a]}}function k(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function M(t,e,n,i){var a=Array.isArray(t)?t:[t],o=[];return a.forEach(function(t){if(void 0!==t.field){var a=e.raw(),s=e.key(),c="object"===r(t.field)?t.field:e.field(t.field),u=i.normalizeConfig(t,e),l=u.props,f=u.main,d=Object.keys(l),p=!!t.trackBy,g=r(t.trackBy),y={},v=[],m=[];a.qDataPages.forEach(function(e){var r=w(c,e,{cache:n});-1!==r&&e.qMatrix.forEach(function(a,o){var u=e.qArea.qTop+o,h=b({qRow:u},r(a)),x=k(f,h,{key:s});f.filter&&!f.filter(h)||(d.forEach(function(t){var r=l[t],i=r.fields||[r];if(r.fields&&(x[t]=[]),i.forEach(function(i,o){!function(t){var e=t.cache,n=t.f,r=t.mainCell,i=t.p,a=(t.prop,t.page),o=t.rowIdx,s=t.row,c=t.sourceKey,u=t.target,l=t.targetProp,h=r;if(i.field&&i.field!==n){var f=w(i.field,a,{cache:e});if(-1===f)return;h=b({qRow:o},f(s))}u[l]=k(i,h,{key:c})}({cache:n,f:c,mainCell:h,p:i,prop:t,props:l,page:e,rowIdx:u,row:a,sourceKey:s,target:r.fields?x[t]:x,targetProp:r.fields?o:t})}),r.fields){var o=x[t].map(function(t){return t.value}),f=x[t].map(function(t){return t.label});x[t]={value:"function"==typeof r.value?r.value(o):void 0!==r.value?r.value:o,label:"function"==typeof r.label?r.label(f):void 0!==r.label?String(r.label):String(x[t].value)}}}),p&&i.track({cfg:t,itemData:h,obj:x,target:v,tracker:y,trackType:g}),m.push(x))})}),p?o.push.apply(o,h(i.collect(v,{main:f,propsArr:d,props:l}))):o.push.apply(o,m)}}),o}function _(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function S(t,e){var n,r,i,a,o,s=new N(t),c=+t.value&&(s.value=t.value),u=[s];for(null==e&&(e=R);n=u.pop();)if(c&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)u.push(r=n.children[a]=new N(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(C)}function R(t){return t.children}function A(t){t.data=t.data.data}function C(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function N(t){this.data=t,this.depth=this.height=0,this.parent=null}function O(t){if("function"!=typeof t)throw new Error;return t}N.prototype=S.prototype={constructor:N,count:function(){return this.eachAfter(_)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return S(this).eachBefore(A)}};var T="$",E={depth:-1},D={};function z(t){return t.id}function j(t){return t.parentId}function q(t,e){"/"===t.charAt(0)&&(t=t.substring(1));for(var n,r=t.split("/"),i=e,a=0;a<r.length;a++){if("*"===r[a]&&Array.isArray(i)){var o=[];n=r.slice(a+1).join("/");for(var s=0;s<i.length;s++){var c=q(n,i[s]);Array.isArray(c)?o.push.apply(o,h(c)):o.push(c)}return o}if(!r[a]&&Array.isArray(i)){var u=new Array(i.length);n=r.slice(a+1).join("/");for(var l=0;l<i.length;l++)u[l]=q(n,i[l]);return u}r[a]in i&&(i=i[r[a]])}return i}function P(t,e,n){if(t===e)return function(t){return t};if(t>e){var r=Math.max(0,Math.min(100,t-e)),i=h(Array(r)).map(String.prototype.valueOf,"parent").join(".");return Function("node","return node.".concat(i,";"))}if(e>t){var a=Math.max(0,Math.min(100,e-t));return function(t){return function t(e,n,r){var i=[];if(!e||!e.length)return i;if(n<=0){var a=r>=0?[e[r]]:e;i.push.apply(i,h(a))}else for(var o=0;o<e.length;o++)e[o].children&&e[o].children.length&&i.push.apply(i,h(t(e[o].children,n-1,r)));return i}(t.children,a-1,n)}}return!1}var I=/^qDimensionInfo(?:\/(\d+))?/,F=/^\/?qMeasureInfo\/(\d+)/,L=/\/qAttrExprInfo\/(\d+)/,B=/\/qAttrDimInfo\/(\d+)/;function W(t){return(t.qColumnOrder&&t.qColumnOrder.length?t.qColumnOrder:t.qDimensionInfo.map(function(t,e){return e})).filter(function(e){return e<t.qDimensionInfo.length})}function V(t,e){var n=e.cube;if(!t)return-1;var r=t.origin&&t.origin()?t.origin().key():t.key(),i=!1,a=-1,o=-1,s=-1,c=-1,u=-1,l=r,h=n.qEffectiveInterColumnSortOrder,f=W(n);return I.test(l)&&(i=!0,a=+I.exec(l)[1],l=r.replace(I,"")),F.test(l)&&("K"===n.qMode?c=+F.exec(l)[1]:h&&-1!==h.indexOf(-1)?(c=+F.exec(l)[1],u=0):u=+F.exec(l)[1],l=l.replace(F,"")),l&&(B.exec(l)?s=+B.exec(l)[1]:L.exec(l)&&(o=+L.exec(l)[1])),{fieldDepth:(i?"S"===n.qMode?f[a]:h?h.indexOf(a):a:h&&-1!==h.indexOf(-1)?h.indexOf(-1):n.qDimensionInfo.length-("K"===n.qMode?0:1))+1,pseudoMeasureIndex:c,measureIdx:u,attrDimIdx:s,attrIdx:o}}function H(t,e){var n,r,i=P(t.fieldDepth,e.fieldDepth,e.pseudoMeasureIndex);return n=e.measureIdx>=0?function(t){return t.data.qValues[e.measureIdx]}:function(t){return t.data},e.attrDimIdx>=0?r=function(t){return t.qAttrDims.qValues[e.attrDimIdx]}:e.attrIdx>=0&&(r=function(t){return t.qAttrExps.qValues[e.attrIdx]}),{nodeFn:i,attrFn:r,valueFn:n}}function U(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function $(t){var e=t.propsArr,n=t.props,r=t.item,i=t.itemData,a=t.ret,o=t.sourceKey;e.forEach(function(t){var e,s,c=n[t],u=c.fields||[c];c.fields&&(e=[],s=[]),u.forEach(function(n){var u,l,h,f,d,p;if("primitive"===n.type?(h=n.value,p=String(n.value)):("function"==typeof n.value&&(u=function(t){return n.value(t,r)}),"function"==typeof n.label&&(l=function(t){return n.label(t,r)}),n.accessor?(f=n.accessor(r),Array.isArray(f)?(d=f.map(n.valueAccessor),n.attrAccessor&&(d=d.map(n.attrAccessor)),u&&(h=d.map(u),u=null),l&&(p=d.map(l),l=null),h=n.reduce?n.reduce(h):h,p=n.reduceLabel?n.reduceLabel(p,h):String(h)):p=h=n.attrAccessor?n.attrAccessor(n.valueAccessor(f)):n.valueAccessor(f)):(h=i,p=i)),c.fields){var g=u?u(h):h;e.push(g),s.push(l&&null!=p?l(p):null!=p?p:String(g))}else{var y=u?u(h):h;a[t]={value:y,label:l?l(p):null!=p?p:String(y)},n.field&&(a[t].source={field:n.field.key(),key:o})}}),e&&(a[t]={value:"function"==typeof c.value?c.value(e,r):e,label:"function"==typeof c.label?c.label(s,r):s})})}var Y=function(t,e,n){var r="K"===t.qMode?"/qStackedDataPages/*/qData":"/qTreeDataPages/*",i="K"===t.qMode?"qSubNodes":"qNodes",a=q(r,t);return a&&a[0]?(e.tree=S(a[0],n.children||function(t){return t[i]}),e.tree):null};function X(t){for(var e=t.raw().qDataPages.length?t.raw().qDataPages[0].qMatrix:[],n=function(t){var e=t.raw().qColumnOrder,n=t.fields();return e&&e.length===n.length?e:n.map(function(t,e){return e})}(t),r=t.fields(),i=t.fields().filter(function(t){return"dimension"===t.type()}).map(function(t){return n.indexOf(r.indexOf(t))}),a=t.fields().filter(function(t){return"measure"===t.type()}).map(function(t){return n.indexOf(r.indexOf(t))}),o={__root:{__id:"__root",qValues:[]}},s=0;s<e.length;s++){for(var c=e[s],u="__root",l=!1,h=0;h<i.length;h++){var f=c[i[h]],d="".concat(u,"__").concat(f.qText);o[d]||(o[d]=Object.assign({__id:d,__parent:u,qValues:[]},f),l=!0),u=d}if(l)for(var p=0;p<a.length;p++){var g=c[a[p]];o[u].qValues.push(g)}}var y=Object.keys(o).map(function(t){return o[t]});return function(){var t=z,e=j;function n(n){var r,i,a,o,s,c,u,l=n.length,h=new Array(l),f={};for(i=0;i<l;++i)r=n[i],s=h[i]=new N(r),null!=(c=t(r,i,n))&&(c+="")&&(f[u=T+(s.id=c)]=u in f?D:s);for(i=0;i<l;++i)if(s=h[i],null!=(c=e(n[i],i,n))&&(c+="")){if(!(o=f[T+c]))throw new Error("missing: "+c);if(o===D)throw new Error("ambiguous: "+c);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=E,a.eachBefore(function(t){t.depth=t.parent.depth+1,--l}).eachBefore(C),a.parent=null,l>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=O(e),n):t},n.parentId=function(t){return arguments.length?(e=O(t),n):e},n}().id(function(t){return t.__id}).parentId(function(t){return t.__parent})(y)}var K=function(t){var e=t.propsArr,n=t.props,r=t.cube,i=t.cache,a=t.itemDepthObject,o=t.f;e.forEach(function(t){var e=n[t];(e.fields?e.fields:[e]).forEach(function(t){if(t.field!==o){var e=V(t.field,{cube:r,cache:i}),n=H(a,e);t.accessor=n.nodeFn,t.valueAccessor=n.valueFn,t.attrAccessor=n.attrFn}})})};function G(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=e.raw(),a=e.key(),o="S"===i.qMode?X(e):Y(i,n,t);if(!o)return null;for(var s=o.height,c=[],u=0;u<=s;u++){var l=null;if(u>0)if("S"===i.qMode){var h=W(i)[u-1];l=n.fields[h]}else{var f=i.qEffectiveInterColumnSortOrder[u-1];u>i.qEffectiveInterColumnSortOrder.length&&(f=i.qDimensionInfo.length),l=n.fields[f]}var d=r.normalizeConfig(Object.assign({},t,{field:l?l.key():void 0}),e),p=d.props,g=d.main,y=Object.keys(p);c[u]={propsArr:y,props:p,main:g};var v=l?V(l,{cube:i,cache:n}):{fieldDepth:0};K({propsArr:y,props:p,cube:i,cache:n,itemDepthObject:v,f:l})}var m=o.copy().descendants();return o.descendants().forEach(function(t,e){var n=c[t.depth].propsArr,r=c[t.depth].props,i=c[t.depth].main,o=m[e],s=o.data,u=U(i,s,{key:a});$({propsArr:n,props:r,item:o,itemData:s,ret:u,sourceKey:a,isTree:!0}),t.data=u}),o}function Z(t,e,n,i){var a=Array.isArray(t)?t:[t],o=[];return a.forEach(function(a){if(void 0!==a.field){var s=e.raw(),c=e.key();if(!Y(s,n,t))return;var u="object"===r(a.field)?a.field:e.field(a.field),l=i.normalizeConfig(a,e),f=l.props,d=l.main,p=Object.keys(f),g=V(u,{cube:s,cache:n}),y=H({fieldDepth:0},g),v=y.nodeFn,m=y.attrFn,x=y.valueFn;K({propsArr:p,props:f,cube:s,cache:n,itemDepthObject:g,f:u});for(var b=!!a.trackBy,w=r(a.trackBy),k={},M=[],_=v(n.tree),S=[],R=0;R<_.length;R++){var A=_[R],C=m?m(x(A)):x(A);if(!(d.filter&&!d.filter(C))){var N=U(d,C,{key:c});$({propsArr:p,props:f,item:A,itemData:C,ret:N,sourceKey:c}),b&&i.track({cfg:a,itemData:C,obj:N,target:M,tracker:k,trackType:w}),S.push(N)}}b?o.push.apply(o,h(i.collect(M,{main:d,propsArr:p,props:f}))):o.push.apply(o,S)}}),o}"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self;var J,Q=(function(t){
/*! javascript-number-formatter - v1.1.11 - http://mottie.github.com/javascript-number-formatter/ * © ecava */
t.exports=function(t,e){if(!t||isNaN(+e))return e;var n,r,i,a,o,s,c,u,l,h,f=t.length,d=t.search(/[0-9\-\+#]/),p=d>0?t.substring(0,d):"",g=t.split("").reverse().join(""),y=g.search(/[0-9\-\+#]/),v=f-y,m=t.substring(v,v+1),x=v+("."===m||","===m?1:0),b=y>0?t.substring(x,f):"";if(t=t.substring(d,x),e="-"===t.charAt(0)?-e:+e,n=e<0?e=-e:0,r=t.match(/[^\d\-\+#]/g),i=r&&r[r.length-1]||".",a=r&&r[1]&&r[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(u=e.split("."))[1]||u[1]&&u[1].length<=s)&&(e=(+e).toFixed(s+1)),l=t[0].split(a),t[0]=l.join(""),(o=t[0]&&t[0].indexOf("0"))>-1)for(;u[0].length<t[0].length-o;)u[0]="0"+u[0];else 0==+u[0]&&(u[0]="");if((e=e.split("."))[0]=u[0],c=l[1]&&l[l.length-1].length){for(h=e[0],g="",v=h.length%c,f=h.length,x=0;x<f;x++)g+=h.charAt(x),!((x-v+1)%c)&&x<f-c&&(g+=a);e[0]=g}return e[1]=t[1]&&e[1]?i+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1),p+(n?"-":"")+r+b}}(J={exports:{}},J.exports),J.exports);function tt(t){return t.replace(/[-[\]\/{}()*+?.\\^$|]/g,"\\$&")}var et={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},nt=/%$/,rt=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,it=/^\(oct\)/i,at=/^\(dec\)/i,ot=/^\(hex\)/i,st=/^\(bin\)/i,ct=/^\(rom\)/i,ut=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,lt=/#|0/g;function ht(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function ft(t,e,n){var r;return rt.test(e)?t=ht(t,Number(/\d{2}/.exec(e)[0]),e,n):it.test(e)?t=ht(t,8,e,n):at.test(e)?t=ht(t,10,e,n):ot.test(e)?t=ht(t,16,e,n):st.test(e)?t=ht(t,2,e,n):ct.test(e)&&(r="",t<0&&(r="-",t=-t),t=0===(t=Math.floor(t))?"0":t<=5e5?r+(t=function(t,e){for(var n,r="",i=Number(String(t).slice(-3)),a=(t-i)/1e3,o=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();i>0;)for(n=0;n<o.length;n++)if(o[n]<=i){r+=s[n],i-=o[n];break}for(n=0;n<a;n++)r="M".concat(r);return e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase()),r}(t,e)):e+r+t.toExponential(0)),t}function dt(t,e,n){var r=tt(t);return n?r:new RegExp(r||"",e)}function pt(t,e,n){var r,i,a,o,s,c,u,l,h,f,d,p=t.pattern;p.indexOf("A")>=0&&(p=p.replace("A",""),t.abbreviate=!0),f=e,(d=n)&&(d=tt(d)),f&&(f=tt(f)),h=new RegExp("(?:[#0]+".concat(f,")?[#0]+(?:").concat(d,"[#0]+)?")),o=(a=(a=p.match(h))?a[0]:"")?p.substr(0,p.indexOf(a)):p,s=a?p.substring(p.indexOf(a)+a.length):"",a||(a=p?"#":"##########"),e&&e===n&&(i=(r=a.split(n)).pop(),a=r.join("")+n+i,e=""),c=e,e=/,/.test(n)?"¤":",",c&&(a=a.replace(dt(c,"g"),e)),u=n,n=".",u&&(a=a.replace(dt(u,"g"),n)),l=(l=a.match(/#/g))?l.length:0;var g,y=p.split(u);y[1]&&(g=y[1].match(lt)),t.prefix=o||"",t.postfix=s||"",t.pattern=p,t.maxPrecision=g?g.length:2,t.percentage=nt.test(p),t.numericPattern=a||"",t.numericRegex=new RegExp("".concat(dt(e,null,!0),"|").concat(dt(n,null,!0)),"g"),t.groupTemp=c,t.decTemp=u,t.t=e,t.d=n,t.temp=l}var gt=function(){function t(e,n,r,a,o){i(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=a||".",this.type=o||"numeric",this.patternSeparator=";",this.abbreviations=function(t,e){if(!t||!t.qNumericalAbbreviation)return et;var n={};return t.qNumericalAbbreviation.split(e).forEach(function(t){var e=t.split(":");2===e.length&&(n[e[0]]=e[1])}),n}(e,this.patternSeparator),this.prepare()}return o(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){var r;void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t?(this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},r=this._prepared,t=t.split(this.patternSeparator),r.positive.pattern=t[0],r.negative.pattern=t[1],r.zero.pattern=t[2],ut.test(t[0])&&(r.positive.isFunctional=!0),t[1]?ut.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,t[2]?ut.test(t[2])&&(r.zero.isFunctional=!0):r.zero=!1,r.positive.isFunctional||pt(r.positive,e,n),r.negative&&!r.negative.isFunctional&&pt(r.negative,e,n),r.zero&&!r.zero.isFunctional&&pt(r.zero,e,n)):this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,a,o,s,c,u,l=this._prepared,h="",f="",d=t;if(isNaN(t))return"".concat(d);if(t=+t,!1===l.pattern)return t.toString();if(0===t&&l.zero)return(l=l.zero).pattern;if(t<0&&l.negative?(l=l.negative,t=-t):l=l.positive,a=l.d,o=l.t,l.isFunctional)t=ft(t,l.pattern,a);else{if(l.percentage&&(t*=100),l.abbreviate){var p,g,y=Object.keys(this.abbreviations).map(function(t){return parseInt(t,10)}).sort(function(t,e){return t-e}),v=y[0];for(s=0,n=Number(Number(t).toExponential().split("e")[1]);v<=n&&s<y.length;)v=y[++s];s>0&&(p=y[s-1]),p&&n>0&&p>0?g=p:(n<0&&p<0||!p)&&(v<0&&v-n<=l.maxPrecision?g=v:p<=n&&!(v>0&&-n<=l.maxPrecision)&&(g=p)),g&&(h=this.abbreviations[g],t/=Math.pow(10,g))}if(r=Math.abs(t),e=l.temp,u=(c=l.numericPattern).split(a)[1],"I"===this.type&&(t=Math.round(t)),i=t,u||"#"!==c.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var m=Number(t.toFixed(Math.min(20,u?u.length:0)).split(".")[0]),x=c.split(a)[0];if(t=Q(x+=a,m)||"0",u){var b=Math.max(0,Math.min(14,u.length)),w=u.replace(/#+$/,"").length,k=("I"===this.type?0:r%1).toFixed(b).slice(2).replace(/0+$/,"");for(s=k.length;s<w;s++)k+="0";k&&(t+=a+k)}else 0===m&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),f=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",a));else{for(c+=a,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),s=0;s<e;s++)c+="#";t=Q(c,t)}t=t.replace(l.numericRegex,function(t){return t===o?l.groupTemp:t===a?l.decTemp:""}),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return l.prefix+t+f+h+l.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}}}]),t}();function yt(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.size,a=void 0===i?5e3:i,o=r.multipleArguments,s=void 0!==o&&o,c=r.toKey,u=void 0===c?function(t){return t}:c,l=Object.create(null),h=Object.create(null),f=0,d=0;return(e=s?function(){return n=u.apply(void 0,arguments),e.has(n)?e.get(n):e.set(n,t.apply(void 0,arguments))}:function(r){return n=u(r),e.has(n)?e.get(n):e.set(n,t(r))}).set=function(t,e){return f>=a&&(delete l[h[d]],delete h[d],f--,d++),l[t]=e,h[f]=t,f++,e},e.get=function(t){return l[t]},e.has=function(t){return t in l},e.clear=function(){l=Object.create(null),h=Object.create(null),f=0,d=0},e.size=function(){return f},e}function vt(t,e,n,r,i){var a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(gt,e)}(i,t,e,n,r),o=yt(a.formatValue.bind(a),{toKey:function(t){return isNaN(t)?t:+t}});function s(t){return o(t)}return s.format=function(t,e,n,r){return o.clear(),a.format(e,t,n,r)},s.pattern=function(t){return t&&(o.clear(),a.pattern=t,a.prepare()),a.pattern},s}var mt={AUTO:"U",INTEGER:"I",NUMBER:"R",FIXED_TO:"F",MONEY:"M",DATE:"D",TIME:"T",DATE_TIME:"TS",INTERVAL:"IV"},xt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],bt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],wt=["January","February","March","April","May","June","July","August","September","October","November","December"],kt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Mt(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function _t(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}function St(t,e){var n,r=function(t){var e=t,n=24*_t(e),r=60*_t(n),i=60*_t(r),a=1e3*_t(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(a)}}(t),i=r.d,a=r.h,o=r.m,s=r.s,c=r.f,u=0;/w+|t+/gi.test(e)&&(n=new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,86400*(t-Math.floor(t)))),isNaN(n.getTime())&&(n=null)),/D+/gi.test(e)||(a+=24*i),/h+/gi.test(e)||(o+=60*a),/m+/gi.test(e)||(s+=60*o),/w+/gi.test(e)&&(u=n?n.getDay()-1:0)<0&&(u=6);var l="";return n&&(l=n.getUTCHours()>=12?"pm":"am"),{year:0,month:0,day:u,date:i,h:a,m:o,s:s,f:c,t:l}}var Rt=function(){function t(e,n,r){i(this,t);var a,o=e||{};(o.qCalendarStrings||(o.qCalendarStrings={qLongDayNames:xt,qDayNames:bt,qLongMonthNames:wt,qMonthNames:kt}),this.localeInfo=o,this.locale_days=o.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=o.qCalendarStrings.qDayNames.slice(),this.locale_months=o.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=o.qCalendarStrings.qMonthNames.slice(),n)||(n=(s(a={},mt.TIME,o.qTimeFmt||"hh:mm:ss"),s(a,mt.DATE,o.qDateFmt||"YYYY-MM-DD"),s(a,mt.DATE_TIME,o.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),a)[r]);this.pattern=n}return o(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+]|\[|]/g,"");var n,r,i,a,o,s=/t+/gi.test(e);t instanceof Date?(i=s,a=(r=t).getUTCHours(),o=r.getUTCDay()-1,i&&((a%=12)||(a=12)),o<0&&(o=6),n={year:r.getUTCFullYear(),month:r.getUTCMonth(),day:o,date:r.getUTCDate(),h:a,m:r.getUTCMinutes(),s:r.getUTCSeconds(),f:r.getUTCMilliseconds(),t:r.getUTCHours()>=12?"pm":"am"}):(t<0&&(t=-t,e="-".concat(e)),n=St(t,e));var c=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:Mt("".concat(e.year).slice(-2),2),YYY:Mt("".concat(e.year).slice(-3),3),def:function(t){return Mt("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:Mt("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:Mt("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return Mt("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return Mt("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return Mt("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return Mt("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n=n.slice(0,t.length)}}}}(this,n),u=[];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&u.push(l);var h=new RegExp(u.join("|"),"g");return e.replace(h,function(t){var e,n,r;for(n in c)if(Object.prototype.hasOwnProperty.call(c,n)&&(e=new RegExp(n)).test(t))break;if(!e)return"";for(var i in c[n])if(i===t||i.toLowerCase()===t){void 0===(r=c[n][i])&&(r=c[n][i.toLowerCase()]);break}return void 0===r&&(r=c[n].def),"function"==typeof r&&(r=r(t)),r})}}]),t}();function At(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(Rt,e)}function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TS",n=At(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t,e),i=yt(n.format.bind(n),{toKey:function(t){return"object"===r(t)?t.getTime():t}});function a(t){return e!==mt.INTERVAL?function(t){return new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,0,864e5*(t-Math.floor(t))))}(t):t}function o(t){return t=a(t),i(t)}return o.format=function(t,e){return i.clear(),e=a(e),n.format(e,t)},o.locale=function(a){return n=At(a,t,e),i=yt(n.format.bind(n),{toKey:function(t){return"object"===r(t)?t.getTime():t}}),this},o.qtype=function(t){return void 0!==t&&(e=t,i.clear()),e},o}function Nt(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.meta,r=e.id,i=e.key,a=e.localeInfo,o=e.fieldExtractor,s=e.value,c=e.type,u=e.sourceField,l=s||("dimension"===c?function(t){return t.qElemNo}:function(t){return t.qValue}),h="dimension"===c?"first":"avg",f=function(t,e){if(t&&t.qNumFormat&&-1!==["D","T","TS","IV"].indexOf(t.qNumFormat.qType))return Ct(t.qNumFormat.qFmt,t.qNumFormat.qType,e);var n="#",r=e&&void 0!==e.qThousandSep?e.qThousandSep:",",i=e&&void 0!==e.qDecimalSep?e.qDecimalSep:".",a="U",o=t&&!!t.qIsAutoFormat;return t&&t.qNumFormat?(n=t.qNumFormat.qFmt||n,r=t.qNumFormat.qThou||r,i=t.qNumFormat.qDec||i,a=t.qNumFormat.qType||a,o=o&&-1===["M"].indexOf(t.qNumFormat.qType)):o=!0,(o||"U"===a)&&(n="#".concat(i,"##A"),a="U"),vt(n,r,i,a,e)}(n,a),d={id:function(){return r},key:function(){return i},raw:function(){return n},title:function(){return n.qFallbackTitle||n.label},type:function(){return c},origin:function(){return u},items:function(){return t||(t=o(d)),t},min:function(){return n.qMin},max:function(){return n.qMax},value:l,label:function(t){return t.qText||""},reduce:h,reduceLabel:"dimension"===c?"first":function(t,e){return f(e)},formatter:function(){return f},tags:function(){return n.qTags}};return d}function Ot(t,e,n,r,i){return(e[t]||[]).map(function(e,a){var o="".concat(r?"".concat(r,"/"):"").concat(t,"/").concat(a),s={instance:Nt(b({id:"".concat(n?"".concat(n,"/"):"").concat(o),key:o,meta:e},i))};return s.attrDims=Ot("qAttrDimInfo",e,n,o,b({},i,{value:function(t){return t.qElemNo},type:"dimension"})),s.attrExps=Ot("qAttrExprInfo",e,n,o,b({},i,{value:function(t){return t.qNum},type:"measure"})),s.measures=Ot("qMeasureInfo",e,n,o,b({},i,{value:function(t){return t.qValue},type:"measure"})),s})}function Tt(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.key,a=r.data,o=r.config,c=void 0===o?{}:o,u={fields:[],wrappedFields:[],allFields:[],virtualFields:[]},l=a;if(!l)throw new Error('Missing "data" input');if(!l.qDimensionInfo)throw new Error('The "data" input is not recognized as a hypercube');var f=Tt.util,d={cache:u,cube:l,localeInfo:c.localeInfo,fieldExtractor:null,pages:null,hierarchy:function(){return null},virtualFields:c.virtualFields},p={key:function(){return i},raw:function(){return l},field:function(t){return function(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];var r=n.allFields;if("function"==typeof t){for(var i=0;i<r.length;i++)if(t(r[i]))return r[i];return!1}if("string"==typeof t){for(var a=0;a<r.length;a++)if(r[a].key()===t||r[a].title()===t)return r[a]}else if(t&&-1!==r.indexOf(t))return t;throw Error("Field not found: ".concat(t))}(t,d)},fields:function(){return u.fields.slice()},extract:function(t){return d.extractor(t,p,u,f)},hierarchy:function(t){return d.hierarchy(t,p,u,f)},_cache:function(){return u}};"K"===l.qMode||"T"===l.qMode||!l.qMode&&l.qNodesOnDim?(d.extractor=Z,d.hierarchy=G,d.pages="K"===l.qMode?l.qStackedDataPages:l.qTreeDataPages):"S"===l.qMode?(d.extractor=M,d.pages=l.qDataPages,d.hierarchy=G):d.extractor=function(){return[]},d.fieldExtractor=function(t){return d.extractor({field:t},p,u,f)};var g="S"===l.qMode?function(t){return t.qElemNumber}:void 0,y="S"===l.qMode?function(t){return t.qNum}:void 0;(t=u.wrappedFields).push.apply(t,h(Ot("qDimensionInfo",l,i,"",b({},d,{value:g,type:"dimension"})))),(e=u.wrappedFields).push.apply(e,h(Ot("qMeasureInfo",l,i,"",b({},d,{value:y,type:"measure"})))),u.fields=u.wrappedFields.map(function(t){return t.instance});return function t(e){e.forEach(function(e){u.allFields.push(e.instance),t(e.measures),t(e.attrDims),t(e.attrExps)})}(u.wrappedFields),(c.virtualFields||[]).forEach(function(t){var e=p.field(t.from),n=Nt(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){s(t,e,n[e])})}return t}({meta:e.raw(),id:"".concat(i,"/").concat(t.key),sourceField:e,fieldExtractor:function(t){return d.extractor({field:t},p,u,f)},key:t.key,type:e.type(),localeInfo:d.localeInfo,value:e.value},t.override||{}));u.virtualFields.push(n)}),(n=u.allFields).push.apply(n,h(u.virtualFields)),p}var Et=[["qHyperCube","qHyperCubeDef"],["qTreeData","qTreeDataDef"],["qDimensionInfo","qDimensions"],["qMeasureInfo","qMeasures"],["qAttrDimInfo","qAttributeDimensions"],["qAttrExprInfo","qAttributeExpressions"]],Dt=/\/qDimensionInfo(?:\/(\d+))?/,zt=/\/qMeasureInfo\/(\d+)/,jt=/\/qAttrDimInfo\/(\d+)(?:\/(\d+))?/,qt=/\/qAttrExprInfo\/(\d+)/,Pt=/\/?qHyperCube/,It=/\/?qTreeData/,Ft=function(t){return"".concat(t.substr(0,t.indexOf("/qHyperCubeDef")+14))},Lt=function(t){return"".concat(t.substr(0,t.indexOf("/qTreeDataDef")+13))};function Bt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.byCells,i=e.primarySource,a=[],o={},s=t.isActive(),c=!1;return t.brushes().forEach(function(t){var e=function(t,e){var n=t,r=-1,i=-1,a="",o=function(t){return t};Pt.test(t)?(a="".concat(n.substr(0,n.indexOf("qHyperCube")+10)),o=Ft):It.test(t)&&(a="".concat(n.substr(0,n.indexOf("qTreeData")+9)),o=Lt);var s=!0;if(Dt.test(t)&&(r=+Dt.exec(t)[1]),zt.test(t)&&(i=+zt.exec(t)[1]),jt.test(t)){i=-1,r=0;var c=+jt.exec(n)[2];isNaN(c)||(r=c,n=n.replace(/\/\d+$/,"")),s=!1}if(qt.test(t)){var u=i;if(e){i=0;var h=q(a,e);i+=(h.qMeasureInfo||[]).length,r>-1?(i=h.qDimensionInfo.slice(0,r).reduce(function(t,e){return t+e.qAttrExprInfo.length},i),r=-1):(i=h.qDimensionInfo.reduce(function(t,e){return t+e.qAttrExprInfo.length},i),i=h.qMeasureInfo.slice(0,u).reduce(function(t,e){return t+e.qAttrExprInfo.length},i)),i+=+qt.exec(n)[1]}else r>-1?(r=-1,i=+qt.exec(n)[1]):i+=+qt.exec(n)[1]+1}return Et.forEach(function(t){var e=l(t,2),r=e[0],i=e[1];n=n.replace(r,i)}),s&&(n=o(n)),n&&"/"!==n[0]&&(n="/".concat(n)),{measureIdx:i,dimensionIdx:r,path:n}}(t.id,n);if("range"===t.type&&e.measureIdx>-1&&e.dimensionIdx>-1){var s=t.brush.ranges();s.length&&(c=!0,o.multiRangeSelectTreeDataValues||(o.multiRangeSelectTreeDataValues={path:e.path,ranges:[]}),s.forEach(function(t){return o.multiRangeSelectTreeDataValues.ranges.push({qMeasureIx:e.measureIdx,qDimensionIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})}))}else{if("range"===t.type&&e.measureIdx>-1){var u=t.brush.ranges();u.length&&(c=!0,o.rangeSelectHyperCubeValues||(o.rangeSelectHyperCubeValues={path:e.path,ranges:[]}),u.forEach(function(t){return o.rangeSelectHyperCubeValues.ranges.push({qMeasureIx:e.measureIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})}))}if("range"===t.type&&e.dimensionIdx>-1){var h=t.brush.ranges();h.length&&(c=!0,o.selectHyperCubeContinuousRange||(o.selectHyperCubeContinuousRange={path:e.path,ranges:[]}),h.forEach(function(t){return o.selectHyperCubeContinuousRange.ranges.push({qDimIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!1}})}))}if("value"===t.type&&e.dimensionIdx>-1)if(r)if(n&&n.qHyperCube&&("P"===n.qHyperCube.qMode||"T"===n.qHyperCube.qMode)){var f=n.qHyperCube,d=f.qNoOfLeftDims,p=f.qEffectiveInterColumnSortOrder.indexOf(e.dimensionIdx);if(o.selectPivotCells||(o.selectPivotCells={path:e.path,cells:[]}),t.id===i||!i&&0===o.selectPivotCells.cells.length){var g=t.brush.values().map(function(t){return+t}).filter(function(t){return!isNaN(t)});(0===d||p>=d)&&d>-1?g.forEach(function(t){o.selectPivotCells.cells.push({qType:"T",qCol:t,qRow:p-d})}):g.forEach(function(t){o.selectPivotCells.cells.push({qType:"L",qCol:e.dimensionIdx,qRow:t})}),c=!!o.selectPivotCells.cells.length}}else o.selectHyperCubeCells||(o.selectHyperCubeCells={path:e.path,cols:[]}),o.selectHyperCubeCells.cols.push(e.dimensionIdx),t.id!==i&&(i||o.selectHyperCubeCells.values)||(o.selectHyperCubeCells.values=t.brush.values().map(function(t){return+t}).filter(function(t){return!isNaN(t)}),c=!!o.selectHyperCubeCells.values.length);else{var y=t.brush.values().map(function(t){return+t}).filter(function(t){return!isNaN(t)});c=!!y.length,a.push({params:[e.path,e.dimensionIdx,y,!1],method:"selectHyperCubeValues"})}}}),!c&&s?[{method:"resetMadeSelections",params:[]}]:(o.rangeSelectHyperCubeValues&&a.push({method:"rangeSelectHyperCubeValues",params:[o.rangeSelectHyperCubeValues.path,o.rangeSelectHyperCubeValues.ranges,[],!0]}),o.selectHyperCubeContinuousRange&&a.push({method:"selectHyperCubeContinuousRange",params:[o.selectHyperCubeContinuousRange.path,o.selectHyperCubeContinuousRange.ranges]}),o.selectHyperCubeCells&&a.push({method:"selectHyperCubeCells",params:[o.selectHyperCubeCells.path,o.selectHyperCubeCells.values,o.selectHyperCubeCells.cols]}),o.selectPivotCells&&a.push({method:"selectPivotCells",params:[o.selectPivotCells.path,o.selectPivotCells.cells]}),o.multiRangeSelectTreeDataValues&&a.push({method:"multiRangeSelectTreeDataValues",params:[o.multiRangeSelectTreeDataValues.path,o.multiRangeSelectTreeDataValues.ranges]}),a)}function Wt(t){Tt.util=t.data("matrix").util,t.data("q",Tt),t.formatter("q-number",vt),t.formatter("q-time",Ct)}Wt.qBrushHelper=Bt,Wt.selections=Bt,e.a=Wt}).call(this,n(7))},,function(e,n){e.exports=t},function(t,e,n){n(6),t.exports=n(8)},function(t,e){Math.sign||(Math.sign=function(t){return(t>0)-(t<0)||+t}),Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,r=new Array(n);n--;)r[n]=[e[n],t[e[n]]];return r}),Number.isNaN||(Number.isNaN=function(t){return t!=t}),void 0===Number.isFinite&&(Number.isFinite=function(t){return"number"==typeof t&&isFinite(t)})},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";n.r(e);var r=n(4),i=n.n(r);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=/([astvzqmhlc])([^astvzqmhlc]*)/gi,c=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function u(t){var e=[],n=String(t).trim();return"M"!==n[0]&&"m"!==n[0]?e:(n.replace(s,function(t,n,r){var i=n.toLowerCase();if(r=function(t){var e=t.match(c);return e?e.map(Number):[]}(r),"m"===i&&r.length>2&&(e.push([n].concat(r.splice(0,2))),i="l",n="m"===n?"l":"L"),r.length<o[i])return"";for(e.push([n].concat(r.splice(0,o[i])));r.length>=o[i]&&r.length&&o[i];)e.push([n].concat(r.splice(0,o[i])));return""}),e)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(t,e){var n=t.x*Math.cos(e)-t.y*Math.sin(e),r=t.y*Math.cos(e)+t.x*Math.sin(e);t.x=n,t.y=r}function d(t,e,n){t.x+=e,t.y+=n}"undefined"!=typeof window&&function(t){if(void 0!==t&&t.CanvasRenderingContext2D&&(!t.Path2D||!function(t){var e=t.document.createElement("canvas").getContext("2d"),n=new t.Path2D("M0 0 L1 1");return e.strokeStyle="red",e.lineWidth=1,e.stroke(n),255===e.getImageData(0,0,1,1).data[0]}(t))){var e=function(){function t(e){var n;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.segments=[],e&&e instanceof t?(n=this.segments).push.apply(n,h(e.segments)):e&&(this.segments=u(e))}var e,n,r;return e=t,(n=[{key:"addPath",value:function(e){var n;e&&e instanceof t&&(n=this.segments).push.apply(n,h(e.segments))}},{key:"moveTo",value:function(t,e){this.segments.push(["M",t,e])}},{key:"lineTo",value:function(t,e){this.segments.push(["L",t,e])}},{key:"arc",value:function(t,e,n,r,i,a){this.segments.push(["AC",t,e,n,r,i,!!a])}},{key:"arcTo",value:function(t,e,n,r,i){this.segments.push(["AT",t,e,n,r,i])}},{key:"closePath",value:function(){this.segments.push(["Z"])}},{key:"bezierCurveTo",value:function(t,e,n,r,i,a){this.segments.push(["C",t,e,n,r,i,a])}},{key:"quadraticCurveTo",value:function(t,e,n,r){this.segments.push(["Q",t,e,n,r])}},{key:"rect",value:function(t,e,n,r){this.segments.push(["R",t,e,n,r])}}])&&l(e.prototype,n),r&&l(e,r),t}(),n=t.CanvasRenderingContext2D.prototype.fill,r=t.CanvasRenderingContext2D.prototype.stroke;t.CanvasRenderingContext2D.prototype.fill=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var a="nonzero";0===e.length||1===e.length&&"string"==typeof e[0]?n.apply(this,e):(2===arguments.length&&(a=e[1]),i(this,e[0].segments),n.call(this,a))},t.CanvasRenderingContext2D.prototype.stroke=function(t){t?(i(this,t.segments),r.call(this)):r.call(this)},t.Path2D=e}function i(t,e){var n,r,i,a,o,s,c,u,l,h,p,g,y,v,m,x,b,w,k,M,_,S={x:0,y:0};"S"!==m&&"s"!==m&&"C"!==m&&"c"!==m&&(b=null,w=null),"T"!==m&&"t"!==m&&"Q"!==m&&"q"!==m&&(k=null,M=null),t.beginPath();for(var R=0;R<e.length;++R){var A=e[R];switch(m=A[0]){case"m":c+=A[1],l+=A[2],t.moveTo(c,l);break;case"M":c=A[1],l=A[2],t.moveTo(c,l);break;case"l":c+=A[1],l+=A[2],t.lineTo(c,l);break;case"L":c=A[1],l=A[2],t.lineTo(c,l);break;case"H":c=A[1],t.lineTo(c,l);break;case"h":c+=A[1],t.lineTo(c,l);break;case"V":l=A[1],t.lineTo(c,l);break;case"v":l+=A[1],t.lineTo(c,l);break;case"a":case"A":"a"===m?(c+=A[6],l+=A[7]):(c=A[6],l=A[7]),p=A[1],i=A[4],a=A[5],d(o={x:c,y:l},-S.x,-S.y),f(o,-(s=Math.atan2(o.y,o.x))),g=o.x/2,(x={x:0,y:0}).x=o.x/2,x.y=a&&!i||!a&&i?Math.sqrt(p*p-g*g):-Math.sqrt(p*p-g*g),r=Math.atan2(-x.y,-x.x),n=Math.atan2(o.y-x.y,o.x-x.x),r+=s,n+=s,f(o,s),f(x,s),d(o,S.x,S.y),d(x,S.x,S.y),t.arc(x.x,x.y,p,r,n,!a);break;case"C":b=A[3],w=A[4],c=A[5],l=A[6],t.bezierCurveTo(A[1],A[2],b,w,c,l);break;case"c":t.bezierCurveTo(A[1]+c,A[2]+l,A[3]+c,A[4]+l,A[5]+c,A[6]+l),b=A[3]+c,w=A[4]+l,c+=A[5],l+=A[6];break;case"S":null!==b&&null!==b||(b=c,w=l),t.bezierCurveTo(2*c-b,2*l-w,A[1],A[2],A[3],A[4]),b=A[1],w=A[2],c=A[3],l=A[4];break;case"s":null!==b&&null!==b||(b=c,w=l),t.bezierCurveTo(2*c-b,2*l-w,A[1]+c,A[2]+l,A[3]+c,A[4]+l),b=A[1]+c,w=A[2]+l,c+=A[3],l+=A[4];break;case"Q":k=A[1],M=A[2],c=A[3],l=A[4],t.quadraticCurveTo(k,M,c,l);break;case"q":k=A[1]+c,M=A[2]+l,c+=A[3],l+=A[4],t.quadraticCurveTo(k,M,c,l);break;case"T":null!==k&&null!==k||(k=c,M=l),k=2*c-k,M=2*l-M,c=A[1],l=A[2],t.quadraticCurveTo(k,M,c,l);break;case"t":null!==k&&null!==k||(k=c,M=l),k=2*c-k,M=2*l-M,c+=A[1],l+=A[2],t.quadraticCurveTo(k,M,c,l);break;case"z":case"Z":t.closePath();break;case"AC":c=A[1],l=A[2],p=A[3],r=A[4],n=A[5],_=A[6],t.arc(c,l,p,r,n,_);break;case"AT":u=A[1],h=A[2],c=A[3],l=A[4],p=A[5],t.arcTo(u,h,c,l,p);break;case"R":c=A[1],l=A[2],y=A[3],v=A[4],t.rect(c,l,y,v)}S.x=c,S.y=l}}}(window);var p=Object.prototype.hasOwnProperty,g=Object.prototype.toString,y=Object.defineProperty,v=Object.getOwnPropertyDescriptor,m=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===g.call(t)},x=function(t){if(!t||"[object Object]"!==g.call(t))return!1;var e,n=p.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&p.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||p.call(t,e)},b=function(t,e){y&&"__proto__"===e.name?y(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},w=function(t,e){if("__proto__"===e){if(!p.call(t,e))return;if(v)return v(t,e).value}return t[e]},k=function t(){var e,n,r,i,o,s,c=arguments[0],u=1,l=arguments.length,h=!1;for("boolean"==typeof c&&(h=c,c=arguments[1]||{},u=2),(null==c||"object"!==a(c)&&"function"!=typeof c)&&(c={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=w(c,n),c!==(i=w(e,n))&&(h&&i&&(x(i)||(o=m(i)))?(o?(o=!1,s=r&&m(r)?r:[]):s=r&&x(r)?r:{},b(c,{name:n,newValue:t(h,s,i)})):void 0!==i&&b(c,{name:n,newValue:i}));return c},M={version:"0.20.0"};function _(t){return(_="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(t){return a(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":a(t)})(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e,n){return e&&R(t.prototype,e),n&&R(t,n),t}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){C(t,e,n[e])})}return t}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t,e,n){return(D=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&E(i,n.prototype),i}).apply(null,arguments)}function z(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?z(t):e}function q(t,e,n){return(q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function I(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(t){t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height)}function L(t,e){return function(t,e){var n={x:0,y:0,width:0,height:0},r={x:0,y:0,width:0,height:0};if("function"==typeof t.getBoundingClientRect){var i=t.getBoundingClientRect();n.width=i.width,n.height=i.height}else n.width=t.width||0,n.height=t.height||0;return void 0!==e.size&&(n.width=isNaN(e.size.width)?n.width:e.size.width,n.height=isNaN(e.size.height)?n.height:e.size.height),void 0!==e.logicalSize?(r.width=isNaN(e.logicalSize.width)?n.width:e.logicalSize.width,r.height=isNaN(e.logicalSize.height)?n.height:e.logicalSize.height,r.align=isNaN(e.logicalSize.align)?.5:Math.min(Math.max(e.logicalSize.align,0),1),r.preserveAspectRatio=e.logicalSize.preserveAspectRatio):(r.width=n.width,r.height=n.height,r.preserveAspectRatio=!1),F(r),F(n),[r,n]}(t,e)}function B(t){var e={logicalSize:{preserveAspectRatio:!1},center:{minWidthRatio:.5,minHeightRatio:.5,minWidth:0,minHeight:0}};return k(!0,e,t),e.center.minWidthRatio=Math.min(Math.max(e.center.minWidthRatio,0),1),e.center.minHeightRatio=Math.min(Math.max(e.center.minHeightRatio,0),1),e.center.minWidth=Math.max(e.center.minWidth,0),e.center.minHeight=Math.max(e.center.minHeight,0),e}function W(t){return"number"==typeof t&&!isNaN(t)}function V(t){return"number"!=typeof t||isNaN(t)}function H(t){for(var e=t.length,n=NaN,r=NaN,i=NaN,a=NaN,o=0;o<e;o++)n=isNaN(n)?t[o].x:Math.min(n,t[o].x),r=isNaN(r)?t[o].x:Math.max(r,t[o].x),i=isNaN(i)?t[o].y:Math.min(i,t[o].y),a=isNaN(a)?t[o].y:Math.max(a,t[o].y);return[n,i,r,a]}function U(t){return[{x:t.x1||0,y:t.y1||0},{x:t.x2||0,y:t.y2||0}]}function $(t){return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}function Y(t){var e=P(H(t),4),n=e[0],r=e[1];return{x:n,y:r,width:e[2]-n,height:e[3]-r}}function X(t){return{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}function K(t){var e=t||{},n=e.x,r=e.y,i=e.width,a=e.height,o=e.x1,s=e.x2,c=e.y1,u=e.y2,l=e.cx,h=e.cy,f=e.r,d=e.vertices;return W(l)&&W(h)&&W(f)?"circle":W(o)&&W(s)&&W(c)&&W(u)?"line":W(n)&&W(r)&&W(i)&&W(a)?"rect":W(n)&&W(r)?"point":Array.isArray(d)?"polygon":null}function G(t,e,n){if(void 0===t.cachedSize){var r=t.config.computePreferredSize(e,n);"object"===_(r)?(t.cachedSize=Math.ceil(r.size),t.edgeBleed=r.edgeBleed):t.cachedSize=Math.ceil(r)}return t.cachedSize}function Z(t,e){switch(e.config.dock()){case"top":t.y+=e.cachedSize,t.height-=e.cachedSize;break;case"bottom":t.height-=e.cachedSize;break;case"left":t.x+=e.cachedSize,t.width-=e.cachedSize;break;case"right":t.width-=e.cachedSize}}function J(t,e){var n=e.edgeBleed;n&&(t.left=Math.max(t.left,n.left||0),t.right=Math.max(t.right,n.right||0),t.top=Math.max(t.top,n.top||0),t.bottom=Math.max(t.bottom,n.bottom||0))}function Q(t,e,n){e.x<n.left&&(e.width-=n.left-e.x,e.x=n.left);var r=t.width-(e.x+e.width);r<n.right&&(e.width-=n.right-r),e.y<n.top&&(e.height-=n.top-e.y,e.y=n.top);var i=t.height-(e.y+e.height);i<n.bottom&&(e.height-=n.bottom-i)}function tt(t,e,n,r,i){var a=k({},e),o=k({},n);return Z(a,r),J(o,r),Q(t,a,o),!!function(t,e,n){var r=Math.min(n.center.minWidth,t.width)||Math.max(t.width*n.center.minWidthRatio,1),i=Math.min(n.center.minHeight,t.height)||Math.max(t.height*n.center.minHeightRatio,1);return e.width>=r&&e.height>=i}(t,a,i)&&(Z(e,r),J(n,r),!0)}function et(t){return{x:t.margin.left+t.x*t.scaleRatio.x,y:t.margin.top+t.y*t.scaleRatio.y,width:t.width*t.scaleRatio.x,height:t.height*t.scaleRatio.y}}function nt(t){var e;return Y((e=[]).concat.apply(e,I(t.map($))))}function rt(t,e,n,r){var i={x:n.x,y:n.y,width:n.width,height:n.height},a={x:n.x,y:n.y,width:n.width,height:n.height},o={},s=t.slice();t.sort(function(t,e){if(e.referencedDocks.length>0)return-1;if(t.referencedDocks.length>0)return 1;var n=t.config.displayOrder()-e.config.displayOrder();return 0===n?s.indexOf(t)-s.indexOf(e):n}).forEach(function(t){var s={},c={};switch(t.config.dock()){case"top":s.height=c.height=t.cachedSize,s.width=e.width,c.width=i.width,s.x=e.x,c.x=i.x,s.y=c.y=i.y-t.cachedSize,i.y-=t.cachedSize,i.height+=t.cachedSize;break;case"bottom":s.x=e.x,c.x=i.x,s.y=c.y=i.y+i.height,s.width=e.width,c.width=i.width,s.height=c.height=t.cachedSize,i.height+=t.cachedSize;break;case"left":s.x=c.x=a.x-t.cachedSize,s.y=e.y,c.y=a.y,s.width=c.width=t.cachedSize,s.height=e.height,c.height=a.height,a.x-=t.cachedSize,a.width+=t.cachedSize;break;case"right":s.x=c.x=a.x+a.width,s.y=e.y,c.y=a.y,s.width=c.width=t.cachedSize,s.height=e.height,c.height=a.height,a.width+=t.cachedSize;break;default:s.x=c.x=n.x,s.y=c.y=n.y,s.width=c.width=n.width,s.height=c.height=n.height}if(t.referencedDocks.length>0){var u=t.referencedDocks.map(function(t){return o[t]}).filter(function(t){return!!t});u.length>0&&(s=nt(u.map(function(t){return t.outerRect})),c=nt(u.map(function(t){return t.rect})))}else t.key&&(o[t.key]={rect:c,outerRect:s});!function(t,e,n,r){var i={x:r.width/n.width,y:r.height/n.height},a={left:0,top:0};if(n.preserveAspectRatio){var o=i.x<i.y,s=Math.min(i.x,i.y);i.x=s,i.y=s;var c=o?"height":"width",u=(r[c]-n[c]*i.x)*n.align;a.left=o?0:u,a.top=o?u:0}t.scaleRatio=i,t.margin=a,e.scaleRatio=i,e.margin=a,n.scaleRatio=i,n.margin=a}(c,s,e,r),c.edgeBleed=t.edgeBleed,c.computed=et(c),s.edgeBleed=t.edgeBleed,s.computed=et(s),t.instance.resize(c,s,e),t.cachedSize=void 0})}function it(t){var e=[],n=[],r=B(t),i=function(){};return i.addComponent=function(t,n){!function(t){["resize"].forEach(function(e){if("function"!=typeof t[e])throw new Error('Component is missing required function "'.concat(e,'"'))})}(t),i.removeComponent(t);var r=t.dockConfig().dock();e.push({instance:t,key:n,config:t.dockConfig(),referencedDocks:/@/.test(r)?r.split(",").map(function(t){return t.replace(/^\s*@/,"")}):[]})},i.removeComponent=function(t){var n=e.map(function(t){return t.instance}).indexOf(t);n>-1&&e.splice(n,1)},i.layout=function(t){var i=P(L(t,r),2),a=i[0],o=i[1];!function(t,e,n,r){for(var i=n.layoutModes||{},a=0;a<t.length;++a){var o=t[a],s=o.config.minimumLayoutMode(),c=o.config.show();c&&"object"===_(s)?c=i[s.width]&&i[s.height]&&r.width>=i[s.width].width&&r.height>=i[s.height].height:c&&void 0!==s&&(c=i[s]&&r.width>=i[s].width&&r.height>=i[s].height),c||(t.splice(a,1),e.push(o.instance),--a)}}(e,n,r,a);var s=function(t,e,n,r){var i={x:t.x,y:t.y,width:t.width,height:t.height},a={left:0,right:0,top:0,bottom:0},o=e.slice();o.sort(function(t,e){return t.config.prioOrder()-e.config.prioOrder()});for(var s=0;s<o.length;++s){var c=o[s];G(c,i,t),tt(t,i,a,c,r)||(o.splice(s,1),n.push(c.instance),--s)}var u=function(t,e){if(0===e.length)return{visibleComponents:t,dockedAtRemovedComponents:[]};var n=[];return{visibleComponents:t.filter(function(t){if(0===t.referencedDocks.length)return!0;var r=t.referencedDocks.every(function(t){return e.some(function(e){var n=e.ctx&&e.ctx.key;return t===n})});return r&&n.push(t.instance),!r}),dockedAtRemovedComponents:n}}(o,n),l=u.visibleComponents,h=u.dockedAtRemovedComponents;n.push.apply(n,I(h));var f=e.filter(function(t){return-1!==l.indexOf(t)});return e.length=0,e.push.apply(e,I(f)),Q(t,i,a),i}(a,e,n,r);return rt(e,a,s,o),{visible:e.map(function(t){return t.instance}),hidden:n}},i.settings=function(t){r=B(t)},i}function at(t){return!!t.changedTouches}var ot=Math.PI,st=2*ot,ct=st-1e-6;function ut(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function lt(){return new ut}function ht(t){return function(){return t}}ut.prototype=lt.prototype={constructor:ut,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,l=o-e,h=u*u+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(l*s-c*u)>1e-6&&i){var f=n-a,d=r-o,p=s*s+c*c,g=f*f+d*d,y=Math.sqrt(p),v=Math.sqrt(h),m=i*Math.tan((ot-Math.acos((p+h-g)/(2*y*v)))/2),x=m/v,b=m/y;Math.abs(x-1)>1e-6&&(this._+="L"+(t+x*u)+","+(e+x*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>u*d)+","+(this._x1=t+b*s)+","+(this._y1=e+b*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,l=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%st+st),h>ct?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=ot)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var ft=Math.abs,dt=Math.atan2,pt=Math.cos,gt=Math.max,yt=Math.min,vt=Math.sin,mt=Math.sqrt,xt=1e-12,bt=Math.PI,wt=bt/2,kt=2*bt;function Mt(t){return t>=1?wt:t<=-1?-wt:Math.asin(t)}function _t(t){return t.innerRadius}function St(t){return t.outerRadius}function Rt(t){return t.startAngle}function At(t){return t.endAngle}function Ct(t){return t&&t.padAngle}function Nt(t,e,n,r,i,a,o){var s=t-n,c=e-r,u=(o?a:-a)/mt(s*s+c*c),l=u*c,h=-u*s,f=t+l,d=e+h,p=n+l,g=r+h,y=(f+p)/2,v=(d+g)/2,m=p-f,x=g-d,b=m*m+x*x,w=i-a,k=f*g-p*d,M=(x<0?-1:1)*mt(gt(0,w*w*b-k*k)),_=(k*x-m*M)/b,S=(-k*m-x*M)/b,R=(k*x+m*M)/b,A=(-k*m+x*M)/b,C=_-y,N=S-v,O=R-y,T=A-v;return C*C+N*N>O*O+T*T&&(_=R,S=A),{cx:_,cy:S,x01:-l,y01:-h,x11:_*(i/w-1),y11:S*(i/w-1)}}function Ot(){var t=_t,e=St,n=ht(0),r=null,i=Rt,a=At,o=Ct,s=null;function c(){var c,u,l,h=+t.apply(this,arguments),f=+e.apply(this,arguments),d=i.apply(this,arguments)-wt,p=a.apply(this,arguments)-wt,g=ft(p-d),y=p>d;if(s||(s=c=lt()),f<h&&(u=f,f=h,h=u),f>xt)if(g>kt-xt)s.moveTo(f*pt(d),f*vt(d)),s.arc(0,0,f,d,p,!y),h>xt&&(s.moveTo(h*pt(p),h*vt(p)),s.arc(0,0,h,p,d,y));else{var v,m,x=d,b=p,w=d,k=p,M=g,_=g,S=o.apply(this,arguments)/2,R=S>xt&&(r?+r.apply(this,arguments):mt(h*h+f*f)),A=yt(ft(f-h)/2,+n.apply(this,arguments)),C=A,N=A;if(R>xt){var O=Mt(R/h*vt(S)),T=Mt(R/f*vt(S));(M-=2*O)>xt?(w+=O*=y?1:-1,k-=O):(M=0,w=k=(d+p)/2),(_-=2*T)>xt?(x+=T*=y?1:-1,b-=T):(_=0,x=b=(d+p)/2)}var E=f*pt(x),D=f*vt(x),z=h*pt(k),j=h*vt(k);if(A>xt){var q,P=f*pt(b),I=f*vt(b),F=h*pt(w),L=h*vt(w);if(g<bt&&(q=function(t,e,n,r,i,a,o,s){var c=n-t,u=r-e,l=o-i,h=s-a,f=h*c-l*u;if(!(f*f<xt))return[t+(f=(l*(e-a)-h*(t-i))/f)*c,e+f*u]}(E,D,F,L,P,I,z,j))){var B=E-q[0],W=D-q[1],V=P-q[0],H=I-q[1],U=1/vt(((l=(B*V+W*H)/(mt(B*B+W*W)*mt(V*V+H*H)))>1?0:l<-1?bt:Math.acos(l))/2),$=mt(q[0]*q[0]+q[1]*q[1]);C=yt(A,(h-$)/(U-1)),N=yt(A,(f-$)/(U+1))}}_>xt?N>xt?(v=Nt(F,L,E,D,f,N,y),m=Nt(P,I,z,j,f,N,y),s.moveTo(v.cx+v.x01,v.cy+v.y01),N<A?s.arc(v.cx,v.cy,N,dt(v.y01,v.x01),dt(m.y01,m.x01),!y):(s.arc(v.cx,v.cy,N,dt(v.y01,v.x01),dt(v.y11,v.x11),!y),s.arc(0,0,f,dt(v.cy+v.y11,v.cx+v.x11),dt(m.cy+m.y11,m.cx+m.x11),!y),s.arc(m.cx,m.cy,N,dt(m.y11,m.x11),dt(m.y01,m.x01),!y))):(s.moveTo(E,D),s.arc(0,0,f,x,b,!y)):s.moveTo(E,D),h>xt&&M>xt?C>xt?(v=Nt(z,j,P,I,h,-C,y),m=Nt(E,D,F,L,h,-C,y),s.lineTo(v.cx+v.x01,v.cy+v.y01),C<A?s.arc(v.cx,v.cy,C,dt(v.y01,v.x01),dt(m.y01,m.x01),!y):(s.arc(v.cx,v.cy,C,dt(v.y01,v.x01),dt(v.y11,v.x11),!y),s.arc(0,0,h,dt(v.cy+v.y11,v.cx+v.x11),dt(m.cy+m.y11,m.cx+m.x11),y),s.arc(m.cx,m.cy,C,dt(m.y11,m.x11),dt(m.y01,m.x01),!y))):s.arc(0,0,h,k,w,y):s.lineTo(z,j)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-bt/2;return[pt(r)*n,vt(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ht(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ht(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ht(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ht(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ht(+t),c):i},c.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:ht(+t),c):a},c.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:ht(+t),c):o},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c}function Tt(t){this._context=t}function Et(t){return new Tt(t)}function Dt(t){return t[0]}function zt(t){return t[1]}function jt(){var t=Dt,e=null,n=ht(0),r=zt,i=ht(!0),a=null,o=Et,s=null;function c(c){var u,l,h,f,d,p=c.length,g=!1,y=new Array(p),v=new Array(p);for(null==a&&(s=o(d=lt())),u=0;u<=p;++u){if(!(u<p&&i(f=c[u],u,c))===g)if(g=!g)l=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=l;--h)s.point(y[h],v[h]);s.lineEnd(),s.areaEnd()}g&&(y[u]=+t(f,u,c),v[u]=+n(f,u,c),s.point(e?+e(f,u,c):y[u],r?+r(f,u,c):v[u]))}if(d)return s=null,d+""||null}function u(){return function(){var t=Dt,e=zt,n=ht(!0),r=null,i=Et,a=null;function o(o){var s,c,u,l=o.length,h=!1;for(null==r&&(a=i(u=lt())),s=0;s<=l;++s)!(s<l&&n(c=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(c,s,o),+e(c,s,o));if(u)return a=null,u+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:ht(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:ht(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:ht(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o}().defined(i).curve(o).context(a)}return c.x=function(n){return arguments.length?(t="function"==typeof n?n:ht(+n),e=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:ht(+e),c):t},c.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:ht(+t),c):e},c.y=function(t){return arguments.length?(n="function"==typeof t?t:ht(+t),r=null,c):n},c.y0=function(t){return arguments.length?(n="function"==typeof t?t:ht(+t),c):n},c.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ht(+t),c):r},c.lineX0=c.lineY0=function(){return u().x(t).y(n)},c.lineY1=function(){return u().x(t).y(r)},c.lineX1=function(){return u().x(e).y(n)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:ht(!!t),c):i},c.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),c):o},c.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),c):a},c}function qt(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function Pt(t){return t}Tt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var It=Array.prototype.slice;function Ft(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Lt(t){this._context=t}function Bt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Wt(t,e){this._context=t,this._k=(1-e)/6}Lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ft(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ft(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Bt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Bt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Vt=function t(e){function n(t){return new Wt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ht(t,e){this._context=t,this._alpha=e}Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>xt){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>xt){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ut=function t(e){function n(t){return e?new Ht(t,e):new Wt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function $t(t){return t<0?-1:1}function Yt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return($t(a)+$t(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Xt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Kt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Gt(t){this._context=t}function Zt(t){this._context=new Jt(t)}function Jt(t){this._context=t}function Qt(t){this._context=t}function te(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function ee(t,e){this._context=t,this._t=e}function ne(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],s=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function re(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function ie(t,e){return t[e]}function ae(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function oe(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function se(t){var e,n={},r=t||{get:function(){},has:function(){return!1},default:function(){}};function i(t,e){if(!t||"string"!=typeof t)throw new TypeError("Invalid argument: key must be a non-empty string");return!(t in n)&&(n[t]=e,!0)}function a(t){return n[t]||r.get(t)}function o(t,n){return void 0!==n?i(t,n):a(t||e)}return e=r.default(),o.add=i,o.get=a,o.has=function(t){return!!n[t]||r.has(t)},o.remove=function(t){var e=n[t];return delete n[t],e},o.getKeys=function(){return Object.keys(n)},o.getValues=function(){return Object.keys(n).map(function(t){return n[t]})},o.default=function(t){return void 0!==t&&(e=t),e},o.register=i,o}function ce(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ue(t){return(t=ce(Math.abs(t)))?t[1]:NaN}Gt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Kt(this,this._t0,Xt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Kt(this,Xt(this,n=Yt(this,t,e)),n);break;default:Kt(this,this._t0,n=Yt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Zt.prototype=Object.create(Gt.prototype)).point=function(t,e){Gt.prototype.point.call(this,e,t)},Jt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=te(t),i=te(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},ee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var le,he=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fe(t){return new de(t)}function de(t){if(!(e=he.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function pe(t,e){var n=ce(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}fe.prototype=de.prototype,de.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ge={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return pe(100*t,e)},r:pe,s:function(t,e){var n=ce(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(le=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ce(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ye(t){return t}var ve,me,xe,be=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function we(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):ye,i=t.currency,a=t.decimal,o=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):ye,s=t.percent||"%";function c(t){var e=(t=fe(t)).fill,n=t.align,c=t.sign,u=t.symbol,l=t.zero,h=t.width,f=t.comma,d=t.precision,p=t.trim,g=t.type;"n"===g?(f=!0,g="g"):ge[g]||(null==d&&(d=12),p=!0,g="g"),(l||"0"===e&&"="===n)&&(l=!0,e="0",n="=");var y="$"===u?i[0]:"#"===u&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",v="$"===u?i[1]:/[%p]/.test(g)?s:"",m=ge[g],x=/[defgprs%]/.test(g);function b(t){var i,s,u,b=y,w=v;if("c"===g)w=m(t)+w,t="";else{var k=(t=+t)<0;if(t=m(Math.abs(t),d),p&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&(k=!1),b=(k?"("===c?c:"-":"-"===c||"("===c?"":c)+b,w=("s"===g?be[8+le/3]:"")+w+(k&&"("===c?")":""),x)for(i=-1,s=t.length;++i<s;)if(48>(u=t.charCodeAt(i))||u>57){w=(46===u?a+t.slice(i+1):t.slice(i))+w,t=t.slice(0,i);break}}f&&!l&&(t=r(t,1/0));var M=b.length+t.length+w.length,_=M<h?new Array(h-M+1).join(e):"";switch(f&&l&&(t=r(_+t,_.length?h-w.length:1/0),_=""),n){case"<":t=b+t+w+_;break;case"=":t=b+_+t+w;break;case"^":t=_.slice(0,M=_.length>>1)+b+t+w+_.slice(M);break;default:t=_+b+t+w}return o(t)}return d=null==d?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),b.toString=function(){return t+""},b}return{format:c,formatPrefix:function(t,e){var n=c(((t=fe(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ue(e)/3))),i=Math.pow(10,-r),a=be[8+r/3];return function(t){return n(i*t)+a}}}}!function(t){ve=we(t),me=ve.format,xe=ve.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var ke=new Date,Me=new Date;function _e(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return _e(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return ke.setTime(+e),Me.setTime(+r),t(ke),t(Me),Math.floor(n(ke,Me))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Se=_e(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Se.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?_e(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Se:null};Se.range;var Re=6e4,Ae=6048e5,Ce=(_e(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}).range,_e(function(t){t.setTime(Math.floor(t/Re)*Re)},function(t,e){t.setTime(+t+e*Re)},function(t,e){return(e-t)/Re},function(t){return t.getMinutes()}).range,_e(function(t){var e=t.getTimezoneOffset()*Re%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}).range,_e(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Re)/864e5},function(t){return t.getDate()-1}));Ce.range;function Ne(t){return _e(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Re)/Ae})}var Oe=Ne(0),Te=Ne(1),Ee=(Ne(2),Ne(3),Ne(4)),De=(Ne(5),Ne(6),Oe.range,Te.range,Ee.range,_e(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}).range,_e(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));De.every=function(t){return isFinite(t=Math.floor(t))&&t>0?_e(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};De.range,_e(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Re)},function(t,e){return(e-t)/Re},function(t){return t.getUTCMinutes()}).range,_e(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}).range;var ze=_e(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});ze.range;function je(t){return _e(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Ae})}var qe=je(0),Pe=je(1),Ie=(je(2),je(3),je(4)),Fe=(je(5),je(6),qe.range,Pe.range,Ie.range,_e(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}).range,_e(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));Fe.every=function(t){return isFinite(t=Math.floor(t))&&t>0?_e(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};Fe.range;function Le(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Be(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function We(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Ve(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Qe(i),l=tn(i),h=Qe(a),f=tn(a),d=Qe(o),p=tn(o),g=Qe(s),y=tn(s),v=Qe(c),m=tn(c),x={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:wn,e:wn,f:Rn,H:kn,I:Mn,j:_n,L:Sn,m:An,M:Cn,p:function(t){return i[+(t.getHours()>=12)]},Q:nr,s:rr,S:Nn,u:On,U:Tn,V:En,w:Dn,W:zn,x:null,X:null,y:jn,Y:qn,Z:Pn,"%":er},b={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:In,e:In,f:Vn,H:Fn,I:Ln,j:Bn,L:Wn,m:Hn,M:Un,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:nr,s:rr,S:$n,u:Yn,U:Xn,V:Kn,w:Gn,W:Zn,x:null,X:null,y:Jn,Y:Qn,Z:tr,"%":er},w={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return _(t,e,n,r)},d:hn,e:hn,f:vn,H:dn,I:dn,j:fn,L:yn,m:ln,M:pn,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},Q:xn,s:bn,S:gn,u:nn,U:rn,V:an,w:en,W:on,x:function(t,e,r){return _(t,n,e,r)},X:function(t,e,n){return _(t,r,e,n)},y:cn,Y:sn,Z:un,"%":mn};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=Ye[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function M(t,e){return function(n){var r,i,a=We(1900);if(_(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=Be(We(a.y))).getUTCDay(),r=i>4||0===i?Pe.ceil(r):Pe(r),r=ze.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=e(We(a.y))).getDay(),r=i>4||0===i?Te.ceil(r):Te(r),r=Ce.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Be(We(a.y)).getUTCDay():e(We(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Be(a)):e(a)}}function _(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in Ye?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),{format:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",Le);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t,Be);return e.toString=function(){return t},e}}}var He,Ue,$e,Ye={"-":"",_:" ",0:"0"},Xe=/^\s*\d+/,Ke=/^%/,Ge=/[\\^$*+?|[\]().{}]/g;function Ze(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Je(t){return t.replace(Ge,"\\$&")}function Qe(t){return new RegExp("^(?:"+t.map(Je).join("|")+")","i")}function tn(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function en(t,e,n){var r=Xe.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function nn(t,e,n){var r=Xe.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function rn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function an(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function on(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function sn(t,e,n){var r=Xe.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function cn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function un(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ln(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function hn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function fn(t,e,n){var r=Xe.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function dn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function pn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function gn(t,e,n){var r=Xe.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function yn(t,e,n){var r=Xe.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function vn(t,e,n){var r=Xe.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function mn(t,e,n){var r=Ke.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function xn(t,e,n){var r=Xe.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function bn(t,e,n){var r=Xe.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function wn(t,e){return Ze(t.getDate(),e,2)}function kn(t,e){return Ze(t.getHours(),e,2)}function Mn(t,e){return Ze(t.getHours()%12||12,e,2)}function _n(t,e){return Ze(1+Ce.count(De(t),t),e,3)}function Sn(t,e){return Ze(t.getMilliseconds(),e,3)}function Rn(t,e){return Sn(t,e)+"000"}function An(t,e){return Ze(t.getMonth()+1,e,2)}function Cn(t,e){return Ze(t.getMinutes(),e,2)}function Nn(t,e){return Ze(t.getSeconds(),e,2)}function On(t){var e=t.getDay();return 0===e?7:e}function Tn(t,e){return Ze(Oe.count(De(t),t),e,2)}function En(t,e){var n=t.getDay();return t=n>=4||0===n?Ee(t):Ee.ceil(t),Ze(Ee.count(De(t),t)+(4===De(t).getDay()),e,2)}function Dn(t){return t.getDay()}function zn(t,e){return Ze(Te.count(De(t),t),e,2)}function jn(t,e){return Ze(t.getFullYear()%100,e,2)}function qn(t,e){return Ze(t.getFullYear()%1e4,e,4)}function Pn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ze(e/60|0,"0",2)+Ze(e%60,"0",2)}function In(t,e){return Ze(t.getUTCDate(),e,2)}function Fn(t,e){return Ze(t.getUTCHours(),e,2)}function Ln(t,e){return Ze(t.getUTCHours()%12||12,e,2)}function Bn(t,e){return Ze(1+ze.count(Fe(t),t),e,3)}function Wn(t,e){return Ze(t.getUTCMilliseconds(),e,3)}function Vn(t,e){return Wn(t,e)+"000"}function Hn(t,e){return Ze(t.getUTCMonth()+1,e,2)}function Un(t,e){return Ze(t.getUTCMinutes(),e,2)}function $n(t,e){return Ze(t.getUTCSeconds(),e,2)}function Yn(t){var e=t.getUTCDay();return 0===e?7:e}function Xn(t,e){return Ze(qe.count(Fe(t),t),e,2)}function Kn(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Ie(t):Ie.ceil(t),Ze(Ie.count(Fe(t),t)+(4===Fe(t).getUTCDay()),e,2)}function Gn(t){return t.getUTCDay()}function Zn(t,e){return Ze(Pe.count(Fe(t),t),e,2)}function Jn(t,e){return Ze(t.getUTCFullYear()%100,e,2)}function Qn(t,e){return Ze(t.getUTCFullYear()%1e4,e,4)}function tr(){return"+0000"}function er(){return"%"}function nr(t){return+t}function rr(t){return Math.floor(+t/1e3)}!function(t){He=Ve(t),He.format,He.parse,Ue=He.utcFormat,$e=He.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||Ue("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||$e("%Y-%m-%dT%H:%M:%S.%LZ");var ir=se();ir("d3-number",function(t,e,n){var r,i;function a(t){return i(t)}function o(){a.locale({decimal:n||".",thousands:e||",",grouping:[3],currency:["$",""]})}return a.locale=function(e){return r=we(e),i=r.format(t),this},o(),a.format=function(t,i,a,s){return(a||s)&&(e=a,n=s,o()),r.format(t)(i)},a.pattern=function(e){return e&&(t=e,i=r.format(e)),t},a}),ir("d3-time",function(t){var e=Ve({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),n=e.format(t);function r(t){return n(t)}return r.format=function(t,n){return e.format(t)(n)},r.locale=function(){return e=Ve.apply(void 0,arguments),n=e.format(t),this},r.parse=function(t,n){return e.parse(t)(n)},r.parsePattern=function(t){return e.parse(t)},r});var ar={id:function(t){return"".concat(t.source,"/").concat(t.key||t.title)},key:function(t){return String(t.key||t.title)},tags:function(t){return t.tags},min:function(t){return t.min},max:function(t){return t.max},type:function(t){return t.type},title:function(t){return String(t.title)},values:function(t){return t.values},value:function(t){return t},label:function(t){return t},formatter:function(t){return function(t){if("function"==typeof t.formatter)return t.formatter();var e=t.formatter||{};return ir(e.type||"d3-number")(e.format||"")}(t)}};function or(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id,r=void 0===n?ar.id:n,i=e.key,a=void 0===i?ar.key:i,o=e.min,s=void 0===o?ar.min:o,c=e.max,u=void 0===c?ar.max:c,l=e.type,h=void 0===l?ar.type:l,f=e.tags,d=void 0===f?ar.tags:f,p=e.title,g=void 0===p?ar.title:p,y=e.values,v=void 0===y?ar.values:y,m=e.value,x=void 0===m?ar.value:m,b=e.label,w=void 0===b?ar.label:b,k=e.formatter,M=void 0===k?ar.formatter:k;return{id:function(){return r(t)},key:function(){return a(t)},raw:function(){return t},tags:function(){return d(t)},type:function(){return h(t)},min:function(){return s(t)},max:function(){return u(t)},title:function(){return g(t)},items:function(){return v(t)},formatter:function(){return M(t)},value:x,label:w}}var sr={diverging:function(t,e){if((s=t.length)>1)for(var n,r,i,a,o,s,c=0,u=t[e[0]].length;c<u;++c)for(a=o=0,n=0;n<s;++n)(i=(r=t[e[n]][c])[1]-r[0])>=0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):r[0]=a},none:ne,silhouette:function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}ne(t,e)}},expand:function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}ne(t,e)}},wiggle:function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,c=0,u=0;s<i;++s){for(var l=t[e[s]],h=l[o][1]||0,f=(h-(l[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}c+=h,u+=f*h}n[o-1][1]+=n[o-1][0]=a,c&&(a-=u/c)}n[o-1][1]+=n[o-1][0]=a,ne(t,e)}}},cr={ascending:function(t){var e=t.map(oe);return re(t).sort(function(t,n){return e[t]-e[n]})},insideout:function(t){var e,n,r=t.length,i=t.map(oe),a=function(t){var e=t.map(ae);return re(t).sort(function(t,n){return e[t]-e[n]})}(t),o=0,s=0,c=[],u=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],c.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(c)},none:re,reverse:function(t){return re(t).reverse()}};function ur(t,e,n){for(var r={},i=e.stackKey,a=e.value,o=e.startProp||"start",s=e.endProp||"end",c=e.offset||"none",u=e.order||"none",l=e.valueRef||"",h=0,f={},d=0;d<t.items.length;d++){var p=t.items[d],g=l?p[l]:null;if(g&&g.source){var y="".concat(g.source.key||"","/").concat(g.source.field);f[y]||(f[y]=g.source)}var v=i(p);r[v]=r[v]||{items:[]},r[v].items.push(p),h=Math.max(h,r[v].items.length)}for(var m=Array.apply(null,{length:h}).map(Number.call,Number),x=Object.keys(r).map(function(t){return r[t].items}),b=function(){var t=ht([]),e=re,n=ne,r=ie;function i(i){var a,o,s=t.apply(this,arguments),c=i.length,u=s.length,l=new Array(u);for(a=0;a<u;++a){for(var h,f=s[a],d=l[a]=new Array(c),p=0;p<c;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(a=0,o=e(l);a<u;++a)l[o[a]].index=a;return n(l,o),l}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:ht(It.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:ht(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?re:"function"==typeof t?t:ht(It.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?ne:t,i):n},i}().keys(m).value(function(t,e){return t[e]?a(t[e]):0}).order(cr[u]).offset(sr[c])(x),w=[],k=0;k<b.length;k++)for(var M=b[k],_=0;_<M.length;_++){var S=M[_],R=M[_].data[M.key];R&&(R[o]={value:S[0]},R[s]={value:S[1]},w.push(S[0],S[1]))}var A=Object.keys(f).map(function(t){var e=n(f[t].key);return e?e.field(f[t].field):null}).filter(function(t){return!!t}),C=or({title:A.map(function(t){return t.title()}).join(", "),min:Math.min.apply(Math,w),max:Math.max.apply(Math,w),type:"measure",formatter:A[0]?A[0].formatter:void 0});t.fields.push(C)}function lr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},i=n.logger;if(Array.isArray(t))r.items=t.map(function(t){return{value:t,label:String(t)}});else if(t){if("collection"in t)return e.collection(t.collection);var a=e.dataset?e.dataset(t.source):null,o=t.value||function(t){return t},s=t.label||function(t){return t};if(t.groupBy||t.mapTo)i.warn('Deprecated "data" configuration',t),r.items=[];else if(t.hierarchy)r.root=a.hierarchy?a.hierarchy(t.hierarchy):null,r.fields=a.fields();else if(t.items)r.items=t.items.map(function(t){return{value:o(t),label:String(s(t))}});else if(t.extract){var c=Array.isArray(t.extract)?t.extract:[t.extract];r.items=[];var u,l=[];if(c.forEach(function(t){var n,i=t.source?e.dataset(t.source):a;i&&((n=r.items).push.apply(n,I(i.extract(t))),void 0!==t.field&&l.push(i.field(t.field)))}),l.length&&(r.fields=l),t.amend&&Array.isArray(t.amend))(u=r.items).push.apply(u,I(t.amend))}else if(void 0!==t.field&&a){var h=a.field(t.field);h&&(r.fields||(r.fields=[]),r.fields.push(h),"value"in t||(o=h.value||function(t){return t},s=h.label||function(t){return t},r.value=o),r.items=h.items().map(function(e){return{value:o(e),label:String(s(e)),source:{field:t.field}}}))}else t.fields&&t.fields.forEach(function(t){var n,i="object"===_(t)&&t.source?e.dataset(t.source):a;i&&((n="object"===_(t)&&void 0!==t.field?i.field(t.field):i.field(t))&&(r.fields||(r.fields=[]),r.fields.push(n)))});r.items&&t.map&&(r.items=r.items.map(t.map))}return t&&t.stack&&ur(r,t.stack,e.dataset),t&&!Array.isArray(t)&&"function"==typeof t.sort&&r.items&&(r.items=r.items.sort(t.sort)),r}function hr(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lr;if(t.data){var a=i(t.data,e,n);if(a&&a.fields&&a.fields[0])return a.fields[0].formatter()}if(r=t.formatter?"".concat(t.formatter,"-").concat(t.type||"number"):t.type||"d3-number",n.formatter.has(r))return n.formatter.get(r)(t.format||"");throw new Error("Formatter of type '".concat(r,"' was not found"))}function fr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var dr,pr,gr=(1===(dr=fr).length&&(pr=dr,dr=function(t,e){return fr(pr(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;dr(t[i],e)<0?n=i+1:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;dr(t[i],e)>0?r=i:n=i+1}return n}}).right;var yr=Math.sqrt(50),vr=Math.sqrt(10),mr=Math.sqrt(2);function xr(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=yr?10:a>=vr?5:a>=mr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=yr?10:a>=vr?5:a>=mr?2:1)}function br(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function wr(){}function kr(t,e){var n=new wr;if(t instanceof wr)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}function Mr(){}wr.prototype=kr.prototype={constructor:wr,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var _r=kr.prototype;Mr.prototype=function(t,e){var n=new Mr;if(t instanceof Mr)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}.prototype={constructor:Mr,has:_r.has,add:function(t){return this["$"+(t+="")]=t,this},remove:_r.remove,clear:_r.clear,values:_r.keys,size:_r.size,empty:_r.empty,each:_r.each};var Sr=Array.prototype,Rr=Sr.map,Ar=Sr.slice,Cr={name:"implicit"};function Nr(){var t=kr(),e=[],n=[],r=Cr;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==Cr)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=kr();for(var r,a,o=-1,s=n.length;++o<s;)t.has(a=(r=n[o])+"")||t.set(a,e.push(r));return i},i.range=function(t){return arguments.length?(n=Ar.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Nr(e,n).unknown(r)},br.apply(i,arguments),i}function Or(){var t,e,n=Nr().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){var n=r().length,l=a[1]<a[0],h=a[l-0],f=a[1-l];t=(f-h)/Math.max(1,n-s+2*c),o&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*u,e=t*(1-s),o&&(h=Math.round(h),e=Math.round(e));var d=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(n).map(function(e){return h+t*e});return i(l?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),l()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,l()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,c=+t),l()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),l()):s},n.paddingOuter=function(t){return arguments.length?(c=+t,l()):c},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},n.copy=function(){return Or(r(),a).round(o).paddingInner(s).paddingOuter(c).align(u)},br.apply(l(),arguments)}function Tr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Er(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Dr(){}var zr="\\s*([+-]?\\d+)\\s*",jr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pr=/^#([0-9a-f]{3})$/,Ir=/^#([0-9a-f]{6})$/,Fr=new RegExp("^rgb\\("+[zr,zr,zr]+"\\)$"),Lr=new RegExp("^rgb\\("+[qr,qr,qr]+"\\)$"),Br=new RegExp("^rgba\\("+[zr,zr,zr,jr]+"\\)$"),Wr=new RegExp("^rgba\\("+[qr,qr,qr,jr]+"\\)$"),Vr=new RegExp("^hsl\\("+[jr,qr,qr]+"\\)$"),Hr=new RegExp("^hsla\\("+[jr,qr,qr,jr]+"\\)$"),Ur={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function $r(t){var e;return t=(t+"").trim().toLowerCase(),(e=Pr.exec(t))?new Zr((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Ir.exec(t))?Yr(parseInt(e[1],16)):(e=Fr.exec(t))?new Zr(e[1],e[2],e[3],1):(e=Lr.exec(t))?new Zr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Br.exec(t))?Xr(e[1],e[2],e[3],e[4]):(e=Wr.exec(t))?Xr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Vr.exec(t))?Qr(e[1],e[2]/100,e[3]/100,1):(e=Hr.exec(t))?Qr(e[1],e[2]/100,e[3]/100,e[4]):Ur.hasOwnProperty(t)?Yr(Ur[t]):"transparent"===t?new Zr(NaN,NaN,NaN,0):null}function Yr(t){return new Zr(t>>16&255,t>>8&255,255&t,1)}function Xr(t,e,n,r){return r<=0&&(t=e=n=NaN),new Zr(t,e,n,r)}function Kr(t){return t instanceof Dr||(t=$r(t)),t?new Zr((t=t.rgb()).r,t.g,t.b,t.opacity):new Zr}function Gr(t,e,n,r){return 1===arguments.length?Kr(t):new Zr(t,e,n,null==r?1:r)}function Zr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Jr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Qr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ti(t,e,n,r)}function ti(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ei(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Tr(Dr,$r,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Tr(Zr,Gr,Er(Dr,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Zr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Zr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Jr(this.r)+Jr(this.g)+Jr(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Tr(ti,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ti)return new ti(t.h,t.s,t.l,t.opacity);if(t instanceof Dr||(t=$r(t)),!t)return new ti;if(t instanceof ti)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new ti(o,s,c,t.opacity)}(t):new ti(t,e,n,null==r?1:r)},Er(Dr,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ti(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ti(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Zr(ei(t>=240?t-240:t+120,i,r),ei(t,i,r),ei(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var ni=Math.PI/180,ri=180/Math.PI,ii=.96422,ai=1,oi=.82521,si=4/29,ci=6/29,ui=3*ci*ci,li=ci*ci*ci;function hi(t){if(t instanceof fi)return new fi(t.l,t.a,t.b,t.opacity);if(t instanceof vi){if(isNaN(t.h))return new fi(t.l,0,0,t.opacity);var e=t.h*ni;return new fi(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Zr||(t=Kr(t));var n,r,i=yi(t.r),a=yi(t.g),o=yi(t.b),s=di((.2225045*i+.7168786*a+.0606169*o)/ai);return i===a&&a===o?n=r=s:(n=di((.4360747*i+.3850649*a+.1430804*o)/ii),r=di((.0139322*i+.0971045*a+.7141733*o)/oi)),new fi(116*s-16,500*(n-s),200*(s-r),t.opacity)}function fi(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function di(t){return t>li?Math.pow(t,1/3):t/ui+si}function pi(t){return t>ci?t*t*t:ui*(t-si)}function gi(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function yi(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function vi(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}Tr(fi,function(t,e,n,r){return 1===arguments.length?hi(t):new fi(t,e,n,null==r?1:r)},Er(Dr,{brighter:function(t){return new fi(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new fi(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Zr(gi(3.1338561*(e=ii*pi(e))-1.6168667*(t=ai*pi(t))-.4906146*(n=oi*pi(n))),gi(-.9787684*e+1.9161415*t+.033454*n),gi(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Tr(vi,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof vi)return new vi(t.h,t.c,t.l,t.opacity);if(t instanceof fi||(t=hi(t)),0===t.a&&0===t.b)return new vi(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*ri;return new vi(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new vi(t,e,n,null==r?1:r)},Er(Dr,{brighter:function(t){return new vi(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new vi(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return hi(this).rgb()}}));var mi=-.14861,xi=1.78277,bi=-.29227,wi=-.90649,ki=1.97294,Mi=ki*wi,_i=ki*xi,Si=xi*bi-wi*mi;function Ri(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ai(t){return function(){return t}}function Ci(t){return 1==(t=+t)?Ni:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ai(isNaN(e)?n:e)}}function Ni(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ai(isNaN(t)?e:t)}Tr(Ri,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Ri)return new Ri(t.h,t.s,t.l,t.opacity);t instanceof Zr||(t=Kr(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Si*r+Mi*e-_i*n)/(Si+Mi-_i),a=r-i,o=(ki*(n-i)-bi*a)/wi,s=Math.sqrt(o*o+a*a)/(ki*i*(1-i)),c=s?Math.atan2(o,a)*ri-120:NaN;return new Ri(c<0?c+360:c,s,i,t.opacity)}(t):new Ri(t,e,n,null==r?1:r)},Er(Dr,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ri(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ri(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*ni,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Zr(255*(e+n*(mi*r+xi*i)),255*(e+n*(bi*r+wi*i)),255*(e+n*(ki*r)),this.opacity)}}));var Oi=function t(e){var n=Ci(e);function r(t,e){var r=n((t=Gr(t)).r,(e=Gr(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Ni(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Ti(t,e){return e-=t=+t,function(n){return t+e*n}}function Ei(t,e){var n,r={},i={};for(n in null!==t&&"object"===a(t)||(t={}),null!==e&&"object"===a(e)||(e={}),e)n in t?r[n]=ji(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Di=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zi=new RegExp(Di.source,"g");function ji(t,e){var n,r=a(e);return null==e||"boolean"===r?Ai(e):("number"===r?Ti:"string"===r?(n=$r(e))?(e=n,Oi):function(t,e){var n,r,i,a=Di.lastIndex=zi.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Di.exec(t))&&(r=zi.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Ti(n,r)})),a=zi.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}:e instanceof $r?Oi:e instanceof Date?function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=ji(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ei:Ti)(t,e)}function qi(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}}Math.PI,Math.SQRT2;function Pi(t){return+t}var Ii=[0,1];function Fi(t){return t}function Li(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Bi(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Wi(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=Li(i,r),a=n(o,a)):(r=Li(r,i),a=n(a,o)),function(t){return a(r(t))}}function Vi(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Li(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=gr(t,e,1,r)-1;return a[n](i[n](e))}}function Hi(t,e){return function(){var t,e,n,r,i,a,o=Ii,s=Ii,c=ji,u=Fi;function l(){return r=Math.min(o.length,s.length)>2?Vi:Wi,i=a=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),Ti)))(n)))},h.domain=function(t){return arguments.length?(o=Rr.call(t,Pi),u===Fi||(u=Bi(o)),l()):o.slice()},h.range=function(t){return arguments.length?(s=Ar.call(t),l()):s.slice()},h.rangeRound=function(t){return s=Ar.call(t),c=qi,l()},h.clamp=function(t){return arguments.length?(u=t?Bi(o):Fi,h):u!==Fi},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}()(t,e)}function Ui(t,e,n,r){var i,a=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=yr?i*=10:a>=vr?i*=5:a>=mr&&(i*=2),e<t?-i:i}(t,e,n);switch((r=fe(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ue(e)/3)))-ue(Math.abs(t)))}(a,o))||(r.precision=i),xe(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ue(e)-ue(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-ue(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return me(r)}function $i(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=xr(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Ui(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,s=i[a],c=i[o];return c<s&&(r=s,s=c,c=r,r=a,a=o,o=r),(r=xr(s,c,n))>0?r=xr(s=Math.floor(s/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=xr(s=Math.ceil(s*r)/r,c=Math.floor(c*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(c/r)*r,e(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(c*r)/r,e(i)),t},t}function Yi(){var t=Hi(Fi,Fi);return t.copy=function(){return e=t,Yi().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},br.apply(t,arguments),$i(t)}function Xi(t){return void 0===t?function(t){return t}:function(e){return t(e)}}function Ki(t){return Math.max(0,Math.min(1,t))}function Gi(t){return"object"===_(t)}function Zi(t,e,n){for(var r=Math.abs(e-n)/(t+1),i=[],a=1;a<=t;a++){var o=a*r;i.push(e<n?e+o:e-o)}return i}function Ji(t,e,n){if(1===t.length)return t;for(var r=t.concat([]),i=0;i<t.length;i++){var a=t[i],o=t[i+1];0===i&&a!==n.start()?(r.push.apply(r,I(Zi(e,a,o))),a-=o-a,o=t[i],r.push.apply(r,I(Zi(e,a,o)))):i===t.length-1&&o!==n.end()?(o=a+(a-t[i-1]),r.push.apply(r,I(Zi(e,a,o)))):r.push.apply(r,I(Zi(e,a,o)))}return r.filter(function(t){return t>=n.min()&&t<=n.max()})}function Qi(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,c=void 0===s?void 0:s,u=V(o)||V(e)?2:Math.max(e/o,2),l=Math.min(1e3,Math.round(u)),h=n.ticks(l);h.length<=1&&(h=n.ticks(l+1));var f=i>0?Ji(h,i,n):h;f.sort(function(t,e){return t-e});var d=f.map(Xi(c));return f.map(function(t,e){var r=n(t);return{position:r,start:r,end:r,label:d[e],value:t,isMinor:-1===h.indexOf(t)}})}function ta(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,c=void 0===s?void 0:s,u=V(o)||V(e)?2:Math.max(e/o,2),l=Math.min(1e3,Math.round(u)),h=l>10?10:l;n.nice(h);var f=n.ticks(l),d=i>0?Ji(f,i,n):f;d.sort(function(t,e){return t-e});var p=d.map(Xi(c));return d.map(function(t,e){var r=n(t);return{position:r,start:r,end:r,label:p[e],value:t,isMinor:-1===f.indexOf(t)}})}function ea(t){var e,n=t.settings,r=t.scale,i=t.distance,a=t.formatter,o=void 0===a?function(t){return t}:a,s=n.minorTicks&&!V(n.minorTicks.count)?Math.min(100,n.minorTicks.count):0;if(Array.isArray(n.ticks.values))e=function(t){var e=t.values,n=t.scale,r=t.formatter,i=void 0===r?function(t){return t}:r;return e.sort(function(t,e){return(Gi(t)?t.value:t)-(Gi(e)?e.value:e)}).filter(function(t,e,r){var i=Gi(t)?t.value:t;return i<=n.max()&&i>=n.min()&&r.indexOf(t)===e}).map(function(t){var e=Gi(t)?t.value:t,r=n(e);return{position:r,value:e,label:Gi(t)&&void 0!==t.label?t.label:i(e),isMinor:!1,start:Gi(t)&&!isNaN(t.start)?Ki(n(t.start)):r,end:Gi(t)&&!isNaN(t.end)?Ki(n(t.end)):r}})}({values:n.ticks.values.filter(function(t){return"object"===_(t)?!V(t.value):!V(t)}),scale:r.copy(),formatter:o});else if(V(n.ticks.count)){e=(n.ticks.tight?ta:Qi)({distance:i,minorCount:s,unitDivider:n.ticks.distance,scale:r,formatter:o}),n.ticks.forceBounds&&function(t,e,n){var r=t.map(function(t){return t.position}),i=e.range();-1===r.indexOf(i[0])?t.splice(0,0,{position:i[0],start:i[0],end:i[0],label:n(e.start()),isMinor:!1,value:e.start()}):t[0]&&t[0].isMinor&&(t[0].isMinor=!1);var a=t[t.length-1];-1===r.indexOf(i[1])?t.push({position:i[1],start:i[1],end:i[1],label:n(e.end()),isMinor:!1,value:e.end()}):a&&a.isMinor&&(a.isMinor=!1)}(e,r,o)}else{e=function(t){var e=t.count,n=t.minorCount,r=t.scale,i=t.formatter;return r.ticks((e-1)*n+e).map(function(t,e){var a=r(t);return{position:a,start:a,end:a,label:i(t),isMinor:e%(n+1)!=0,value:t}})}({count:Math.min(1e3,n.ticks.count),minorCount:s,scale:r.copy(),formatter:o})}return e}function na(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return Object.keys(e).forEach(function(i){var a=_(t[i]);r[i]="function"===a?t[i](n):"undefined"===a?e[i]:t[i]}),r}var ra={min:NaN,max:NaN,expand:NaN,include:[],invert:!1},ia={tight:!1,forceBounds:!1,values:void 0,count:NaN,distance:100},aa={count:NaN};function oa(t,e){t.instance||(t.instance=e.copy(),t.instance.domain([e.start(),e.end()]),t.instance.clamp(!0),t.instance.range(t.invert?[1,0]:[0,1]))}function sa(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Yi(),a={instance:null,invert:!1},o={data:n,resources:r},s=na(e,ra,o);function c(t){return V(t)?NaN:i(t)}s.ticks=na(e.ticks,ia,o),s.minorTicks=na(e.minorTicks,aa,o),c.data=function(){return n},c.invert=function(t){return i.invert(t)},c.rangeRound=function(t){return i.rangeRound(t),c},c.clamp=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return i.clamp(t),c},c.cachedTicks=function(){return t},c.clearTicksCache=function(){return t=void 0,this},c.ticks=function(e){return null!==e&&"object"===_(e)?(e.settings=e.settings||{},e.settings=k(!0,{},s,e.settings),e.scale=c,t=ea(e)):t=i.ticks(e)},c.nice=function(t){return i.nice(t),c},c.tickFormat=function(t,e){return i.tickFormat(t,e)},c.interpolate=function(t){return i.interpolate(t),c},c.domain=function(t){return arguments.length?(i.domain(t),a.instance&&a.instance.domain([c.start(),c.end()]),c):i.domain()},c.range=function(t){return arguments.length?(i.range(t),c):i.range()},c.start=function(){return c.domain()[0]},c.end=function(){return c.domain()[this.domain().length-1]},c.min=function(){return Math.min(this.start(),this.end())},c.max=function(){return Math.max(this.start(),this.end())},c.classify=function(t){for(var e=(c.start()-c.end())/t,n=[c.end()],r=[],i=e/2,a=0;a<t;a++){var o=n[n.length-1]||0,s=o+e,u=c(o+i);n.push.apply(n,[s,s]),r.push.apply(r,[u,u])}return n.pop(),c.domain(n),c.range(r),c},c.copy=function(){var t=sa(e,n,r);return t.domain(c.domain()),t.range(c.range()),t.clamp(i.clamp()),t},c.norm=function(t){return oa(a,c),a.instance(t)},c.normInvert=function(t){return oa(a,c),a.instance.invert(t)};var u=function(t,e){var n=+t.min,r=+t.max,i=0,a=1;if(e&&e[0]){var o=e.map(function(t){return t.min()}).filter(function(t){return!isNaN(t)}),s=e.map(function(t){return t.max()}).filter(function(t){return!isNaN(t)});if(i=o.length?Math.min.apply(Math,I(o)):Number.NaN,a=s.length?Math.max.apply(Math,I(s)):Number.NaN,isNaN(i)||isNaN(a))i=-1,a=1;else if(i===a&&0===i)i=-1,a=1;else if(i===a&&i)i-=Math.abs(.1*i),a+=Math.abs(.1*a);else if(!isNaN(t.expand)){var c=a-i;i-=c*t.expand,a+=c*t.expand}if(Array.isArray(t.include)){var u=t.include.filter(function(t){return!isNaN(t)});i=Math.min.apply(Math,I(u).concat([i])),a=Math.max.apply(Math,I(u).concat([a]))}}return{mini:isNaN(n)?i:n,maxi:isNaN(r)?a:r}}(s,n?n.fields:[]),l=u.mini,h=u.maxi;return c.domain([l,h]),c.range(s.invert?[1,0]:[0,1]),a.invert=s.invert,c}var ca={padding:0,paddingInner:NaN,paddingOuter:NaN,align:.5,invert:!1,maxPxStep:NaN,range:[0,1]};function ua(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Or(),i={data:e,resources:n},a=na(t,ca,i),o=e.items||[],s={},c=[],u=[];function l(t,n){t.data=function(){return e},t.datum=function(t){return o[s[t]]},t.start=function(){return t.domain()[0]},t.end=function(){return t.domain()[t.domain().length-1]},t.labels=function(){return u},t.ticks=function(){var e,r,i,a,o,s,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.scale=t,e=c,n.trackBy,r=e.scale,i=r.domain(),a=r.data().items,o=r.labels?r.labels():i,s=r.bandwidth(),i.map(function(t,e){var n=r(t);return{position:n+s/2,label:"".concat(o[e]),data:a?a[e]:void 0,start:n,end:n+s}})}}l(r,t),r.pxScale=function(e){var n=a.maxPxStep;if(isNaN(n))return r;var i=r.domain().length,o=Math.max(1,i-r.paddingInner()+2*r.paddingOuter());if(o*n>=e)return r;var s=r.copy();s.type=r.type,l(s,t);var c=o*n/e,u=(1-c)*r.align();return s.range(a.invert?[c+u,u]:[u,c+u]),s};for(var h="function"==typeof t.value?t.value:function(t){return t.datum.value},f="function"==typeof t.label?t.label:function(t){return t.datum.label},d=0;d<o.length;d++){var p=k({datum:o[d]},i),g=h(p,d);-1===c.indexOf(g)&&(c.push(g),u.push(f(p,d)),s[g]=d)}return r.domain(c),r.range(a.invert?a.range.slice().reverse():a.range),r.padding(isNaN(a.padding)?0:a.padding),isNaN(a.paddingInner)||r.paddingInner(a.paddingInner),isNaN(a.paddingOuter)||r.paddingOuter(a.paddingOuter),r.align(isNaN(a.align)?.5:a.align),r}var la={depth:0};function ha(t,e,n){return t.ancestors().map(function(t){return e(k({datum:t.data},n))}).reverse().slice(1).toString()}var fa=function(t){return t.min()},da=function(t){return t.max()};function pa(t,e){var n=t&&!isNaN(t.min),r=t&&!isNaN(t.max),i=n?+t.min:0,a=r?+t.max:1;if(e&&e.length){if(!n){var o=e.map(fa).filter(W);i=o.length?Math.min.apply(Math,I(o)):i}if(!r){var s=e.map(da).filter(W);a=s.length?Math.max.apply(Math,I(s)):a}}return[i,a]}var ga={domain:[],range:[],invert:!1,min:NaN,max:NaN};function ya(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=sa(t,e,n).clamp(!0).interpolate(Oi),i=na(t,ga,{data:e,resources:n}),a=Array.isArray(i.domain)&&i.domain.length,o=Array.isArray(i.range)&&i.range.length,s=r;k(!0,s,r);var c=P(pa(i,e?e.fields:[]),2),u=c[0],l=c[1],h=a?i.domain.length:-1,f=n.theme?n.theme.palette("sequential",h>0?h:2):[],d=o?i.range:f;return s.range(i.invert?d.slice().reverse():d.slice()),s.domain(a?i.domain:function(t,e,n){var r=t.length;if(2===r)return[e,n];var i=[],a=(n-e)/(r-1);i.push(e);for(var o=1;o<r-1;o++)i.push(e+a*o);return i.push(n),i}(s.range(),u,l)),s}var va={domain:[],range:[],invert:!1,min:NaN,max:NaN,nice:!1};var ma={domain:[],range:[]};var xa={domain:[],range:[],unknown:void 0},ba={domain:[],range:[],override:!1};var wa=se();function ka(t,e,n){var r=t.data;t.source&&(n.logger.warn("Deprecated: Scale data source configuration"),r={extract:[]},(Array.isArray(t.source)?t.source:[t.source]).forEach(function(t){r.extract.push({field:t})}));var i,a=lr(r,e,n),o=t.type||function(t){return t.root?"h-band":t.fields&&t.fields[0]?-1!==t.fields.map(function(t){return"dimension"===t.type()?"band":"linear"}).indexOf("linear")?"linear":"band":"linear"}(a);return"color"===o&&(o=a.fields&&a.fields[0]&&"dimension"===a.fields[0].type()?"categorical-color":"sequential-color"),n.scale.has(o)&&((i=(i=n.scale.get(o))(t,a,{theme:n.theme,logger:n.logger})).type=o),i}wa("linear",sa),wa("band",ua),wa("h-band",function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={data:n,resources:r},a=na(e,ca,i);a.ticks=na(e.ticks,la,i),a.value="function"==typeof e.value?e.value:function(t){return t.datum.value},a.label="function"==typeof e.label?e.label:function(t){return t.datum.value};var o=ua(a),s=function(t,e,n){var r=e.ticks.depth,i=e.value,a=e.label,o=[],s=[],c={},u=[],l=0;if(!t)return{values:o,labels:s,items:c,ticks:u};t.eachAfter(function(t){if(t.depth>0){var e=ha(t,i,n),h=t.leaves()||[t],f=i(k({datum:t.data},n)),d=a(k({datum:t.data},n)),p=Array.isArray(t.children),g={key:e,count:h.length,value:f,label:d,leftEdge:ha(h[0],i,n),rightEdge:ha(h[Math.max(h.length-1,0)],i,n),node:t};p?(o.push("SPACER_".concat(l,"_SPACER")),l++):(o.push(e),s.push(d)),(r<=0&&!p||t.depth===r)&&u.push(g),c[e]=g}});var h=t.height-1;return h>0&&o.splice(-h),{values:o,labels:s,items:c,ticks:u}}(n.root,a,i),c=s.values,u=s.labels,l=s.items,h=s.ticks,f=function(t){var e=String(t),n=l[e];return o(n?a.invert?n.rightEdge:n.leftEdge:e)};k(!0,f,o),f.bandwidth=function(t){var e=l[String(t)],n=o.bandwidth();if(e&&!e.isLeaf){var r=f(e.leftEdge),i=f(e.rightEdge);return Math.abs(r-i)+n}return n},f.step=function(t){var e=l[String(t)],n=e?e.count:1,r=o.step();return r*=n},f.data=function(){return n},f.datum=function(t){var e=l[String(t)];return e?e.node.data:null},f.copy=function(){return t(e,n,r)},f.labels=function(){return u},f.ticks=function(){return h.map(function(t){var e=f(t.key),n=f.bandwidth(t.key);return{position:e+n/2,label:t.label,data:t.node.data,start:e,end:e+n}})};var d=o.pxScale;return f.pxScale=function(t){return o=d(t),f},f.domain(c),f}),wa("sequential-color",ya),wa("threshold-color",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function t(){var e,n=[.5],r=[0,1],i=1;function a(t){return t<=t?r[gr(n,t,0,i)]:e}return a.domain=function(t){return arguments.length?(n=Ar.call(t),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(t){return arguments.length?(r=Ar.call(t),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(r).unknown(e)},br.apply(a,arguments)}(),i=na(t,va,{data:e,resources:n}),a=Array.isArray(i.domain)&&i.domain.length,o=Array.isArray(i.range)&&i.range.length;function s(t){return V(t)?NaN:r(t)}Object.keys(r).forEach(function(t){return s[t]=r[t]});var c=P(pa(i,e.fields),2),u=c[0],l=c[1],h=a?i.domain.length:-1,f=n.theme?n.theme.palette("sequential",h>0?h:2):[],d=o?i.range:f,p=[];return p=a?i.domain:i.nice?function(t,e,n){var r=2===t.length?10:Math.max(1,t.length),i=Yi().domain([e,n]).nice(r).ticks(r);if(!t||!t.length)return i;for(var a=Math.max(0,t.length-1);i.length>a;)i[0]-e<=n-i[i.length-1]?i.shift():i.pop();return i}(d,u,l):[u+(l-u)/2],d.length>p.length+1?p=function(t,e,n){var r=t.length;if(2===r)return[e+(n-e)/2];for(var i=[],a=(n-e)/r,o=1;o<r;o++)i.push(e+a*o);return i}(d,u,l):d.length<p.length+1&&(d=function(t,e,n,r){n=t[0],r=t&&t.length>=2?t[t.length-1]:r;var i=ya().domain([n,r]).range(e);return[n].concat(I(function(t){for(var e=[],n=0;n<t.length-1;n++)e.push((t[n]+t[n+1])/2);return e}(t)),[r]).map(function(t){return i(t)})}(p,d,u,l)),s.data=function(){return e},s.range(i.invert?d.slice().reverse():d),s.domain(p),s}),wa("categorical-color",function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Nr(),i={data:e,resources:n},a=na(t,ma,i),o="function"==typeof t.value?t.value:function(t){return t.datum.value},s="function"==typeof t.label?t.label:function(t){return t.datum.label},c=e.items||[],u={},l=[],h=[],f=0;f<c.length;f++){var d=k({datum:c[f]},i),p=o(d,f);-1===l.indexOf(p)&&(l.push(p),h.push(s(d,f)),u[p]=f)}return r.data=function(){return e},r.labels=function(){return h},r.label=function(t){return h[l.indexOf(t)]},r.datum=function(t){return c[u[t]]},r.range(a.range),Array.isArray(a.domain)&&a.domain.length?r.domain(a.domain):r.domain(l),r}(e,n,r),a=r.theme,o=na(e,xa,{data:n,resources:r});if(o.explicit=na(e.explicit,ba,{data:n,resources:r}),t=Array.isArray(o.range)&&0!==o.range.length?o.range.slice():a?a.palette("categorical",i.domain().length).slice():[],o.unknown)i.unknown(o.unknown);else if(a&&a.palette("unknown")){var s=a.palette("unknown");i.unknown(s[0])}if(Array.isArray(o.explicit.domain)&&o.explicit.domain.length){for(var c=i.domain().slice(),u=o.explicit.domain,l=Array.isArray(o.explicit.range)?o.explicit.range:[],h=Math.floor(c.length/t.length),f=1;f<h+1;f*=2)t=t.concat(t);if(o.explicit.override)for(var d=0;d<u.length;d++){var p=c.indexOf(u[d]);p>-1&&(t[p]=l[d])}else u.map(function(t,e){return[c.indexOf(t),t,l[e]]}).sort(function(t,e){return t[0]-e[0]}).forEach(function(e){var n=c.indexOf(e[1]);-1!==n&&t.splice(n,0,e[2])});t.length=c.length}return i.range(t),i});var Ma={};function _a(){_a.init.call(this)}Ma.isObject=function(t){return"object"===a(t)&&null!==t},Ma.isNumber=function(t){return"number"==typeof t},Ma.isUndefined=function(t){return void 0===t},Ma.isFunction=function(t){return"function"==typeof t};var Sa=_a;_a.EventEmitter=_a,_a.prototype._events=void 0,_a.prototype._maxListeners=void 0,_a.defaultMaxListeners=10,_a.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},_a.prototype.setMaxListeners=function(t){if(!Ma.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},_a.prototype.emit=function(t){var e,n,r,i,a,o;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],Ma.isUndefined(n))return!1;if(Ma.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];n.apply(this,i)}else if(Ma.isObject(n)){for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];for(r=(o=n.slice()).length,a=0;a<r;a++)o[a].apply(this,i)}return!0},_a.prototype.addListener=function(t,e){var n;if(!Ma.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Ma.isFunction(e.listener)?e.listener:e),this._events[t]?Ma.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Ma.isObject(this._events[t])&&!this._events[t].warned)&&((n=Ma.isUndefined(this._maxListeners)?_a.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,Ma.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),Ma.isFunction(console.trace)&&console.trace()));return this},_a.prototype.on=_a.prototype.addListener,_a.prototype.once=function(t,e){if(!Ma.isFunction(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},_a.prototype.removeListener=function(t,e){var n,r,i,a;if(!Ma.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||Ma.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Ma.isObject(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},_a.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],Ma.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},_a.prototype.listeners=function(t){return this._events&&this._events[t]?Ma.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},_a.listenerCount=function(t,e){return t._events&&t._events[e]?Ma.isFunction(t._events[e])?1:t._events[e].length:0};var Ra={mixin:function(t){return Object.keys(Sa.prototype).forEach(function(e){t[e]=Sa.prototype[e]}),Sa.init(t),t}};function Aa(){var t=0,e=0,n=0,r=0;n=n||t;var i={move:function(t){this.moveTo(n+t)},moveTo:function(a){var o=Math.max(t,Math.min(e-r,a));n!==o&&(n=o,i.emit("update"))},update:function(a){var o=!1,s=a.min;t=void 0===s?t:s;var c=a.max;e=void 0===c?e:c,void 0!==a.viewSize&&a.viewSize!==r&&(r=a.viewSize,o=!0);var u=Math.max(t,Math.min(e-r,n));n!==u&&(n=u,o=!0),o&&i.emit("update")},getState:function(){return{min:t,max:e,start:n,viewSize:r}}};return Ra.mixin(i),i}function Ca(t,e,n){for(var r=0;r<t.length&&e>t[r];)++r;return t[r]===e&&n&&++r,r}function Na(){var t=[];function e(){}return e.add=function(e){var n,r=e.min,i=e.max,a=Ca(t,r),o=Ca(t,i,!0),s=[a,o-a];a%2==0&&s.push(r),o%2==0&&s.push(i);var c=t.join(",");return(n=t).splice.apply(n,s),c!==t.join(",")},e.remove=function(e){var n,r=e.min,i=e.max,a=Ca(t,r),o=Ca(t,i,!0),s=[a,o-a];a%2==1&&s.push(r),o%2==1&&s.push(i);var c=t.join(",");return(n=t).splice.apply(n,s),c!==t.join(",")},e.set=function(n){var r=t.join(",");return t=[],Array.isArray(n)?n.forEach(e.add):e.add(n),r!==t.join(",")},e.clear=function(){var e=t.length>0;return t=[],e},e.containsValue=function(e){return function(t,e){for(var n=t.length,r=1;r<n;r+=2)if(t[r-1]<=e&&e<=t[r])return!0;return!1}(t,e)},e.containsRange=function(e){var n=e.min,r=e.max,i=Ca(t,n,!0),a=Ca(t,r);return i===a&&a%2==1},e.toggle=function(t){return e.containsRange(t)?e.remove(t):e.add(t)},e.ranges=function(){for(var e=[],n=1;n<t.length;n+=2)e.push({min:t[n-1],max:t[n]});return e},e}function Oa(){var t=[];function e(){}return e.add=function(e){return-1===t.indexOf(e)&&(t.push(e),!0)},e.remove=function(e){var n=t.indexOf(e);return-1!==n&&(t.splice(n,1),!0)},e.contains=function(e){return-1!==t.indexOf(e)},e.values=function(){return t.slice()},e.clear=function(){return t=[]},e.toString=function(){return t.join(";")},e}function Ta(t){for(var e,n,r=t.items,i=t.collection,a=t.vc,o={},s=[],c=0,u=r.length;c<u;c++){i[e=r[c].key]||(i[e]=a()),n=r[c].values||[r[c].value];for(var l=0;l<n.length;l++)i[e].add(n[l])&&(o[e]=o[e]||[],o[e].push(n[l]))}for(var h=Object.keys(o),f=0,d=h.length;f<d;f++)e=h[f],s.push({id:e,values:o[e]});return s}function Ea(t){for(var e,n,r=t.items,i=t.collection,a={},o=[],s=0,c=r.length;s<c;s++)if(i[e=r[s].key]){n=r[s].values||[r[s].value];for(var u=0;u<n.length;u++)i[e].remove(n[u])&&(a[e]=a[e]||[],a[e].push(n[u]))}for(var l=Object.keys(a),h=0,f=l.length;h<f;h++)e=l[h],o.push({id:e,values:a[e]});return o}function Da(t){for(var e,n,r={},i=0,a=t.length;i<a;i++){e=t[i].key,n=t[i].values||[t[i].value],r[e]||(r[e]=[]);for(var o=0;o<n.length;o++){-1===r[e].indexOf(n[o])&&r[e].push(n[o])}}return r}function za(t){var e=t.key,n=t.collection,r=t.obj,i=t.fn,a=t.value;n[e]||(n[e]=i()),r[e]=r[e]||[],r[e].push(a),n[e].add(a)}function ja(t,e){for(var n,r,i=[],a=Object.keys(t),o=function(t){return-1===e[n].indexOf(t)},s=0,c=a.length;s<c;s++)n=a[s],e[n]?(r=t[n].filter(o)).length&&i.push({id:n,values:r}):i.push({id:n,values:t[n]});return i}function qa(t,e,n){var r=function(t,e){if(!Object.keys(e).length)return t;for(var n=t.length,r=Array(n),i=0;i<n;i++)r[i]=t[i].key in e?k({},t[i],{key:e[t[i].key]}):t[i];return r}(e,n);return t&&t.length?t.reduce(function(t,e){return e(t)},r):r}function Pa(t){return t.replace(/(-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function Ia(t,e,n){var r=n.ranges,i=n.interceptors,a=n.rc,o=n.aliases,s=qa(i["".concat(e,"Ranges")],t,o),c=!1;return s.forEach(function(t){var n=t.key;if(r[n]||(r[n]=a()),"set"===e)c=r[n][e](t.ranges||t.range)||c;else for(var i=t.ranges||[t.range],o=0;o<i.length;o++)c=r[n][e](i[o])||c}),c}function Fa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vc,n=void 0===e?Oa:e,r=t.rc,i=void 0===r?Na:r,a=!1,o={},s={},c={},u={addValues:[],removeValues:[],toggleValues:[],setValues:[],addRanges:[],setRanges:[],removeRanges:[],toggleRanges:[]},l=function(){var t={values:{},ranges:{}};return Object.keys(s).forEach(function(e){t.values[e]=s[e].values()}),Object.keys(o).forEach(function(e){t.ranges[e]=o[e].ranges()}),t},h={ls:[],clear:function(){this.ls.forEach(function(t){return t.clear()})},start:function(){this.ls.forEach(function(t){return t.start()})},end:function(){this.ls.forEach(function(t){return t.end()})},update:function(){var t=l();this.ls.forEach(function(e){return e._state(t)})},updateValues:function(){var t=l();this.ls.forEach(function(e){return e._state({values:t.values})})},updateRanges:function(){var t=l();this.ls.forEach(function(e){return e._state({ranges:t.ranges})})}},f={link:function(t){if(f===t)throw new Error("Can't link to self");h.ls.push(t),t._state(l())},_state:function(t){if(!t)return l();if(t.values){var e=[];Object.keys(t.values).forEach(function(n){s[n]&&t.values[n].join(";")===s[n].toString()||e.push({key:n,values:t.values[n]})}),Object.keys(s).forEach(function(n){t.values[n]||e.push({key:n,values:[]})}),e.length&&f.setValues(e)}if(t.ranges){var n=[];Object.keys(t.ranges).forEach(function(e){o[e]&&t.ranges[e].join(";")===o[e].toString()||n.push({key:e,ranges:t.ranges[e]})}),Object.keys(o).forEach(function(e){t.ranges[e]||n.push({key:e,ranges:[]})}),n.length&&f.setRanges(n)}},start:function(){a||(a=!0,f.emit("start"),h.start())},end:function(){a&&(a=!1,o={},s={},f.emit("end"),h.end())},isActive:function(){return a},clear:function(){var t=f.brushes().filter(function(t){return"value"===t.type&&t.brush.values().length}).map(function(t){return{id:t.id,values:t.brush.values()}}),e=Object.keys(o).length>0||t.length;o={},s={},e&&(f.emit("update",[],t),h.clear())},brushes:function(){var t=[];return t=(t=t.concat(Object.keys(o).map(function(t){return{type:"range",id:t,brush:o[t]}}))).concat(Object.keys(s).map(function(t){return{type:"value",id:t,brush:s[t]}}))},addValue:function(t,e){f.addValues([{key:t,value:e}])},addValues:function(t){var e=qa(u.addValues,t,c),r=Ta({vc:n,collection:s,items:e});f.emit("add-values",e),r.length&&(a||(a=!0,f.emit("start")),f.emit("update",r,[]),h.updateValues())}};return f.setValues=function(t){var e=qa(u.setValues,t,c),r=function(t){for(var e,n,r=t.items,i=t.vCollection,a=t.vc,o={},s=Da(r),c={},u=Object.keys(i),l=0,h=u.length;l<h;l++)c[n=u[l]]=i[n].values().slice(),delete i[n];for(var f=function(t){i[n]&&i[n].contains(t)||za({key:n,value:t,collection:i,obj:o,fn:a})},d=Object.keys(s),p=0,g=d.length;p<g;p++)s[n=d[p]].forEach(f);return e=ja(c,o),[ja(o,c),e]}({items:e,vCollection:s,vc:n});f.emit("set-values",e),(r[0].length>0||r[1].length>0)&&(a||(a=!0,f.emit("start")),f.emit("update",r[0],r[1]),h.updateValues())},f.removeValue=function(t,e){f.removeValues([{key:t,value:e}])},f.removeValues=function(t){var e=qa(u.removeValues,t,c),n=Ea({collection:s,items:e});f.emit("remove-values",e),n.length&&(f.emit("update",[],n),h.updateValues())},f.addAndRemoveValues=function(t,e){var r=qa(u.addValues,t,c),i=qa(u.removeValues,e,c),o=Ta({vc:n,collection:s,items:r}),l=Ea({collection:s,items:i});f.emit("add-values",r),f.emit("remove-values",i),(o.length||l.length)&&(a||(a=!0,f.emit("start")),f.emit("update",o,l),h.updateValues())},f.toggleValue=function(t,e){f.toggleValues([{key:t,value:e}])},f.toggleValues=function(t){var e=qa(u.toggleValues,t,c),r=function(t){for(var e,n,r,i=t.items,a=t.values,o=t.vc,s={},c={},u=[],l=[],h=Da(i),f=Object.keys(h),d=0,p=f.length;d<p;d++)for(var g=0,y=(r=h[e=f[d]]).length;g<y;g++)n=r[g],a[e]&&a[e].contains(n)?a[e]&&a[e].contains(n)&&(c[e]=c[e]||[],c[e].push(n),a[e].remove(n)):za({key:e,value:n,collection:a,obj:s,fn:o});for(var v=Object.keys(s),m=0,x=v.length;m<x;m++)e=v[m],u.push({id:e,values:s[e]});for(var b=Object.keys(c),w=0,k=b.length;w<k;w++)e=b[w],l.push({id:e,values:c[e]});return[u,l]}({items:e,values:s,vc:n});f.emit("toggle-values",e),(r[0].length>0||r[1].length>0)&&(a||(a=!0,f.emit("start")),f.emit("update",r[0],r[1]),h.updateValues())},f.containsValue=function(t,e){var n=c[t]||t;return!!s[n]&&s[n].contains(e)},f.addRange=function(t,e){f.addRanges([{key:t,range:e}])},f.addRanges=function(t){Ia(t,"add",{ranges:o,rc:i,interceptors:u,aliases:c})&&(a||(a=!0,f.emit("start")),f.emit("update",[],[]),h.updateRanges())},f.removeRange=function(t,e){f.removeRanges([{key:t,range:e}])},f.removeRanges=function(t){Ia(t,"remove",{ranges:o,rc:i,interceptors:u,aliases:c})&&(a||(a=!0,f.emit("start")),f.emit("update",[],[]),h.updateRanges())},f.setRange=function(t,e){f.setRanges([{key:t,range:e}])},f.setRanges=function(t){Ia(t,"set",{ranges:o,rc:i,interceptors:u,aliases:c})&&(a||(a=!0,f.emit("start")),f.emit("update",[],[]),h.updateRanges())},f.toggleRange=function(t,e){f.toggleRanges([{key:t,range:e}])},f.toggleRanges=function(t){Ia(t,"toggle",{ranges:o,rc:i,interceptors:u,aliases:c})&&(a||(a=!0,f.emit("start")),f.emit("update",[],[]),h.updateRanges())},f.containsRangeValue=function(t,e){var n=c[t]||t;return!!o[n]&&o[n].containsValue(e)},f.containsRange=function(t,e){var n=c[t]||t;return!!o[n]&&o[n].containsRange(e)},f.containsMappedData=function(t,e,n){for(var r,i,a,u,l=[],h=Object.keys(t),f=0,d=h.length;f<d;f++){if("value"===(r=h[f]))i=t,l[f]={key:"",i:f,bool:!1};else{if("source"===r)continue;i=t[r],l[f]={key:r,i:f,bool:!1}}void 0!==(a=i.source&&i.source.field)&&(void 0!==i.source.key&&(a="".concat(i.source.key,"/").concat(a)),a in c&&(a=c[a]),u=i.value,o[a]?l[f].bool=Array.isArray(u)?o[a].containsRange({min:u[0],max:u[1]}):o[a].containsValue(u):s[a]&&s[a].contains(u)&&(l[f].bool=!0))}return e?(l=l.filter(function(t){return-1!==e.indexOf(t.key)}),"and"===n?!!l.length&&!l.some(function(t){return!1===t.bool}):"xor"===n?!!l.length&&l.some(function(t){return t.bool})&&l.some(function(t){return!1===t.bool}):l.some(function(t){return t.bool})):l.some(function(t){return t.bool})},f.intercept=function(t,e){var n=Pa(t);u[n]&&u[n].push(e)},f.removeInterceptor=function(t,e){var n=Pa(t);if(u[n]){var r=u[n].indexOf(e);-1!==r&&u[n].splice(r,1)}},f.removeAllInterceptors=function(t){var e=[];if(t){var n=Pa(t);u[n]&&u[n].length&&e.push({name:t,handlers:u[n]})}else Object.keys(u).forEach(function(t){var n;u[t].length&&e.push({name:(n=t,n.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})),handlers:u[t]})});e.forEach(function(t){t.handlers.slice().forEach(function(e){return f.removeInterceptor(t.name,e)})})},f.addKeyAlias=function(t,e){c[t]=e},f.removeKeyAlias=function(t){delete c[t]},Ra.mixin(f),f}se();function La(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Math.PI;var Ba=2*Math.PI,Wa=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Ba);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Ba)},i.period=function(n){return t(e,n)},i}(1,.3);function Va(t,e){return t.data?t.data.value:"text"===t.type?t.text:e}var Ha={fontFamily:"Arial",fontSize:"13px",color:"#595959",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0,$fill:"#333333"},Ua=/^\$/;function $a(t){var e=_(t);return"object"!==e&&"function"!==e&&"undefined"!==e}function Ya(t,e,n){var r=t[e];r&&r.scale&&r.scale.pxScale?r.scale=r.scale.pxScale(n):r&&r.pxScale&&(t[e]=r.pxScale(n))}function Xa(t,e){return t.pxScale?t.pxScale(e):t}var Ka={normalizeSettings:function(t,e,n){var r=k({},t),i=k({},e);return Object.keys(r).forEach(function(t){i[t]={};var a=r[t],o=_(a);if("function"==typeof a)i[t].fn=a;else if($a(a)){var s=e[t];"string"==typeof s&&Ua.test(s)&&(s=Ha[s]);var c=_(s);i[t]="undefined"===c?a:c===o?a:s}else a&&"object"===_(a)&&("function"==typeof a.fn&&(i[t].fn=a.fn),void 0!==a.scale&&(i[t].scale=n.scale(a.scale)),"string"==typeof a.ref&&(i[t].ref=a.ref))}),Object.keys(e).forEach(function(t){if(!(t in r)){var n=e[t];"string"===_(n)&&Ua.test(n)?i[t]=Ha[n]:i[t]=n}}),i},resolveForItem:function(t,e,n){for(var r={},i=Object.keys(e),a=i.length,o=t.datum,s=t.datum,c=0;c<a;c++){var u=i[c],l=e[u],h="object"===_(s)&&void 0!==l,f=h&&"string"==typeof l.ref,d=h&&u in s,p=f?s[l.ref]:d?s[u]:o;$a(l)?r[u]=l:h&&l.fn?(l.scale&&(t.scale=l.scale),r[u]=l.fn.call(null,t,n)):h&&l.scale&&p?(r[u]=l.scale(p.value),l.scale.bandwidth&&(r[u]+=l.scale.bandwidth()/2)):f&&p?r[u]=p.value:l.fn?r[u]=l.fn.call(null,t,n):r[u]=l}return r},updateScaleSize:Ya};function Ga(t,e){var n=e.context,r=e.data,i=e.style,a=e.filter,o=e.mode,s=t.chart.brush(n),c=r,u=i.active||{},l=i.inactive||{},h=[];Object.keys(u).forEach(function(t){h.push(t)}),Object.keys(l).forEach(function(t){-1===h.indexOf(t)&&h.push(t)});var f=[],d=!1,p=function(){var e=function t(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,n){return Array.isArray(n.children)?(e.push.apply(e,I(t(n.children))),e):(e.push(n),e)},[])}(t.nodes);return"function"==typeof a&&(e=e.filter(a)),e},g=function(){for(var t,e=p(),n=e.length,r=!1,i=function(n){if(!(t=e[n].data))return"continue";e[n].__style||(e[n].__style={},h.forEach(function(t){e[n].__style[t]=e[n][t]}));var i=s.containsMappedData(t,c,o),a=f.indexOf(e[n]),p=!1;if(i&&-1===a?(f.push(e[n]),p=!0):i||-1===a||(f.splice(a,1),p=!0),p||d){var g=k({},e[n],e[n].__style);h.forEach(function(t){e[n][t]=i&&t in u?"function"==typeof u[t]?u[t].call(null,g):u[t]:!i&&t in l?"function"==typeof l[t]?l[t].call(null,g):l[t]:e[n].__style[t]}),r=!0}},a=0;a<n;a++)i(a);return d=!1,r},y=function(){for(var e=p(),n=e.length,r=function(t){if(!e[t].data)return"continue";e[t].__style=e[t].__style||{},h.forEach(function(n){e[t].__style[n]=e[t][n],n in l&&(e[t][n]="function"==typeof l[n]?l[n].call(null,e[t]):l[n])})},i=0;i<n;i++)r(i);d=!0,f.length=0,t.renderer.render(t.nodes)},v=function(){for(var e=p(),n=e.length,r=function(t){e[t].__style&&(Object.keys(e[t].__style).forEach(function(n){e[t][n]=e[t].__style[n]}),e[t].__style=void 0)},i=0;i<n;i++)r(i);f.length=0,t.renderer.render(t.nodes)},m=function(){g()&&t.renderer.render(t.nodes)};return s.on("start",y),s.on("end",v),s.on("update",m),{isActive:function(){return s.isActive()},update:function(){f.length=0,d=!0,g()},cleanUp:function(){s.removeListener("start",y),s.removeListener("end",v),s.removeListener("update",m)}}}function Za(t){for(var e=t.nodes,n=t.action,r=t.chart,i=t.trigger,a=[],o=0;o<e.length;o++){var s=e[o].data;null!==s&&a.push(s)}!function(t){var e=t.dataPoints,n=t.action,r=t.chart,i=t.trigger;if(i){var a=i.data||[""],o={items:[],actionFn:"toggleRanges"},s={items:[],actionFn:"toggleValues"};-1!==["add","remove","set","toggle"].indexOf(n)&&(o.actionFn="".concat(n,"Ranges"),s.actionFn="".concat(n,"Values"));for(var c=function(t){var n=e[t];if(!n)return"continue";a.forEach(function(t){var e=n&&!t?n:n[t];if(e){var r={key:e.source.field};void 0!==e.source.key&&(r.key="".concat(e.source.key,"/").concat(e.source.field)),Array.isArray(e.value)?(r.range={min:e.value[0],max:e.value[1]},o.items.push(r)):(r.value=e.value,s.items.push(r))}})},u=0;u<e.length;u++)c(u);i.contexts.forEach(function(t){o.items.length?r.brush(t)[o.actionFn](o.items):r.brush(t)[s.actionFn](s.items)})}}({dataPoints:a,action:n,chart:r,trigger:i})}function Ja(t){var e=t.collisions,n=t.t,r=t.config,i=t.action,a=[],o=!1;return e.length>0&&(a=e,o=!0,"stop"===n.propagation&&(a=[e[e.length-1]])),Za({nodes:a.map(function(t){return t.node}),action:i,chart:r.chart,data:r.data,trigger:n}),o}function Qa(t,e,n){var r=n.element().getBoundingClientRect(),i=at(t)?function(t,e){return 1!==t.changedTouches.length?null:{x:t.changedTouches[0].clientX-e.left,y:t.changedTouches[0].clientY-e.top}}(t,r):function(t,e){return{x:t.clientX-e.left,y:t.clientY-e.top}}(t,r);return null===i||i.x<0||i.y<0||i.x>r.width||i.y>r.height?[]:(e.touchRadius>0&&at(t)&&(i={cx:i.x,cy:i.y,r:e.touchRadius}),n.itemsAt(i))}function to(t,e,n){return t?"function"==typeof t?t(e):t:n}var eo={fill:"fill",stroke:"stroke",opacity:"opacity",strokeWidth:"stroke-width",strokeLinejoin:"stroke-linejoin",fontFamily:"font-family",fontSize:"font-size",baseline:"dominant-baseline",dominantBaseline:"dominant-baseline",anchor:"text-anchor",textAnchor:"text-anchor",maxWidth:"maxWidth",transform:"transform",strokeDasharray:"stroke-dasharray",id:"id"};function no(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",r=0;r<t.length;r++){var i=t[r];n+=0===r?"M".concat(i.x," ").concat(i.y):"L".concat(i.x," ").concat(i.y),n+=" "}return e&&(n+="Z"),n}function ro(t,e,n,r){var i=n/2,a=t-r/2,o=e-r/2,s=t-i,c=e-i;return[{x:a,y:o},{x:a,y:c},{x:a+r,y:c},{x:a+r,y:o},{x:s+n,y:o},{x:s+n,y:o+r},{x:a+r,y:o+r},{x:a+r,y:c+n},{x:a,y:c+n},{x:a,y:o+r},{x:s,y:o+r},{x:s,y:o}]}function io(t){return-t/180*Math.PI}function ao(t){return e=io(t),n=(.5*(Math.floor(e/Math.PI*2)+2)+.25)*Math.PI,r=Math.cos(Math.abs(n-e))*Math.sqrt(2),i=r*Math.cos(e),a=r*Math.sin(e),{x1:i<0?1:0,y1:a<0?1:0,x2:i>=0?i:i+1,y2:a>=0?a:a+1};var e,n,r,i,a}function oo(t,e){return{x:t.x+e.x,y:t.y+e.y}}function so(t,e){return{x:t.x-e.x,y:t.y-e.y}}function co(t,e){return{x:t.x*e,y:t.y*e}}function uo(t,e){return t.x-e.x}function lo(t,e){return t.y-e.y}function ho(t,e){return Math.pow(uo(t,e),2)+Math.pow(lo(t,e),2)}function fo(t,e){return Math.sqrt(ho(t,e))}function po(t,e){return t.x*e.x+t.y*e.y}function go(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=Math.cos(e),i=Math.sin(e),a=so(t,n);return oo({x:r*a.x-i*a.y,y:i*a.x+r*a.y},n)}var yo={up:0,down:180,left:90,right:-90};var vo=se();function mo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=vo.get(t.type);if(e){var n=e(t);return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach(function(n){void 0!==eo[n]&&"transform"!==n&&(t[n]=e[n])})}(n,t),void 0!==t.data&&(n.data=t.data),n}return e}function xo(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.dock,i=void 0===r?"":r,a=e.displayOrder,o=void 0===a?0:a,s=e.prioOrder,c=void 0===s?0:s,u=e.preferredSize,l=void 0===u?0:u,h=e.minimumLayoutMode,f=e.show,d=void 0===f||f,p=function(){};return p.computePreferredSize=function(t,e){return"function"==typeof l?l({inner:t,outer:e,dock:p.dock()},n):l},p.dock=function(t){return void 0!==t?(i=t,p):"function"==typeof i?i(n):i},p.displayOrder=function(e){return void 0!==e?(o=e,t):"function"==typeof o?o(n):o},p.prioOrder=function(e){return void 0!==e?(c=e,t):"function"==typeof c?c(n):c},p.minimumLayoutMode=function(e){return void 0!==e?(h=e,t):"function"==typeof h?h(n):h},p.show=function(e){return void 0!==e?(d=e,t):"function"==typeof d?d(n):d},p}vo.add("circle",function(t){return{type:"circle",fill:"black",cx:t.x,cy:t.y,r:t.size/2}}),vo.add("diamond",function(t){var e=t.size,n=t.x-e/2,r=t.y-e/2;return{type:"path",fill:"black",d:no([{x:n,y:r+e/2},{x:n+e/2,y:r},{x:n+e,y:r+e/2},{x:n+e/2,y:r+e},{x:n,y:r+e/2}])}}),vo.add("saltire",function(t){var e=io(45),n=t.size/2,r=isNaN(t.width)?n/2:t.width,i=Math.min(r,n),a=t.size,o=Math.sin(Math.asin(-e))*(i/2);a+=2*(n/Math.sin(-e)-n),a-=2*o;var s={x:t.x,y:t.y};return{type:"path",fill:"black",d:no(ro(t.x,t.y,a,i).map(function(t){return go(t,e,s)}))}}),vo.add("square",function(t){var e=t.size;return{type:"rect",fill:"black",x:t.x-e/2,y:t.y-e/2,width:e,height:e}}),vo.add("triangle",function(t){var e=t.size,n={x:t.x,y:t.y},r=yo[t.direction]||0,i=e/2,a=t.x-i,o=t.y-i,s=[{x:a,y:o+e},{x:a+i,y:o},{x:a+e,y:o+e},{x:a,y:o+e}],c=io(r);return{type:"path",fill:"black",d:no(s=s.map(function(t){return go(t,c,n)}))}}),vo.add("line",function(t){var e="vertical"===t.direction,n=t.size/2,r=t.x,i=t.y;return{type:"line",stroke:"black",strokeWidth:1,x1:r-(e?0:n),y1:i-(e?n:0),x2:r+(e?0:n),y2:i+(e?n:0),collider:function(t){var e=t.x,n=t.y,r=t.size,i=r/2;return{type:"rect",x:e-i,y:n-i,width:r,height:r}}(t)}}),vo.add("star",function(t){for(var e=t.size,n=[],r=e/2,i=t.points||5,a=Math.min(t.innerRadius||e/2,e)/2,o=isNaN(t.startAngle)?90:t.startAngle,s=360/i,c=1;c<=i;c++){var u=s*c+o,l=io(u),h=io(u+s/2),f=Math.sin(l),d=Math.cos(l),p=Math.sin(h),g=Math.cos(h);n.push({x:t.x+d*r,y:t.y+f*r}),n.push({x:t.x+g*a,y:t.y+p*a})}return{type:"path",fill:"black",d:no(n)}}),vo.add("n-polygon",function(t){for(var e=[],n=t.size/2,r=Math.max(isNaN(t.sides)?6:t.sides,3),i=360/r,a=isNaN(t.startAngle)?0:t.startAngle,o=1;o<=r;o++){var s=io(i*o+a),c=Math.sin(s),u=Math.cos(s);e.push({x:t.x+u*n,y:t.y+c*n})}return{type:"path",fill:"black",d:no(e)}}),vo.add("cross",function(t){var e=t.x,n=t.y,r=t.size/2,i=isNaN(t.width)?r/2:t.width,a=Math.min(i,r);return{type:"path",fill:"black",d:no(ro(e,n,t.size,a))}}),vo.add("bar",function(t){var e={x:t.x,y:t.y},n="vertical"===t.direction,r=t.size/2,i=r/2/2,a=[{x:e.x-r,y:e.y+i},{x:e.x-r,y:e.y-i},{x:e.x+r,y:e.y-i},{x:e.x+r,y:e.y+i}];if(n){var o=io(90);a=a.map(function(t){return go(t,o,e)})}var s=Y(a);return s.type="rect",s.fill="black",s});var bo=function(t){return["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeUnmount","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","chart","dockConfig","mediator","style","resolver","registries","_DO_NOT_USE_getInfo","symbol","isVisible"].some(function(e){return e===t})};function wo(t,e,n){var r=e.require,i=void 0===r?[]:r,a=e.mediator||{},o=n.settings,s=n.formatter,c=n.scale,u=n.data,l=n.renderer,h=n.chart,f=n.dockConfig,d=n.mediator,p=n.instance,g=n.style,y=n.registries,v=n.resolver,m=n.update,x=n._DO_NOT_USE_getInfo,b=n.symbol,w=n.isVisible;t.emit=function(){},w&&(t.isVisible=w),Object.defineProperty(t,"settings",{get:o}),Object.defineProperty(t,"data",{get:u}),Object.defineProperty(t,"formatter",{get:s}),Object.defineProperty(t,"scale",{get:c}),Object.defineProperty(t,"mediator",{get:d}),Object.defineProperty(t,"style",{get:g}),Object.defineProperty(t,"registries",{get:y}),x&&(t._DO_NOT_USE_getInfo=x),Object.keys(e).forEach(function(n){bo(n)||("function"==typeof e[n]?t[n]=e[n].bind(t):t[n]=e[n])}),i.forEach(function(e){"renderer"===e?Object.defineProperty(t,"renderer",{get:l}):"chart"===e?Object.defineProperty(t,"chart",{get:h}):"dockConfig"===e?Object.defineProperty(t,"dockConfig",{get:f}):"instance"===e?Object.defineProperty(t,"instance",{get:p}):"update"===e&&m?Object.defineProperty(t,"update",{get:m}):"resolver"===e?Object.defineProperty(t,"resolver",{get:v}):"symbol"===e&&Object.defineProperty(t,"symbol",{get:b})}),Object.keys(a).forEach(function(e){t.mediator.on(e,a[e].bind(t))})}function ko(t,e){var n={};return n.displayOrder=t.displayOrder,n.dock=t.dock,n.prioOrder=t.prioOrder,n.minimumLayoutMode=t.minimumLayoutMode,n.show=t.show,n.preferredSize=e,n}function Mo(t,e,n){Object.keys(n.on||{}).forEach(function(r){t.eventListeners=t.eventListeners||[];var i=n.on[r].bind(t);t.eventListeners.push({event:r,listener:i}),e.on(r,i)}),t.emit=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.emit.apply(e,[t].concat(r))}}function _o(t){var e,n,r,i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.defaultSettings,c=void 0===s?{}:s,u=t._DO_NOT_USE_getInfo,l=void 0===u?function(){return{}}:u,h=o.chart,f=o.container,d=o.mediator,p=o.registries,g=o.theme,y=o.renderer,v=o.settings||{},m=Ra.mixin({}),x=k(!0,{},c,v),b=[],w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ka,n={};return{resolve:function(r){var i=r.data,a=r.settings,o=r.defaults,s=void 0===o?{}:o,c=r.scaled,u=n.norm=e.normalizeSettings(a,s,t.chart),l={scale:t.chart.scale,formatter:t.chart.formatter};c&&Object.keys(c).forEach(function(t){u[t]&&e.updateScaleSize(u,t,c[t])});var h=[];if(!i||!Array.isArray(i.items)){var f={data:i,resources:l},d=e.resolveForItem(f,n.norm,-1);return{settings:n.norm,item:d}}for(var p,g=0,y=i.items.length;g<y;g++){p={datum:i.items[g],data:i,resources:l};var v=e.resolveForItem(p,n.norm,g);v.data=i.items[g],h.push(v)}return{settings:n.norm,items:h}}}}({chart:h}),M=!1,S={nodes:[],chart:h,config:x.brush||{},renderer:null},R={tap:[],over:[]},A=[],C={},N=k({},v);function O(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var i,a,o,s=void 0!==t[e],c=void 0!==v[e],u=arguments.length,l=new Array(u),h=0;h<u;h++)l[h]=arguments[h];s&&("function"==typeof t[e]?i=(a=t[e]).call.apply(a,[C].concat(l)):r&&(i=t[e]));c&&("function"==typeof v[e]?i=(o=v[e]).call.apply(o,[N].concat(l)):r&&(i=v[e]));return s||c||(i=n.call.apply(n,[C].concat(l))),i}}var T=O("preferredSize",function(){return 0},!0),E=O("resize",function(t){return t.inner}),D=O("created"),z=O("beforeMount"),j=O("mounted"),q=O("beforeUnmount"),P=O("beforeUpdate"),F=O("updated"),L=O("beforeRender"),B=O("beforeDestroy"),W=O("destroyed"),V=t.render,H=function(){x.brush&&(x.brush.consume||[]).forEach(function(t){t.context&&t.style&&A.push(Ga(S,t))})},U=function(){x.brush&&(x.brush.trigger||[]).forEach(function(t){"over"===t.on?R.over.push(t):R.tap.push(t)})};Object.defineProperty(S,"data",{get:function(){return b}});var $=x.renderer||t.renderer,Y=$?y||p.renderer($)():y||p.renderer()();S.renderer=Y;var X={resources:h.logger?{logger:h.logger()}:{}},K=xo(ko(x,T),X),G=function(t){t.key=x.key,t.element=Y.element()},Z=function(){};Z.dockConfig=function(){return K},Z.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.settings&&(x=k(!0,{},c,t.settings),K=xo(ko(x,T),X)),x.scale&&(e=h.scale(x.scale)),b=x.data?lr(x.data,{dataset:h.dataset,collection:h.dataCollection},{logger:h.logger()},h.dataCollection):e?e.data():[],"string"==typeof x.formatter?n=h.formatter(x.formatter):"object"===_(x.formatter)?n=h.formatter(x.formatter):e&&e.data().fields&&(n=e.data().fields[0].formatter()),a=g.style(x.style||{})},Z.resize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=E({inner:t,outer:e});i=n?Y.size(n):Y.size(t),N.rect=k(!0,{computedPhysical:i.computedPhysical,computedOuter:e.computed,computedInner:t.computed},t),i=k(!0,{computedOuter:e.computed,computedInner:t.computed},i)},Z.getRect=function(){return N.rect};var J,Q,tt=function(){var t=Y.renderArgs?Y.renderArgs.slice(0):[];return t.push({data:b}),t};Z.beforeMount=z,Z.beforeRender=function(){L({size:i})},Z.render=function(){var t=S.nodes=V.call.apply(V,[C].concat(I(tt())));Y.render(t),J=t},Z.hide=function(){Z.unmount(),Y.size({x:0,y:0,width:0,height:0}),Y.clear()},Z.beforeUpdate=function(){P({settings:x,data:b})},Z.update=function(){Q&&Q.stop();var t=S.nodes=V.call.apply(V,[C].concat(I(tt())));A.forEach(function(t){return t.cleanUp()}),A.length=0,R.tap=[],R.over=[],x.brush&&(H(),U()),A.forEach(function(t){t.isActive()&&t.update()}),J&&x.animations&&x.animations.enabled?(Q=function(t,e,n){var r,i=t.old,a=t.current,o=e.renderer,s=[],c={nodes:[],ips:[]},u={nodes:[],ips:[]},l={nodes:[],ips:[]},h=[],f=n.trackBy||Va,d={start:function(){var t={};i.forEach(function(e,n){var r=f(e,n);t[r]=e}),a.forEach(function(e,n){var r=f(e,n);t[r]?(l.ips.push(Ei(t[r],e)),l.nodes.push(e),s.push(t[r]),t[r]=!1):(c.nodes.push(e),c.ips.push(Ei({r:.001,opacity:0},e)))}),Object.keys(t).forEach(function(e){t[e]&&(u.nodes.push(t[e]),u.ips.push(Ei(t[e],k({},t[e],{r:1e-4,opacity:0}))))}),u.ips.length&&h.push({easing:La,duration:200,tweens:u.ips,nodes:s.concat()}),l.ips.length&&h.push({easing:La,duration:400,tweens:l.ips,nodes:[]}),c.ips.length&&h.push({easing:Wa,duration:1200,tweens:c.ips,nodes:I(l.nodes)}),h.length&&(h[0].started=Date.now(),"undefined"!=typeof window&&(r=window.requestAnimationFrame(d.tick)))},tick:function(){var t=h[0];t||d.stop(),t.started||(t.started=Date.now());var e=(Date.now()-t.started)/t.duration,n=[],i=t.tweens.map(function(n){return n(t.easing(Math.min(1,e)))});n.push.apply(n,I(i)),n.push.apply(n,I(t.nodes)),o.render(n),e>=1&&(h.shift(),h.length||d.stop()),r&&(r=window.requestAnimationFrame(d.tick))},stop:function(){r&&(window.cancelAnimationFrame(r),r=!1)}};return d}({old:J,current:t},{renderer:Y},x.animations)).start():Y.render(t),J=t,Y.setKey&&"string"==typeof v.key&&Y.setKey(v.key)},Z.updated=F,Z.destroy=function(){Z.unmount(),B(r),Y.destroy(),W(),r=null};var et=function(t){S.nodes=t,A.forEach(function(t){t.isActive()&&t.update()}),Y.render(t)};return wo(C,t,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return Y},chart:function(){return h},dockConfig:function(){return K},mediator:function(){return d},instance:function(){return N},style:function(){return a},update:function(){return et},registries:function(){return p},resolver:function(){return w},symbol:function(){return mo}}),wo(N,v,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return Y},chart:function(){return h},dockConfig:function(){return K},mediator:function(){return d},style:function(){return a},_DO_NOT_USE_getInfo:l.bind(C),isVisible:function(){return M}}),Z.getBrushedShapes=function(t,e,n){var r=[];if(x.brush&&x.brush.consume){var i=h.brush(t),a=Y.findShapes("*");x.brush.consume.filter(function(e){return e.context===t}).forEach(function(t){for(var o=0;o<a.length;o++){var s=a[o];s.data&&i.containsMappedData(s.data,n||t.data,e)&&(G(s),r.push(s),a.splice(o,1),o--)}})}return r},Z.findShapes=function(t){for(var e=Y.findShapes(t),n=0,r=e.length;n<r;n++)G(e[n]);return e},Z.shapesAt=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Y.itemsAt(t);e=n&&"stop"===n.propagation&&r.length>0?[r.pop().node]:r.map(function(t){return t.node});for(var i=0,a=e.length;i<a;i++)G(e[i]);return e},Z.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.contexts=Array.isArray(e.contexts)?e.contexts:[],Za({nodes:t,action:e.action||"toggle",trigger:e,chart:h,data:S.data})},Z.mount=function(){r=Y.element&&Y.element()?r:Y.appendTo(f),Y.setKey&&"string"==typeof v.key&&Y.setKey(v.key),x.brush&&(H(),U()),Mo(N,m,v),Mo(C,m,t),M=!0},Z.mounted=function(){return j(r)},Z.unmount=function(){[N,C].forEach(function(t){!function(t,e){(t.eventListeners||[]).forEach(function(t){var n=t.event,r=t.listener;e.removeListener(n,r)}),t.emit=function(){}}(t,m)}),R.tap=[],R.over=[],A.forEach(function(t){t.cleanUp()}),A.length=0,q(),M=!1},Z.onBrushTap=function(t){R.tap.forEach(function(e){(function(t){var e=t.e,n=t.t,r=t.config;return Ja({collisions:Qa(e,n,r.renderer),t:n,config:r,action:to(n.action,e,"toggle")})})({e:t,t:e,config:S})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)})},Z.onBrushOver=function(t){R.over.forEach(function(e){(function(t){var e=t.e,n=t.t,r=t.config;return Ja({collisions:Qa(e,n,r.renderer),t:n,config:r,action:to(n.action,e,"set")})})({e:t,t:e,config:S})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)})},Z.def=C,Z.ctx=N,Z.renderer=function(){return Y},Z.set({settings:v}),D(),Z}var So=1e-12;function Ro(t,e,n){var r,i,a=so(n,t),o=so(e,t);return oo((i=po(a,r=o)/po(r,r)||1,{x:r.x*i,y:r.y*i}),t)}function Ao(t,e,n){return fo(t,n)+fo(e,n)-fo(t,e)<So}function Co(t,e){return t.x>=e.x&&t.x+t.width<=e.x+e.width&&t.y>=e.y&&t.y+t.height<=e.y+e.height}function No(t){return t.x1===t.x2&&t.y1===t.y2}function Oo(t){return t.width<=0||t.height<=0}function To(t){return t.r<=0}function Eo(t){return t.edges.length<=2}function Do(t,e){return!To(t)&&ho({x:t.cx,y:t.cy},e)<=Math.pow(t.r,2)}function zo(t,e){if(Oo(e)||To(t))return!1;var n=e.width/2,r=e.height/2,i=e.x+n,a=e.y+r,o=t.r,s=t.cx,c=t.cy,u=Math.abs(s-i),l=Math.abs(c-a);return!(u>n+o||l>r+o)&&(u<=n||l<=r||Math.pow(u-n,2)+Math.pow(l-r,2)<=Math.pow(o,2))}function jo(t,e){if(To(t)||No(e))return!1;var n=P(U(e),2),r=n[0],i=n[1];if(Do(t,r)||Do(t,i))return!0;var a={x:t.cx,y:t.cy},o=Ro(r,i,a);return ho(o,a)<=Math.pow(t.r,2)&&Ao(r,i,o)}function qo(t,e){if(Eo(e)||To(t))return!1;if(Po(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.edges.length,r=0;r<n;r++){if(jo(t,X(e.edges[r])))return!0}return!1}function Po(t,e){if(Eo(t)||!Bo(t.boundingRect(),e))return!1;for(var n=!0,r=t.vertices.length,i={x:t.xMin-1,y:e.y},a=0;a<r-1;a++){var o=X(t.edges[a]);o.y1<e.y&&o.y2<e.y||o.y1>e.y&&o.y2>e.y||(n=Vo(o,X([i,e]))?!n:n)}return!n}function Io(t,e){if(Eo(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(Vo(e,X(t.edges[n])))return!0}var i=P(U(e),2),a=i[0],o=i[1];return Po(t,a)||Po(t,o)}function Fo(t,e){if(Eo(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(Wo(e,X(t.edges[n])))return!0}var i=P($(e),4),a=i[0],o=i[1],s=i[2],c=i[3];return Po(t,a)||Po(t,o)||Po(t,s)||Po(t,c)}function Lo(t,e){return!Oo(t)&&!Oo(e)&&(t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height)}function Bo(t,e){return!Oo(t)&&(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)}function Wo(t,e){if(No(e)||Oo(t))return!1;var n=P(U(e),2),r=n[0],i=n[1];if(Bo(t,r)||Bo(t,i))return!0;for(var a=$(t),o=a.length,s=0;s<o;s++){if(Vo(X([a[s],a[3!==s?s+1:0]]),e))return!0}return!1}function Vo(t,e){var n,r,i=P(U(t),2),a=i[0],o=i[1],s=P(U(e),2),c=s[0],u=s[1],l=uo(o,a),h=lo(o,a),f=uo(u,c),d=lo(u,c),p=uo(a,c),g=lo(a,c),y=d*l-f*h,v=f*g-d*p,m=l*g-h*p;if(0===l&&0===h)return!1;if(0===f&&0===d)return!1;if(0===y){if(0===v&&0===m){if(0===l){if(0===h)return a.x===o.x&&a.y===o.y;n=lo(c,a)/h,r=lo(u,a)/h}else n=(c.x-a.x)/l,r=(u.x-a.x)/l;return!(n<0&&r<0||n>1&&r>1)}return!1}var x=v/y;return y=m/y,x>=0&&x<=1&&y>=0&&y<=1}function Ho(t,e){if(No(t))return!1;var n=P(U(t),2);return Ao(n[0],n[1],e)}var Uo=/^\$/,$o="@extend";function Yo(t){throw new Error('Cyclical reference for "'.concat(t,'"'))}function Xo(t,e){return function t(e,n,r){if("string"==typeof e){var i=n[e];return-1!==r.indexOf(e)&&Yo(e),Uo.test(i)?(r.push(e),t(i,n,r)):i}var a=e,o=k(!0,{},n,e),s={};if(e[$o]){var c=e[$o];-1!==r.indexOf(c)&&Yo(c);var u=r.slice();u.push(c),a=k(!0,{},t(o[c],n,u),e)}return Object.keys(a).forEach(function(e){var n=r.slice();if(e!==$o&&!Uo.test(e)){s[e]=a[e];var i=s[e];Uo.test(i)&&i in o?(-1!==r.indexOf(i)&&Yo(i),n.push(i),"object"===_(i=o[i])?s[e]=t(i,o,n):Uo.test(i)&&i in o?s[e]=t(i,o,n):s[e]=i):"object"===_(i)&&(s[e]=t(i,o,n))}}),s}(t,e,[])}function Ko(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={},r=function(t){t.forEach(function(t){var e=Array.isArray(t.colors[0])?t.colors:[t.colors];n[t.key]={colors:e,sizes:e.map(function(t){return t?t.length:0})}})},i={palette:function(t,e){return function(t,e){var r=n[t];if(!r)return[];for(var i=r.sizes,a=0;a<i.length;a++)if(e<=i[a])return r.colors[a];return r.colors[i.length-1]}(t,e)},setPalettes:r,style:function(e){return Xo(e,t)}};return r(e),i}function Go(t,e,n){var r=e.left-n.left,i=e.top-n.top,a=K(t),o=k(!0,{},t);switch(a){case"circle":o.cx+=r,o.cy+=i;break;case"polygon":for(var s=0,c=o.vertices.length;s<c;s++){var u=o.vertices[s];u.x+=r,u.y+=i}break;case"line":o.x1+=r,o.y1+=i,o.x2+=r,o.y2+=i;break;case"point":case"rect":o.x+=r,o.y+=i}return o}function Zo(t,e){var n=t.element,r=t.data,i=void 0===r?[]:r,a=t.settings,o=void 0===a?{}:a,s=t.on,c=void 0===s?{}:s,u=e.registries,l=e.logger,h=Ko(e.style,e.palettes),f=[],d=k({},t),p=function(){var t={};return Ra.mixin(t),t}(),g=[],y=[],v=null,m=null,x=null,b=[],w=function(){},M=function(){},S={},R=!1,A=function(t,e){return u.component.has(t.type)?{instance:_o(u.component(t.type),{settings:t,chart:d,mediator:p,registries:u,theme:h,container:e}),settings:k(!0,{},t),key:t.key,hasKey:void 0!==t.key}:(l.warn("Unknown component: ".concat(t.type)),!1)};function C(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var r,i,a="function"==typeof t[e],o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];a?r=(i=t[e]).call.apply(i,[d].concat(s)):r=n.call.apply(n,[d].concat(s));return r}}var O=function(t){for(var e=0;e<g.length;e++)if(g[e].instance===t)return g[e];return null},T=function(t){for(var e=0;e<g.length;e++){var n=g[e];if(n.hasKey&&n.key===t)return e}return-1},E=function(t){var e=it(o.dockLayout);t.forEach(function(t){e.addComponent(t.instance,t.key)});var r=e.layout(n),i=r.visible,a=r.hidden;return{visible:i.map(function(t){return O(t)}),hidden:a.map(function(t){return O(t)})}},D=C("created"),z=C("beforeMount"),j=C("mounted"),q=C("beforeUpdate"),P=C("updated"),F=C("beforeRender"),L=C("beforeDestroy"),B=C("destroyed"),W=function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).partialData,r=e.formatters,i=void 0===r?{}:r,a=e.scales,o=void 0===a?{}:a,s=e.scroll,c=void 0===s?{}:s;w=function(t,e){var n=e.types,r=e.logger,i={},a=[];return Array.isArray(t)?a.push.apply(a,I(t)):(r.warn('Deprecated: "data-source" configuration"'),a.push(t)),a.forEach(function(t,e){var a=n(t.type);if(a){var o=t.key;void 0===t.key&&(r.warn("Missing key for dataset. Using index '".concat(e,"' as key.")),o=e);var s=a({key:o,data:t.data,config:t.config});i[o]=s}}),function(t){return t?i[t]:i[Object.keys(i)[0]]}}(t,{logger:l,types:u.data}),n||Object.keys(S).forEach(function(t){return S[t].clear()}),e.palettes&&h.setPalettes(e.palettes),M=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lr,i={};return(t||[]).forEach(function(t){if(!t.key)throw new Error('Data collection is missing "key" property');if("object"===_(t.data)&&"collection"in t.data)throw new Error("Data config for collections may not reference other collections");i[t.key]=function(){return r(t.data,e,n)}}),function(t){var e,n;if("string"==typeof t?e=t:"object"===_(t)&&(e=t.key,n=t),!(e in i))throw new Error("Unknown data collection: ".concat(e));"function"==typeof i[e]&&(i[e]=i[e]());var r=i[e];if(n&&n.fields&&n.fields.filter){var a=r.fields.filter(n.fields.filter);r.fields.length!==a.length&&(r=k(r,{fields:a}))}return r}}(e.collections,{dataset:w},{logger:l});var f={theme:h,logger:l};v=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ka,i={};return{get:function(a){var o;return"string"==typeof a&&t[a]?o=a:"object"===_(a)&&"scale"in a&&t[a.scale]&&(o=a.scale),o?(i[o]=i[o]||r(t[o],e,n),i[o]):r(a,e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}(o,{dataset:w,collection:M},N({},f,{scale:u.scale})),m=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:hr,i={};return{get:function(a){var o;return"string"==typeof a&&t[a]?o=a:"object"===_(a)&&"formatter"in a&&t[a.formatter]?o=a.formatter:"object"===_(a)&&"type"in a&&t[a.type]&&(o=a.type),o?(i[o]=i[o]||r(t[o],e,n),i[o]):r(a||{},e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}(i,{dataset:w,collection:M},N({},f,{formatter:u.formatter})),x=function(t,e){var n,r,i,a,o,s,c={};for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(c[u]=(n=t[u],r=e?e[u]:null,i=void 0,a=void 0,o=void 0,s=void 0,i=n.min||0,a=n.max||0,o=n.viewSize||0,(s=r||Aa()).update({min:i,max:a,viewSize:o}),s));return c}(c,x)};function V(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={},r=t.filter(function(t){return!!t.key}).map(function(t){return t.key});b.forEach(function(t){t.key&&-1!==r.indexOf(t.key)?e[t.key]=t:t.destroy()}),b=t.map(function(t){var r=t.key&&e[t.key]?e[t.key]:u.interaction(t.type)(d,p,n);return r.set(t),r})}var H=function(t){var e=n.getBoundingClientRect(),r="clientX"in t?t.clientX:t.x,i="clientY"in t?t.clientY:t.y,a={x:r-e.left,y:i-e.top},o=[];return y.forEach(function(t){var e=t.instance.getRect();Bo(e.computedPhysical?e.computedPhysical:{x:e.margin.left+e.x*e.scaleRatio.x,y:e.margin.top+e.y*e.scaleRatio.y,width:e.width*e.scaleRatio.x,height:e.height*e.scaleRatio.y},a)&&o.push(t)}),o},U=function(){if(!f.length&&n){Object.keys(c).forEach(function(t){var e=c[t].bind(d);n.addEventListener(t,e),f.push({key:t,listener:e})});var t,e={},r=function(t){t.touches?(e.x=t.touches[0].clientX,e.y=t.touches[0].clientY,e.multiTouch=t.touches.length>1):(e.x=t.clientX,e.y=t.clientY,e.multiTouch=!1),e.time=Date.now(),e.comps=H(e)},i=function(t){var n=e.comps||H(t);if(!n.every(function(t){return t.instance.def.disableTriggers})&&("touchend"===t.type&&t.preventDefault(),function(t,e){var n=at(t),r=n?t.changedTouches[0]:t,i=Date.now()-e.time,a=isNaN(e.x)?0:Math.abs(r.clientX-e.x),o=isNaN(e.y)?0:Math.abs(r.clientY-e.y);return(0===t.button||n)&&!e.multiTouch&&a<=12&&o<=12&&i<=300}(t,e)))for(var r=n.length-1;r>=0;r--){if(n[r].instance.onBrushTap(t),R){R=!1;break}}},a=[];a.push({key:"mousedown",listener:r}),a.push({key:"mouseup",listener:i}),("ontouchstart"in(t=n)&&"ontouchend"in t||navigator.maxTouchPoints>1)&&(a.push({key:"touchstart",listener:r}),a.push({key:"touchend",listener:i})),a.push({key:"mousemove",listener:function(t){for(var e=H(t),n=e.length-1;n>=0;n--)if(e[n].instance.onBrushOver(t),R){R=!1;break}}}),a.forEach(function(t){n.addEventListener(t.key,t.listener),f.push(t)})}},$=function(){f.forEach(function(t){var e=t.key,r=t.listener;return n.removeEventListener(e,r)}),f.length=0};return d.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.partialData,r=t.excludeFromUpdate,a=void 0===r?[]:r;t.data&&(i=t.data),t.settings&&(o=t.settings,V(t.settings.interactions)),q(),W(i,o,{partialData:e});for(var s=o,c=s.formatters,u=s.scales,l=s.components,h=void 0===l?[]:l,f=function(t){var e=g[t];h.some(function(t){return e.hasKey&&e.key===t.key})||(g.splice(t,1),e.instance.destroy())},d=g.length-1;d>=0;d--)f(d);(g=h.map(function(t){var e=T(t.key);return a.indexOf(t.key)>-1?g[e]:-1===e?A(t,n):(g[e].updateWith={formatters:c,scales:u,data:i,settings:t},g[e])}).filter(function(t){return!!t})).forEach(function(t){t.updateWith&&t.instance.set(t.updateWith)}),g.forEach(function(t){t.updateWith&&t.instance.beforeUpdate()});var p,v=[],m=[];if(e)g.forEach(function(t){t.updateWith&&t.visible&&v.push(t)}),p=v;else{var x=E(g),b=x.visible,w=x.hidden;y=b,p=b,b.forEach(function(t){t.updateWith&&t.visible?v.push(t):m.push(t)}),w.forEach(function(t){t.instance.hide(),t.visible=!1,delete t.updateWith})}m.forEach(function(t){return t.instance.beforeMount()}),m.forEach(function(t){return t.instance.mount()}),p.forEach(function(t){return t.instance.beforeRender()}),p.forEach(function(t){t.updateWith&&t.visible?t.instance.update():t.instance.render()}),e||y.forEach(function(t,e){return function(t,e){var r=t.instance.renderer().element();if(!isNaN(e)&&r&&n&&n.childNodes){var i=n.childNodes,a=Math.min(i.length-1,Math.max(e,0)),o=i[a];n.insertBefore&&void 0!==o&&n.insertBefore(r,i[a])}}(t,e)}),m.forEach(function(t){return t.instance.mounted()}),v.forEach(function(t){return t.instance.updated()}),y.forEach(function(t){delete t.updateWith,t.visible=!0}),P()},d.destroy=function(){L(),g.forEach(function(t){return t.instance.destroy()}),g=[],$(),V(),delete d.update,delete d.destroy,B()},d.getAffectedShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=[];return g.filter(function(t){return null==r||t.key===r}).forEach(function(r){i.push.apply(i,I(r.instance.getBrushedShapes(t,e,n)))}),i},d.findShapes=function(t){var e=[];return y.forEach(function(n){e.push.apply(e,I(n.instance.findShapes(t)))}),e},d.componentsFromPoint=function(t){return H(t).map(function(t){return t.instance.ctx})},d.shapesAt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=n.getBoundingClientRect(),a=y;if(Array.isArray(e.components)&&e.components.length>0){var o=e.components.map(function(t){return t.key});a=y.filter(function(t){return-1!==o.indexOf(t.key)}).map(function(t){return{instance:t.instance,opts:e.components[o.indexOf(t.key)]}})}for(var s=a.length-1;s>=0;s--){var c=a[s],u=Go(t,i,c.instance.renderer().element().getBoundingClientRect()),l=c.instance.shapesAt(u,c.opts),h=l.length>0&&"stop"===e.propagation;if(r.push.apply(r,I(l)),r.length>0&&h)return r}return r},d.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{components:[]},n=e.components.map(function(t){return t.key});y.forEach(function(r){var i=n.indexOf(r.key);if(-1!==i){for(var a=[],o=0,s=t.length;o<s;o++){var c=t[o];c.key===r.key&&a.push(c)}r.instance.brushFromShapes(a,e.components[i])}})},d.scroll=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return(e=x)[t=n]||(e[t]=Aa()),e[t]},d.dataset=function(t){return w(t)},d.dataCollection=function(t){return M(t)},d.scales=function(){return v.all()},d.formatters=function(){return m.all()},d.brush=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return S[t]||(S[t]=Fa()),S[t]},d.scale=function(t){return v.get(t)},d.formatter=function(t){return m.get(t)},d.toggleBrushing=function(t){R=void 0!==t?t:!R},d.component=function(t){var e=T(t);if(-1!==e)return g[e].instance.ctx},d.logger=function(){return l},d.theme=function(){return h},Object.defineProperty(d,"interactions",{get:function(){return{instances:b,on:function(){U(),b.forEach(function(t){return t.on()})},off:function(){$(),b.forEach(function(t){return t.off()})}}}}),D(),n&&(z(),n.innerHTML="",function(){var t=o.components,e=void 0===t?[]:t;F(),W(i,o),g=e.map(function(t){return A(t,n)}).filter(function(t){return!!t});var r=E(g),a=r.visible,s=r.hidden;y=a,s.forEach(function(t){t.instance.hide(),t.visible=!1}),a.forEach(function(t){return t.instance.beforeMount()}),a.forEach(function(t){return t.instance.mount()}),a.forEach(function(t){return t.instance.beforeRender()}),a.forEach(function(t){return t.instance.render()}),a.forEach(function(t){return t.instance.mounted()}),a.forEach(function(t){t.visible=!0})}(),U(),V(o.interactions),j(n),d.element=n),d}var Jo=function(t){var e=se(t);return e.prio=function(t){return t?e.default(t[0]):[e.default()]},e.types=function(){return e.getKeys()},e},Qo=se();var ts=function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})},es=function(t){return t.reduce(function(t,e){return t+e},0)},ns={first:function(t){return t[0]},last:function(t){return t[t.length-1]},min:function(t){var e=ts(t);return e.length?Math.min.apply(null,e):NaN},max:function(t){var e=ts(t);return e.length?Math.max.apply(null,e):NaN},sum:function(t){var e=ts(t);return e.length?e.reduce(function(t,e){return t+e},0):NaN},avg:function(t){var e=ts(t),n=e.length;return n?es(e)/n:NaN}};function rs(t,e,n,r){var i={},a=r.field||(void 0!==t.field?e.field(t.field):null);return Object.keys(n).forEach(function(o){var s=n[o],c=i[o]={};-1!==["number","string","boolean"].indexOf(_(s))?(c.type="primitive",c.value=s):"function"==typeof s?(c.type="function",c.value=s,c.label=s,c.field=a):"object"===_(s)&&(s.fields?c.fields=s.fields.map(function(n){return rs(t,e,{main:n},r).main}):void 0!==s.field?(c.type="field",c.field=e.field(s.field),c.value=c.field.value,c.label=c.field.label):a&&(c.value=a.value,c.label=a.label,c.field=a),"function"==typeof s.filter&&(c.filter=s.filter),void 0!==s.value&&(c.value=s.value),void 0!==s.label&&(c.label=s.label),"function"==typeof s.reduce?c.reduce=s.reduce:s.reduce?c.reduce=ns[s.reduce]:c.field&&c.field.reduce&&(c.reduce="string"==typeof c.field.reduce?ns[c.field.reduce]:c.field.reduce),"function"==typeof s.reduceLabel?c.reduceLabel=s.reduceLabel:s.reduceLabel?c.reduceLabel=ns[s.reduceLabel]:c.field&&c.field.reduceLabel&&(c.reduceLabel="string"==typeof c.field.reduceLabel?ns[c.field.reduceLabel]:c.field.reduceLabel))}),i}function is(t,e){var n=rs(t,e,{main:{value:t.value,label:t.label,reduce:t.reduce,filter:t.filter}},{}).main;return{props:rs(t,e,t.props||{},n),main:n}}function as(t,e,n,r){for(var i,a=Array(t.length),o=Array(t.length),s=0;s<t.length;s++)i=r?t[s][r]:t[s],a[s]=i.value,o[s]=i.label;var c=e.reduce,u=e.reduceLabel,l=c?c(a):a,h={value:l,label:u?u(o,l):n?n(l):String(l)};return r&&t[0][r].source?(h.source=t[0][r].source,h):!r&&t[0].source?(h.source=t[0].source,h):h}function os(t,e){var n=e.main,r=e.propsArr,i=e.props,a=[],o=n.field.formatter(),s={};return r.forEach(function(t){s[t]=i[t].field?i[t].field.formatter():function(t){return t}}),a.push.apply(a,I(t.map(function(t){var e=as(t.items,n,o);return r.forEach(function(n){e[n]=as(t.items,i[n],s[n],n)}),e}))),a}function ss(t){var e=t.cfg,n=t.itemData,r=t.obj,i=t.target,a=t.tracker,o="function"===t.trackType?e.trackBy(n):n[e.trackBy],s=a[o];s||(s=a[o]={items:[],id:o},i.push(s)),s.items.push(r)}function cs(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}var us={numeric:function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})}};var ls=function(t){var e=t.key,n=t.data,r=t.cache,i=t.config;if(n){var a=n;"string"==typeof a&&(a=function(t){var e=t.data,n=t.config,r=e.split("\n"),i=r[0],a=r[1],o=",";if(n&&n.parse&&n.parse.delimiter)o=n.parse.delimiter;else if(i)for(var s=[/,/,/\t/,/;/],c=0;c<s.length;c++){var u=s[c];if(i&&a){if(u.test(i)&&u.test(a)&&i.split(u).length===a.split(u).length){o=u;break}}else u.test(i)&&(o=u)}return r.map(function(t){return t.split(o)})}({data:n,config:i})),Array.isArray(a)&&function(t){var e,n=t.source,r=t.data,i=t.cache,a=t.config,o=r,s=a&&a.parse;Array.isArray(r[0])?s&&!1===s.headers?e=r[0].map(function(t,e){return e}):(e=r[0],o=r.slice(1)):e=Object.keys(r[0]);var c,u=!!s&&"function"==typeof s.row&&s.row,l=e;l=s&&"function"==typeof s.fields?s.fields(l.slice()):e.map(function(t){return{key:t,title:t}}),Array.isArray(r[0])?c=l.map(function(){return[]}):(c={},l.forEach(function(t){c[t.key]=[]}));for(var h=0;h<o.length;h++){var f=u?u(o[h],h,l):o[h];if(f)if(Array.isArray(f))for(var d=0;d<l.length;d++)c[d].push(f[d]);else for(var p=0;p<l.length;p++)c[l[p].key].push(f[l[p].key])}for(var g=Array.isArray(c)?function(t){return c[t]}:function(t){return c[l[t].key]},y=0;y<l.length;y++){var v=g(y),m=us.numeric(v),x=m.length>0,b=x?"measure":"dimension",w=x?Math.min.apply(Math,I(m)):NaN,M=x?Math.max.apply(Math,I(m)):NaN;i.fields.push(or(k({source:n,key:y,title:l[y].title,values:v,min:w,max:M,type:b},l[y]),{value:l[y].value,label:l[y].label}))}}({data:a,cache:r,source:e,config:i})}};function hs(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.data,r=t.config,i={fields:[]},a={key:function(){return e},raw:function(){return n},field:function(t){return function(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];for(var r=0;r<n.fields.length;r++)if(n.fields[r].key()===t)return n.fields[r];for(var i=0;i<n.fields.length;i++)if(n.fields[i].title()===t)return n.fields[i];return null}(t,{cache:i,matrix:n})},fields:function(){return i.fields.slice()},extract:function(t){return function(t,e){var n=Array.isArray(t)?t:[t],r=[];return n.forEach(function(t){void 0!==t.field&&function(){var n=e.field(t.field),i=e.key();if(!n)throw Error("Field '".concat(t.field,"' not found"));for(var a=is(t,e),o=a.props,s=a.main,c=Object.keys(o),u=!!t.trackBy,l=_(t.trackBy),h={},f=[],d=n.items(),p=[],g=function(e){var n=d[e];if(s.filter&&!s.filter(n))return"continue";var r=cs(s,n,{key:i});c.forEach(function(t){var a=o[t],s=a.field?a.field.items()[e]:n;r[t]=cs(a,s,{key:i})}),u&&ss({cfg:t,itemData:n,obj:r,target:f,tracker:h,trackType:l}),p.push(r)},y=0;y<d.length;y++)g(y);u?r.push.apply(r,I(os(f,{main:s,propsArr:c,props:o}))):r.push.apply(r,p)}()}),r}(t,a)},hierarchy:function(){return null}};return ls({key:e,data:n,config:r,cache:i}),a}hs.util={normalizeConfig:is,collect:os,track:ss};var fs=se();fs.default("matrix"),fs("matrix",hs),fs("default",hs);var ds=se();function ps(t,e,n){return Math.max(t,Math.min(e,n))}function gs(t){var e,n=t.item,r=t.value,i=t.boxCenter,a=t.rendWidth,o=t.rendHeight,s="x",c="y",u=a,l=o,h=r<.5?90:-90;return t.flipXY&&(s="y",c="x",u=o,l=a,h=r<.5?180:0),(0,t.symbol)(k({},n.oob,(C(e={},s,i*u),C(e,c,Math.max(n.oob.size/2,Math.min(r*l,l-n.oob.size/2))),C(e,"startAngle",h),e)))}function ys(t){var e,n=t.item,r=t.boxWidth,i=t.boxPadding,a=t.rendWidth,o=t.rendHeight,s="x",c="y",u="width",l="height",h=a,f=o;t.flipXY&&(s="y",c="x",u="height",l="width",h=o,f=a);var d=function(t){var e=t.start,n=t.end,r=t.minPx,i=void 0===r?.1:r,a=t.maxPx,o=void 0===a?1:a,s=Math.max(e,n),c=Math.min(e,n),u=ps(-.1,1.2,s),l=ps(-.1,1.2,c),h=u*o-l*o,f=Math.max(i,h),d=(f-h)/2;return{actualDiff:f,startModifier:d,actualLow:l*o-d}}({start:n.start,end:n.end,minPx:n.box.minHeightPx,maxPx:f}),p=d.actualDiff,g=d.actualLow;return k({},n.box,(C(e={type:"rect"},s,(i+n.major)*h),C(e,c,g),C(e,l,p),C(e,u,r*h),C(e,"data",n.data||{}),C(e,"collider",{type:null}),e))}function vs(t){var e,n=t.item,r=t.from,i=t.to,a=t.boxCenter,o=t.rendWidth,s=t.rendHeight,c="x1",u="y1",l="x2",h="y2",f=o,d=s;return t.flipXY&&(c="y1",u="x1",l="y2",h="x2",f=s,d=o),k({},n.line,(C(e={type:"line"},h,Math.floor(r*d)),C(e,c,a*f),C(e,u,Math.floor(i*d)),C(e,l,a*f),C(e,"data",n.data||{}),C(e,"collider",{type:null}),e))}function ms(t){var e,n=t.item,r=t.key,i=t.position,a=t.width,o=t.boxCenter,s=t.rendWidth,c=t.rendHeight,u="x1",l="y1",h="x2",f="y2",d=s,p=c;t.flipXY&&(u="y1",l="x1",h="y2",f="x2",d=c,p=s);var g=a/2;return k({type:"line"},n[r],(C(e={},l,Math.floor(i*p)),C(e,u,(o-g)*d),C(e,f,Math.floor(i*p)),C(e,h,(o+g)*d),C(e,"r",g*d),C(e,"cx",o*d),C(e,"cy",i*p),C(e,"width",a*d),C(e,"data",n.data||{}),C(e,"collider",{type:null}),e))}function xs(t){for(var e=t.width,n=t.height,r=t.flipXY,i=t.resolved,a=t.keys,o=t.symbol,s=[],c=null,u=i.major.items,l=function(t,l){var h=u[t].data,f=[],d=null,p=null;void 0!==i.major.settings.binStart?(d=i.major.items[t].binStart,p=i.major.items[t].binEnd,c=i.major.settings.binStart.scale):d=(c=i.major.settings.major.scale)?i.major.items[t].major:0;var g=0;c?c.bandwidth?d-=(g=c.bandwidth())/2:g=p-d:g=1;var y=k({},{major:d,majorEnd:p},i.minor.items[t]);a.forEach(function(e){return y[e]=i[e].items[t]});var v=function(t,e,n){var r=t>=0?1:-1,i=Math.min(r*t*e.box.width,isNaN(e.box.maxWidthPx)?n:e.box.maxWidthPx/n);return(i=isNaN(e.box.minWidthPx)?i:Math.max(e.box.minWidthPx/n,i))*r}(g,y,r?n:e),m=(g-v)/2,x=m+y.major+v/2,b=e,w=n,M=[y.min,y.start,y.med,y.end,y.max].filter(W),_=Math.min.apply(Math,I(M))<0&&Math.max.apply(Math,I(M))<0,S=Math.min.apply(Math,I(M))>1&&Math.max.apply(Math,I(M))>1,R=_||S;if(y.oob.show&&_&&f.push(gs({item:y,value:0,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r,symbol:o})),y.oob.show&&S&&f.push(gs({item:y,value:1,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r,symbol:o})),!R&&y.box.show&&W(y.start)&&W(y.end)&&f.push(ys({item:y,boxWidth:v,boxPadding:m,rendWidth:b,rendHeight:w,flipXY:r})),!R&&y.line.show&&W(y.min)&&W(y.start)&&f.push(vs({item:y,from:y.min,to:y.start,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r})),!R&&y.line.show&&W(y.max)&&W(y.end)&&f.push(vs({item:y,from:y.max,to:y.end,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r})),!R&&y.median.show&&W(y.med)&&f.push(ms({item:y,key:"median",position:y.med,width:v,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r})),!R&&y.whisker.show){var A=v*y.whisker.width;W(y.min)&&f.push(ms({item:y,key:"whisker",position:y.min,width:A,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r})),W(y.max)&&f.push(ms({item:y,key:"whisker",position:y.max,width:A,boxCenter:x,rendWidth:b,rendHeight:w,flipXY:r}))}var C={type:"container",data:h,collider:{type:"bounds"},children:f};s.push(C)},h=0,f=u.length;h<f;h++)l(h);return s}ds("native",function(t,e,n){var r,i,a={chart:t,mediator:e,element:n},o=[],s=!0;function c(){"function"==typeof r.enable&&(r.enable=r.enable.bind(a)()),r.enable&&Object.keys(r.events).forEach(function(t){var e=r.events[t].bind(a);n.addEventListener(t,e),o.push({key:t,listener:e})})}function u(){o.forEach(function(t){var e=t.key,r=t.listener;n.removeEventListener(e,r)}),o=[]}return{get key(){return i},set:function(t){!function(t){i=t.key,(r=t).events=r.events||[],void 0===r.enable&&(r.enable=!0)}(t),u(),s&&c()},off:function(){s=!1,u()},on:function(){s=!0,0===o.length&&c()},destroy:function(){u(),a=null,r=null}}});var bs={line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,strokeLinejoin:"miter",width:1,maxWidthPx:void 0,minWidthPx:1,minHeightPx:1},oob:{show:!0,type:"n-polygon",fill:"#999",stroke:"#000",strokeWidth:0,size:10,sides:3,startAngle:-90}},ws=Object.keys(bs),ks={require:["chart","resolver","symbol"],defaultSettings:{settings:{},data:{},style:{box:"$shape",line:"$shape-guide",whisker:"$shape-guide",median:"$shape-guide--inverted"}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(t){var e=t.data,n=this.rect,r=n.width,i=n.height,a="horizontal"===this.settings.settings.orientation,o=this.style,s=this.resolver,c=this.symbol,u=function(t){var e,n=t.keys,r=t.data,i=t.defaultSettings,a=t.style,o=t.settings,s=t.width,c=t.height,u=t.resolver,l=k(!0,{},i||{},a||{}),h={major:"horizontal"===o.orientation?c:s,minor:"horizontal"===o.orientation?s:c},f=o.major;e="object"===_(f)&&"object"===_(f.ref)&&void 0!==f.ref.start&&void 0!==f.ref.end?u.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:k(!0,{},{binStart:{scale:o.major.scale,ref:o.major.ref.start},binEnd:{scale:o.major.scale,ref:o.major.ref.end}})}):"object"===_(f)&&void 0!==f.binStart&&void 0!==f.binEnd?u.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:k(!0,{},{binStart:{scale:o.major.scale,ref:"binStart"},binEnd:{scale:o.major.scale,ref:"binEnd"}},o.major)}):u.resolve({data:r,scaled:h,defaults:{major:.5},settings:{major:o.major}});for(var d,p=o.minor||{},g={major:e,minor:u.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:k(!0,{},{start:{scale:p.scale,ref:"start"},end:{scale:p.scale,ref:"end"},min:{scale:p.scale,ref:"min"},max:{scale:p.scale,ref:"max"},med:{scale:p.scale,ref:"med"}},p)})},y=0,v=n.length;y<v;y++)g[d=n[y]]=u.resolve({data:r,defaults:l[d],settings:o[d],scaled:h});return g}({keys:ws,data:e,defaultSettings:bs,style:o,settings:this.settings.settings,width:r,height:i,resolver:s}),l=u.settings;return xs({items:u.items,settings:l,width:r,height:i,flipXY:a,resolved:u,keys:ws,symbol:c})}};var Ms={errorShape:{shape:"saltire",width:2,size:.5,fill:"#333",stroke:"#333",strokeWidth:0}},_s={shape:"circle",label:"",fill:"#333",stroke:"#ccc",strokeWidth:0,strokeLinejoin:"miter",opacity:1,x:.5,y:.5,size:1,strokeDasharray:""},Ss={maxPx:1e4,minPx:1,maxRelExtent:.1,minRelExtent:.01,maxRelDiscrete:1,minRelDiscrete:.1};function Rs(t,e){return t&&"function"==typeof t.bandwidth?{isBandwidth:!0,value:Math.max(1,t.bandwidth()*e)}:{isBandwidth:!1,value:Math.max(1,e)}}var As={require:["chart","resolver"],defaultSettings:{settings:{},data:{},animations:{enabled:!1,trackBy:function(t){return t.data.value}},style:{item:"$shape"}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(t){var e=t.data,n=this.resolver.resolve({data:e,defaults:k({},_s,this.style.item),settings:this.settings.settings,scaled:{x:this.rect.width,y:this.rect.height}}),r=this.rect,i=r.width,a=r.height,o=k({},Ss,this.settings.settings.sizeLimits),s=n.items,c=function(t,e,n,r,i){var a=Rs(t?t.scale:void 0,n),o=Rs(e?e.scale:void 0,r),s=Math.min(a.value*i[a.isBandwidth?"maxRelDiscrete":"maxRelExtent"],o.value*i[o.isBandwidth?"maxRelDiscrete":"maxRelExtent"]),c=Math.min(a.value*i[a.isBandwidth?"minRelDiscrete":"minRelExtent"],o.value*i[o.isBandwidth?"minRelDiscrete":"minRelExtent"]);return{min:Math.max(1,Math.floor(c)),max:Math.max(1,Math.floor(s)),maxGlobal:i.maxPx,minGlobal:i.minPx}}(n.settings.x,n.settings.y,i,a,o);return function(t,e,n,r){var i=e.width,a=e.height;return t.filter(function(t){return!isNaN(t.x+t.y)}).map(function(t){var e=V(t.size)?Ms.errorShape:t,o=n.min+e.size*(n.max-n.min),s={type:"rect"===e.shape?"square":e.shape,label:t.label,x:t.x*i,y:t.y*a,fill:e.fill,size:Math.min(n.maxGlobal,Math.max(n.minGlobal,o)),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray,opacity:e.opacity};e===t.errorShape&&(s.width=e.width);var c=r(s);return c.data=t.data,c})}(s,this.rect,c,this.settings.shapeFn||mo)}},Cs="point";Math.PI;var Ns={label:"",arc:1,show:!0,fill:"#333",stroke:"#ccc",strokeWidth:1,strokeLinejoin:"round",opacity:1,innerRadius:0,outerRadius:.8,cornerRadius:0,offset:0};function Os(t,e,n,r){var i=e.x,a=e.y,o=e.width,s=e.height,c=Ot(),u={x:i+o/2,y:a+s/2},l=Math.min(o,s)/2,h=Math.min(o,s)/2,f=h/100;return t.map(function(t,e){var i=n[e];i.type="path";var a=h*i.outerRadius,o=l*i.innerRadius;c.innerRadius(o),c.outerRadius(a),c.cornerRadius(f*i.cornerRadius),i.d=c(t);var s=c.centroid(t),d=i.offset?function(t,e,n,r){var i=P(t,2),a=i[0],o=i[1],s=Math.sqrt(a*a+o*o),c=n-r;return{x:(a/=s)*e*c,y:(o/=s)*e*c}}(s,i.offset,a,o):{x:0,y:0};return i.transform="translate(".concat(d.x,", ").concat(d.y,") translate(").concat(u.x,", ").concat(u.y,")"),i.desc={share:t.value/r,slice:{start:t.startAngle,end:t.endAngle,innerRadius:o,outerRadius:a,offset:{x:u.x+d.x,y:u.y+d.y}}},i})}function Ts(t,e){return t.slice&&"arc"in t.slice?e.arc:e.data.value}var Es={require:["chart","resolver"],defaultSettings:{settings:{startAngle:0,endAngle:2*Math.PI,padAngle:0,slice:{}},style:{slice:"$shape"},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(t){for(var e=t.data,n=[],r=[],i=this.settings.settings,a=this.resolver.resolve({data:e,defaults:k({},Ns,this.style.slice),settings:i.slice}).items,o=0,s=0,c=a.length;s<c;s++){var u=Ts(i,a[s]);u>0&&a[s].outerRadius>=a[s].innerRadius&&(n.push(u),r.push(a[s]),o+=u)}var l=function(){var t=Pt,e=qt,n=null,r=ht(0),i=ht(kt),a=ht(0);function o(o){var s,c,u,l,h,f=o.length,d=0,p=new Array(f),g=new Array(f),y=+r.apply(this,arguments),v=Math.min(kt,Math.max(-kt,i.apply(this,arguments)-y)),m=Math.min(Math.abs(v)/f,a.apply(this,arguments)),x=m*(v<0?-1:1);for(s=0;s<f;++s)(h=g[p[s]=s]=+t(o[s],s,o))>0&&(d+=h);for(null!=e?p.sort(function(t,n){return e(g[t],g[n])}):null!=n&&p.sort(function(t,e){return n(o[t],o[e])}),s=0,u=d?(v-f*x)/d:0;s<f;++s,y=l)c=p[s],l=y+((h=g[c])>0?h*u:0)+x,g[c]={data:o[c],index:s,value:h,startAngle:y,endAngle:l,padAngle:m};return g}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:ht(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ht(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:ht(+t),o):i},o.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:ht(+t),o):a},o}().sortValues(null);return l.startAngle(i.startAngle),l.endAngle(i.endAngle),l.padAngle(i.padAngle),Os(l(n),k({},this.rect,{x:0,y:0}),r,o)}};var Ds=function(t){function e(e){if(t[e.type]&&t[e.type].condition(e)){var n=t[e.type],r=void 0===n.conditionAppend||n.conditionAppend(e);n.items.forEach(function(t){var n=Math.round(e[t.key]),i=e[t.key]-n;e[t.key]=n,r&&"append"===t.type&&(i>0?e[t.key]+=.5:e[t.key]-=.5)})}}return void 0===t&&((t={}).line={append:["x1","x2","y1","y2"],round:[],condition:function(t){return t.x1===t.x2||t.y1===t.y2},conditionAppend:function(t){return t.strokeWidth%2!=0}},t.rect={append:["x","y"],round:["width","height"],condition:function(){return!0},conditionAppend:function(t){return t.strokeWidth%2!=0}}),Object.keys(t).forEach(function(e){var n=t[e];n.items=[],n.append.forEach(function(t){n.items.push({key:t,type:"append"})}),n.round.forEach(function(t){n.items.push({key:t,type:"round"})})}),e.multiple=function(t){return t.forEach(function(t){return e(t)})},e}(),zs=function(){function t(){S(this,t),this.reset(),this.push.apply(this,arguments)}return A(t,[{key:"transposeCoordinate",value:function(t,e,n){if("number"==typeof e&&isFinite(e)){var r=t.substring(0,1);if("x"===r||"cx"===t)return e*this.width;if("width"===t)return e*this.width;if("r"===t)return e*(n?this.height:this.width);if("y"===r||"cy"===t)return e*this.height;if("height"===t)return e*this.height}return e}},{key:"push",value:function(){var t;return(t=this.storage).push.apply(t,arguments),this}},{key:"processItem",value:function(e){var n={},r=void 0!==e.flipXY?e.flipXY:this.flipXY,i=void 0!==e.crisp?e.crisp:this.crisp;if(e.fn&&"function"==typeof e.fn){var a=r?this.height:this.width,o=r?this.width:this.height;e=e.fn({width:a,height:o,flipXY:r});for(var s=Object.keys(e),c=0,u=s.length;c<u;c++){var l=s[c];n[t.evaluateKey(l,r)]=e[l]}}else for(var h=Object.keys(e),f=0,d=h.length;f<d;f++){var p=h[f],g=t.evaluateKey(p,r),y=this.transposeCoordinate(g,e[p],r);n[g]=y}return i&&Ds(n),n}},{key:"output",value:function(){for(var t=[],e=0,n=this.storage.length;e<n;e++){var r=this.processItem(this.storage[e]);t.push(r)}return t}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(t,e){if(e){var n=t.substring(0,1),r=t.substring(1);if("x"===n)return"y".concat(r);if("y"===n)return"x".concat(r);if("cx"===t)return"cy";if("cy"===t)return"cx";if("width"===t)return"height";if("height"===t)return"width"}return t}}]),t}();function js(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(zs,e)}function qs(t,e){return t&&e?t.cachedTicks&&t.cachedTicks()||t.ticks({distance:e}):[]}var Ps={created:function(){},require:["chart","renderer"],defaultSettings:{displayOrder:0,style:{ticks:"$guide-line",minorTicks:"$guide-line--minor"}},beforeRender:function(t){this.rect=t.size,this.blueprint=js(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this;if(this.x=this.settings.x?this.chart.scale(this.settings.x):null,this.y=this.settings.y?this.chart.scale(this.settings.y):null,Ya(this,"x",this.rect.width),Ya(this,"y",this.rect.height),!this.x&&!this.y)return[];this.settings.ticks=k({show:!0},this.style.ticks,this.settings.ticks||{}),this.settings.minorTicks=k({show:!1},this.style.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=qs(this.x,this.rect.width),this.lines.y=qs(this.y,this.rect.height),this.lines.y=this.lines.y.map(function(t){return k(t,{flipXY:!0})});var e={};return I(this.lines.x).concat(I(this.lines.y)).forEach(function(n){(e=n.isMinor?t.settings.minorTicks:t.settings.ticks).show&&t.blueprint.push({type:"line",x1:n.position,y1:0,x2:n.position,y2:1,stroke:e.stroke||"black",strokeWidth:void 0!==e.strokeWidth?e.strokeWidth:1,strokeDasharray:void 0!==e.strokeDasharray?e.strokeDasharray:void 0,flipXY:n.flipXY||!1})}),this.blueprint.output()}};function Is(t){if(void 0===t)return 0;if("number"==typeof t&&isFinite(t))return t;if("string"==typeof t)switch(t){case"center":case"middle":return.5;case"bottom":case"right":return 1;case"top":case"left":default:return 0}return 0}function Fs(t){var e={value:t.value};return t.label&&(e.label=t.label.text),e}function Ls(t){return void 0!==t.value}var Bs={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,style:{oob:{show:!0,width:10,fill:"#1A1A1A",stroke:"transparent",strokeWidth:0,opacity:1,text:{fontFamily:"Arial",stroke:"transparent",fill:"#fff",strokeWidth:0,opacity:1},triangle:{fill:"#4D4D4D",stroke:"transparent",strokeWidth:0,opacity:1},padding:{x:28,y:5}},line:{stroke:"#000"},label:{strokeWidth:0}}},preferredSize:function(){return 30},beforeRender:function(t){this.rect=t.size,this.blueprint=js(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this,e=this.settings;if(this.lines={x:[],y:[]},this.lines.x=e.lines&&e.lines.x||[],this.lines.y=e.lines&&e.lines.y||[],0===this.lines.x.length&&0===this.lines.y.length)return[];var n={x0:[],x1:[],y0:[],y1:[]};this.lines.x=this.lines.x.filter(Ls).map(function(e){if(e.scale){var n=t.chart.scale(e.scale);return k(e,{scale:n,position:n(e.value)})}return k(e,{position:e.value})}),this.lines.y=this.lines.y.filter(Ls).map(function(e){if(e.scale){var n=t.chart.scale(e.scale);return k(e,{scale:n,position:n(e.value),flipXY:!0})}return k(e,{position:e.value,flipXY:!0})}),this.lines.x=this.lines.x.filter(function(t){return!(t.position<0||t.position>1)||(n["x".concat(t.position>1?1:0)].push(Fs(t)),!1)}),this.lines.y=this.lines.y.filter(function(t){return!(t.position<0||t.position>1)||(n["y".concat(t.position>1?1:0)].push(Fs(t)),!1)});var r=[];return I(this.lines.x).concat(I(this.lines.y)).forEach(function(n){(!0===n.show||void 0===n.show)&&function(t){var e,n=t.chart,r=t.blueprint,i=t.renderer,a=t.p,o=t.settings,s=t.items,c=!0,u=!1,l=!1,h=!1,f=k(!0,{},o.style.line,a.line||{});if(e=r.processItem({type:"line",x1:a.position,y1:0,x2:a.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,flipXY:a.flipXY||!1}),a.label){var d,p=k(!0,{fill:"#000",fontFamily:"Arial",fontSize:"12px",opacity:1,maxWidth:1,maxWidthPx:9999,padding:5,background:{fill:"#fff",stroke:"transparent",strokeWidth:0,opacity:.5}},o.style.label||{},{fill:f.stroke},a.label),g={width:0,height:0},y="";if("string"==typeof a.formatter)d=n.formatter(a.formatter);else if("object"===_(a.formatter))d=n.formatter(a.formatter);else if(void 0!==a.scale&&a.scale.data){var v=a.scale.data()&&a.scale.data().fields;d=v&&v[0]?v[0].formatter():null}d?y=" (".concat(d(a.value),")"):a.scale&&(y=" (".concat(a.value,")")),y&&(g=i.measureText({text:y,fontFamily:p.fontFamily,fontSize:p.fontSize}));var m=i.measureText({text:p.text||"",fontFamily:p.fontFamily,fontSize:p.fontSize}),x={width:m.width+g.width,height:Math.max(m.height,g.height)},b=p.padding,w=Is(a.flipXY?p.vAlign:p.align),M=Is(a.flipXY?p.align:p.vAlign),S=Math.min(1+x.width+2*b,p.maxWidth*r.width,p.maxWidthPx),R=x.height+2*b,A=a.flipXY?R:S,C=a.flipXY?S:R;if((u=r.processItem({fn:function(t){var e=t.width,n=t.height,i=a.position*e-(a.flipXY?R:S)*(1-w);return{type:"rect",x:i=a.flipXY?i:Math.max(i,0),y:Math.max(Math.abs(M*n-C*M),0),width:a.flipXY?A:Math.min(A,r.width-i),height:C,stroke:p.background.stroke,strokeWidth:p.background.strokeWidth,fill:p.background.fill,opacity:p.background.opacity}},flipXY:a.flipXY||!1})).x<-1||u.x+u.width>r.width+1||u.y<-1||u.y+u.height>r.height+1)u=void 0;else{l={type:"text",text:p.text||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:u.x+b,y:u.y+u.height/2+x.height/3,maxWidth:u.width-2*b-g.width,anchor:"start"},y&&(h={type:"text",text:y||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:l.x+3+(u.width-(g.width+2*b)),y:l.y});for(var N=0,O=s.length;N<O;N++){var T=s[N];"rect"===T.type?Lo(u,T)&&(c=!1):"line"===T.type&&a.flipXY===T.flipXY&&Wo(u,T)&&(c=!1)}}}s.push(e),c&&u&&l&&(s.push(u,l),h&&s.push(h))}({chart:t.chart,blueprint:t.blueprint,renderer:t.renderer,p:n,settings:e,items:r})}),e.style.oob.show&&function(t){for(var e=t.blueprint,n=t.oob,r=t.settings,i=t.items,a=Object.keys(n),o=r.style.oob||{},s=function(t,r){var s=a[t],c=n[s];if(c.length>0){var u=s.charAt(1),l="y"===s.charAt(0),h=o.padding.x+o.width,f=o.padding.y+o.width,d="bottom";d=l?"1"===u?"bottom":"top":"1"===u?"right":"left";var p=e.processItem({fn:function(t){var e=t.width,n=t.height,r=u*e+("1"===u?-h:h),i=l?f:n-f;return"arc"===o.type?{type:"path",d:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.8,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t," ").concat(e-n,"\n      A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(i?0:1,", ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===r;return"\n    M ".concat(t-n," ").concat(e,"\n    A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(a?1:0,", ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}(l?i:r,l?r:i,o.width,d),x:r,y:i,stroke:o.stroke,fill:o.fill,strokeWidth:o.strokeWidth||0}:{type:"circle",cx:r,cy:i,r:o.width,stroke:o.stroke,fill:o.fill,strokeWidth:o.strokeWidth||0,opacity:o.opacity,data:c}},flipXY:l}),g=p.cx||p.x,y=p.cy||p.y,v={type:"text",text:c.length||"",x:g-.4*o.width,y:y+.4*o.width,fontFamily:o.text.fontFamily,fontSize:"".concat(1.3*o.width,"px"),stroke:o.text.stroke,fill:o.text.fill,strokeWidth:o.text.strokeWidth||0,opacity:o.text.opacity},m={type:"path",d:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.75,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t+=i?1.5*n:-1.5*n," ").concat(e-n,"\n      L ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===r;return e+=a?1.5*n:-1.5*n,"\n    M ".concat(t-n," ").concat(e,"\n    L ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}(g,y,o.width,d),x:g,y:y,stroke:o.triangle.stroke,fill:o.triangle.fill,strokeWidth:o.triangle.strokeWidth||0,opacity:o.triangle.opacity};i.push(p,v,m)}},c=0,u=a.length;c<u;c++)s(c)}({blueprint:this.blueprint,oob:n,settings:e,items:r}),r}};function Ws(t){var e={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===t.align||"bottom"===t.align?(e.x1=t.innerRect.x-t.outerRect.x,e.x2=t.innerRect.width+t.innerRect.x,e.y1=e.y2="top"===t.align?t.innerRect.height-t.padding:t.padding):(e.x1=e.x2="left"===t.align?t.innerRect.width-t.padding:t.padding,e.y1=t.innerRect.y-t.outerRect.y,e.y2=t.innerRect.height+t.innerRect.y),function(t,e){k(t,e.style);var n=t.strokeWidth/2;"top"===e.align?(t.y1-=n,t.y2-=n):"bottom"===e.align?(t.y1+=n,t.y2+=n):"left"===e.align?(t.x1-=n,t.x2-=n):"right"===e.align&&(t.x1+=n,t.x2+=n)}(e,t),e}function Vs(t,e,n){n.layered||!n.stepSize?function(t,e){e.collider={type:"polygon",vertices:[{x:e.boundingRect.x,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y+e.boundingRect.height},{x:e.boundingRect.x,y:e.boundingRect.y+e.boundingRect.height}]}}(0,e):n.tilted?function(t,e,n){var r=n.angle*(Math.PI/180),i=Math.max(n.stepSize/2,e.boundingRect.height/2),a="start"===e.anchor,o="end"===e.anchor&&r<0,s="start"===e.anchor&&r>=0,c=e.boundingRect.y+(s||o?e.boundingRect.height:0),u=[{x:e.x-i,y:c},{x:e.x+i,y:c}].map(function(t){return go(t,r,{x:e.x,y:e.y})}),l={x:a?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y+e.boundingRect.height},h={x:a?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y},f=r>=0?[l,h]:[h,l];u.push.apply(u,f),e.collider={type:"polygon",vertices:u}}(0,e,n):function(t,e,n){if("bottom"===n.align||"top"===n.align){var r=t.position*n.innerRect.width+(n.innerRect.x-n.outerRect.x-n.stepSize/2);e.collider={type:"rect",x:r,y:0,width:r<0?n.stepSize+r:n.stepSize,height:n.innerRect.height}}else{var i=t.position*n.innerRect.height+(n.innerRect.y-n.outerRect.y-n.stepSize/2);e.collider={type:"rect",x:0,y:i,width:n.innerRect.width,height:i<0?n.stepSize+i:n.stepSize}}var a=e.collider;a.x=Math.max(a.x,0),a.y=Math.max(a.y,0);var o=a.x+a.width-(n.outerRect.x+n.outerRect.width);a.width=o>0?a.width-o:a.width;var s=a.y+a.height-(n.outerRect.y+n.outerRect.height);a.height=s>0?a.height-s:a.height}(t,e,n)}function Hs(t,e){var n=isNaN(t.style.align)?.5:Math.min(Math.max(t.style.align,0),1),r=0;if(t.tilted)r=t.stepSize*n;else{var i=e?t.textRect.height:t.textRect.width;r=Math.max(0,t.stepSize-i)*n}return r}function Us(t,e){var n,r={type:"text",text:(n=t.label,"string"==typeof n||"number"==typeof n?n:"-"),x:0,y:0,maxWidth:e.maxWidth,maxHeight:e.maxHeight};return"top"===e.align||"bottom"===e.align?(r.x=t.start*e.innerRect.width+(e.innerRect.x-e.outerRect.x)+Hs(e,!1),r.y="top"===e.align?e.innerRect.height:0,r.anchor=e.stepSize?"start":"middle",r.x+=isNaN(e.style.offset)?0:+e.style.offset):(r.y=t.start*e.innerRect.height+(e.innerRect.y-e.outerRect.y)+Hs(e,!0),r.x="left"===e.align?e.innerRect.width:0,r.anchor="left"===e.align?"end":"start",r.baseline=e.stepSize?"text-before-edge":"central",r.y+=isNaN(e.style.offset)?0:+e.style.offset),function(t,e){["fill","fontSize","fontFamily"].forEach(function(n){t[n]=e.style[n]})}(r,e),function(t,e){if(!e.tilted&&!e.stepSize)if("top"===e.align||"bottom"===e.align){var n=e.outerRect.width,r=Math.min(.75*e.maxWidth/2,e.textRect.width/2),i=t.x-r,a=t.x+r;i<0?(t.anchor="start",t.x=e.innerRect.x-e.outerRect.x,t.maxWidth*=.75):a>n&&(t.anchor="end",t.x=e.innerRect.width+e.innerRect.x,t.maxWidth*=.75)}else{var o=e.outerRect.height,s=e.maxHeight/2,c=t.y-s,u=t.y+s;c<0?(t.y=e.innerRect.y-e.outerRect.y,t.baseline="text-before-edge"):u>o&&(t.y=e.innerRect.height+(e.innerRect.y-e.outerRect.y),t.baseline="text-after-edge")}}(r,e),function(t,e){"top"===e.align?t.y-=e.padding:"bottom"===e.align?t.y+=e.padding+e.maxHeight:"left"===e.align?t.x-=e.padding:"right"===e.align&&(t.x+=e.padding)}(r,e),function(t,e){if(e.tilted){var n=-e.angle,r=n*(Math.PI/180);"bottom"===e.align?(t.x-=e.maxHeight*Math.sin(r)/2,t.y-=e.maxHeight,t.y+=e.maxHeight*Math.cos(r)/2):t.x-=e.maxHeight*Math.sin(r)/3,t.transform="rotate(".concat(n,", ").concat(t.x,", ").concat(t.y,")"),t.anchor="bottom"===e.align==e.angle<0?"start":"end";var i=Math.cos(r)*e.maxWidth;if("bottom"===e.align==e.angle<0){var a=e.outerRect.width-e.paddingEnd;t.x+i>a&&(t.maxWidth=(a-t.x-10)/Math.cos(r))}else{var o=e.paddingEnd;t.x-i<o&&(t.maxWidth=(t.x-o-10)/Math.cos(r))}}}(r,e),function(t,e){t.boundingRect=e.textBounds(t)}(r,e),Vs(t,r,e),r}function $s(t,e){var n={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===e.align||"bottom"===e.align?(n.x1=n.x2=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),n.y1="top"===e.align?e.innerRect.height:0,n.y2="top"===e.align?n.y1-e.tickSize:n.y1+e.tickSize):(n.y1=n.y2=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),n.x1="left"===e.align?e.innerRect.width:0,n.x2="left"===e.align?n.x1-e.tickSize:n.x1+e.tickSize),function(t,e){k(t,e.style)}(n,e),function(t,e){"top"===e.align?(t.y1-=e.padding,t.y2-=e.padding):"bottom"===e.align?(t.y1+=e.padding,t.y2+=e.padding):"left"===e.align?(t.x1-=e.padding,t.x2-=e.padding):"right"===e.align&&(t.x1+=e.padding,t.x2+=e.padding)}(n,e),function(t,e){var n=t.strokeWidth/2;t.x1===e.innerRect.width?(t.x1-=n,t.x2-=n):0===t.x1?(t.x1+=n,t.x2+=n):t.y1===e.innerRect.height?(t.y1-=n,t.y2-=n):0===t.y1&&(t.y1+=n,t.y2+=n)}(n,e),n}function Ys(t){return!t.isMinor&&t.position>=0&&t.position<=1}function Xs(t){var e=t.rect,n=t.state,r=t.majorTicks,i=t.measure;return t.horizontal?function(t){for(var e=t.majorTicks,n=t.measureText,r=t.rect,i="layered"===t.state.labels.activeMode?2:1,a=r.width,o=e.map(function(t){return t.label}).map(function(t){return"".concat(t.slice(0,1)).concat(t.length>1?"…":"")}).map(n).map(function(t){return t.width}),s=0;s<e.length;++s){var c=e[s];if(i*a*Math.abs(c.start-c.end)<o[s])return!0}return!1}({majorTicks:r,measureText:i,rect:e,state:n}):function(t){var e=t.majorTicks,n=t.measureText,r=t.rect.height,i=n("M").height;return!(e.length<2)&&r*Math.abs(e[0].position-e[1].position)<i}({majorTicks:r,measureText:i,rect:e,state:n})}function Ks(t){var e=t.value,n=t.maxValue,r=t.minValue,i=t.range,a=t.modifier;return isNaN(i)||isNaN(a)||(e=i*a),e>n&&(e=n),e<r&&(e=r),e}function Gs(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,a=t.scale,o=t.settings,s=t.state,c=0,u={left:0,top:0,right:0,bottom:0},l=o.labels,h=l.maxLengthPx,f=l.minLengthPx;if(o.labels.show){var d,p,g=o.align,y="top"===g||"bottom"===g,v=y?n.width:n.height,m=a.ticks({settings:o,distance:v,formatter:r}).filter(Ys),x=function(t){var e=i({text:t,fontSize:o.labels.fontSize,fontFamily:o.labels.fontFamily});return e.width=Ks({value:e.width,maxValue:h,minValue:f}),e};if(e&&y&&"auto"===o.labels.mode&&(!function(t){var e=t.majorTicks,n=t.measure,r=t.rect,i=t.state,a=t.settings.labels.maxGlyphCount,o="layered"===i.labels.activeMode?2:1,s=n("…").width,c=r.width,u=0;if(isNaN(a))for(var l=0;l<e.length;l++){var h=e[l],f=h.label;if(n(f).width*(f.length>1?.7:1)+s>(u=o*c*Math.abs(h.start-h.end)))return!0}else if(u=o*c*e.reduce(function(t,e){return Math.min(Math.abs(e.start-e.end),t)},1/0),.7*n("M").width*a+s>u)return!0;return!1}({majorTicks:m,measure:x,rect:n,state:s,settings:o})?s.labels.activeMode="horizontal":s.labels.activeMode="tilted"),!o.labels.filterOverlapping&&"tilted"!==s.labels.activeMode&&Xs({rect:n,state:s,majorTicks:m,measure:x,horizontal:y}))return{size:Math.max(n.width,n.height),isToLarge:!0};if("tilted"===s.labels.activeMode){var b=Math.abs(o.labels.tiltAngle)*(Math.PI/180);d=function(t){return Ks({value:t.width,maxValue:h,minValue:f})*Math.sin(b)+t.height*Math.cos(b)}}else d=y?function(t){return t.height}:function(t){return Ks({value:t.width,maxValue:h,minValue:f})};if(y&&"tilted"!==s.labels.activeMode)p=["M"];else if(isNaN(o.labels.maxGlyphCount))p=m.map(function(t){return t.label});else{for(var w="",k=0;k<o.labels.maxGlyphCount;k++)w+="M";p=[w]}var M=p.map(x),_=M.map(d),S=Math.max.apply(Math,I(_).concat([0]));if(c+=S,c+=o.labels.margin,"layered"===s.labels.activeMode&&(c*=2),"tilted"===s.labels.activeMode){var R="bottom"===o.align==o.labels.tiltAngle>=0,A=Math.abs(o.labels.tiltAngle)*(Math.PI/180),C=(S-i("M").height*Math.cos(A))/Math.sin(A),N=Math.min(o.labels.maxEdgeBleed,Math.max.apply(Math,I(M.map(function(t){return Math.min(C,t.width)*Math.cos(A)+t.height}).map(function(t,e){var r=m[e]?m[e].position:0;return R?t-r*n.width:t-(1-r)*n.width})).concat([0])))+o.paddingEnd;if(u[R?"left":"right"]=N,!o.labels.filterOverlapping&&function(t){var e=t.majorTicks,n=t.measureText,r=t.rect,i=t.bleedSize,a=t.angle;if(e.length<2)return!1;if(0===a)return!0;var o=Math.abs(a),s=1/((r.width-i)*Math.abs(e[0].position-e[1].position));return n("M").height>Math.sin(o*(Math.PI/180))/s}({majorTicks:m,measureText:i,rect:n,bleedSize:N,angle:o.labels.tiltAngle}))return{size:Math.max(n.width,n.height),isToLarge:!0}}}return{size:c,edgeBleed:u}}function Zs(t){var e=0;return e+=t.paddingStart,e+=t.line.show?t.line.strokeWidth:0,e+=t.ticks.show?t.ticks.margin:0}function Js(t){var e=0;return e+=t.ticks.show?t.ticks.tickSize:0,e+=Zs(t)+t.labels.margin}function Qs(t){return t.filter(function(t){return!t.isMinor})}function tc(t,e){return t.map(function(t){return $s(t,e)})}function ec(t,e){return e?Math.abs(e.end-e.start):t.bandwidth()}function nc(t){var e=t.measureText,n=t.settings,r=t.innerRect,i=t.scale,a=t.tilted,o=t.layered,s=t.tick,c=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,u=ec(i,s),l={width:0,height:c};if("left"===n.align||"right"===n.align)l.width=r.width-Js(n)-n.paddingEnd;else if(o)l.width=u*r.width*2;else if(a){var h=Math.abs(n.labels.tiltAngle)*(Math.PI/180);l.width=(r.height-Js(n)-n.paddingEnd-c*Math.cos(h))/Math.sin(h)}else l.width=u*r.width;return l.width=Ks({value:l.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),l}function rc(t){var e=t.measureText,n=t.settings,r=t.innerRect,i=t.ticks,a=t.tilted,o=t.layered,s=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,c={width:0,height:s};if("left"===n.align||"right"===n.align)c.width=r.width-Js(n)-n.paddingEnd;else if(o)c.width=r.width/Qs(i).length*.75*2;else if(a){var u=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(r.height-Js(n)-n.paddingEnd-s*Math.cos(u))/Math.sin(u)}else c.width=r.width/Qs(i).length*.75;return c.width=Ks({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function ic(t){var e;function n(){return e=rc,n}function r(){return e=nc,r}function i(t){var n,r=t.settings,i=t.scale,a=t.innerRect,o=t.outerRect,s=t.measureText,c=t.ticks,u=t.state,l=t.textBounds,h=[],f=Qs(c),d=function(t){return t.filter(function(t){return t.isMinor})}(c),p={innerRect:a,align:r.align,outerRect:o},g="tilted"===u.labels.activeMode,y="layered"===u.labels.activeMode;if(r.line.show&&(p.style=r.line,p.padding=r.paddingStart,h.push(Ws(p))),r.ticks.show&&(p.style=r.ticks,p.tickSize=r.ticks.tickSize,p.padding=Zs(r),n=tc(f,p)),r.labels.show){var v=Js(r);p.style=r.labels,p.padding=v,p.tilted=g,p.layered=y,p.angle=r.labels.tiltAngle,p.paddingEnd=r.paddingEnd,p.textBounds=l;var m=function(t){var n,o,u=e({measureText:s,settings:r,innerRect:a,ticks:c,scale:i,tilted:g,layered:y,tick:t});p.maxWidth=u.width,p.maxHeight=u.height,p.textRect=(n={tick:t,measureText:s,style:p.style},o=n.style,(0,n.measureText)({text:n.tick.label,fontSize:o.fontSize,fontFamily:o.fontFamily})),p.stepSize=function(t){var e=t.innerRect,n=t.scale,r=t.settings,i=t.tick;return("top"===r.align||"bottom"===r.align?e.width:e.height)*ec(n,i)}({innerRect:a,scale:i,ticks:c,settings:r,tick:t})},x=[];x=!y||"top"!==r.align&&"bottom"!==r.align?function(t,e,n){return t.map(function(t){n(t);var r=Us(t,e);return r.data=t.data,r})}(f,p,m):function(t,e,n,r){var i=e.padding,a=Js(n);return t.map(function(t,o){r(t);var s=a+e.maxHeight+n.labels.margin;e.layer=o%2,e.padding=o%2==0?i:s;var c=Us(t,e);return c.data=t.data,c})}(f,p,r,m),r.labels.filterOverlapping&&function(t,e,n){var r=function(e,n){return Lo(t[e].boundingRect,t[n].boundingRect)};if(n&&n.tilted){var i=Math.abs(n.angle);r=function(e,n){var r=1/Math.abs(t[e].x-t[n].x),a=Math.sin(i*(Math.PI/180))/r;return t[e].boundingRect.height>a}}for(var a=0;a<=t.length-1;a++)for(var o=a+1;o<=Math.min(a+5,a+(t.length-1));o++)t[a]&&t[o]&&r(a,o)&&(o===t.length-1?(t.splice(a,1),e&&e.splice(a,1)):(t.splice(o,1),e&&e.splice(o,1)),o--,a--)}(x,n,p),h.push.apply(h,I(x))}return r.minorTicks&&r.minorTicks.show&&d.length>0&&(p.style=r.minorTicks,p.tickSize=r.minorTicks.tickSize,p.padding=function(t){return t.line.strokeWidth+t.minorTicks.margin}(r),h.push.apply(h,I(tc(d,p)))),n&&h.push.apply(h,I(n)),h}return n.build=i,r.build=i,t?r():n()}var ac={labels:{show:!0,tiltAngle:40,maxEdgeBleed:1/0,margin:4,maxLengthPx:150,minLengthPx:0,mode:"auto",maxGlyphCount:NaN,align:.5,offset:0,filterOverlapping:!1},ticks:{show:!1,margin:0,tickSize:4},line:{show:!1},paddingStart:0,paddingEnd:10,align:"auto"},oc={labels:{show:!0,margin:4,maxLengthPx:150,minLengthPx:0,align:.5,offset:0,filterOverlapping:!0},ticks:{show:!0,margin:0,tickSize:8},minorTicks:{show:!1,tickSize:3,margin:0},line:{show:!0},paddingStart:0,paddingEnd:10,align:"auto"};var sc={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,prioOrder:0,settings:{},style:{labels:"$label",ticks:"$guide-line",minorTicks:"$guide-line--minor",line:"$guide-line"}},created:function(){this.state={isDiscrete:!!this.scale.bandwidth,isHorizontal:!1,labels:{activeMode:"horizontal"},ticks:[],innerRect:{width:0,height:0,x:0,y:0},outerRect:{width:0,height:0,x:0,y:0},defaultDock:void 0,concreteNodeBuilder:void 0,settings:void 0},this.state.isDiscrete?this.state.defaultDock="bottom":this.state.defaultDock="left",this.setState(this.settings)},setState:function(){var t,e,n,r,i,a,o;this.state.isDiscrete=!!this.scale.bandwidth,this.state.settings=(e=(t=this).state,n=t.style,r=t.settings,i=k(!0,{},e.isDiscrete?ac:oc,n),a=k(!0,{},i,r.settings),o=r.dock||e.defaultDock,a.dock=o,a.align=function(t,e){var n=["top","bottom"],r=["left","right"];return-1!==n.indexOf(t)&&-1===r.indexOf(e)?t:-1!==r.indexOf(t)&&-1===n.indexOf(e)?t:e}(r.settings.align,o),a.labels.tiltAngle=Math.max(-90,Math.min(a.labels.tiltAngle,90)),a),this.state.concreteNodeBuilder=ic(this.state.isDiscrete),this.dockConfig.dock(this.state.settings.dock),this.state.isHorizontal="top"===this.state.settings.align||"bottom"===this.state.settings.align,this.state.labels.activeMode=function(t,e,n){var r=e.labels.mode;return n&&t.isHorizontal?"auto"===r?t.labels.activeMode:-1!==["layered","tilted"].indexOf(e.labels.mode)&&-1!==["top","bottom"].indexOf(e.dock)?r:"horizontal":"horizontal"}(this.state,this.state.settings,this.state.isDiscrete)},preferredSize:function(t){var e=this.formatter,n=this.state,r=this.scale,i=this.state.isHorizontal?t.inner.width:t.inner.height;return this.state.pxScale=Xa(r,i),function(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,a=t.scale,o=t.settings,s=0,c=Gs({isDiscrete:e,rect:n,formatter:r,measureText:i,scale:a,settings:o,state:t.state}),u=c.size,l=c.edgeBleed;if(s+=u,c.isToLarge)return{size:s};if(o.ticks.show&&(s+=o.ticks.margin,s+=o.ticks.tickSize),o.minorTicks&&o.minorTicks.show){var h=o.minorTicks.margin+o.minorTicks.tickSize;h>s&&(s=h)}return o.line.show&&(s+=o.line.strokeWidth),s+=o.paddingStart,{size:s+=o.paddingEnd,edgeBleed:l}}({isDiscrete:this.state.isDiscrete,rect:t.inner,formatter:e,measureText:this.renderer.measureText,scale:this.state.pxScale,settings:this.state.settings,state:n})},beforeUpdate:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).settings;this.setState(t)},resize:function(t){var e=t.inner,n=t.outer,r=k({},e,function(t){var e=t.align,n=t.inner;return"left"===e?{x:n.width+n.x}:"right"===e||"bottom"===e?n:{y:n.y+n.height}}({align:this.state.settings.align,inner:e})),i=n||r;return k(this.state.innerRect,r),k(this.state.outerRect,i),n},beforeRender:function(){var t=this.scale,e=this.formatter,n=this.state.isHorizontal?this.state.innerRect.width:this.state.innerRect.height;this.state.pxScale=Xa(t,n),this.state.ticks=this.state.pxScale.ticks({distance:n,formatter:e}).filter(function(t){return t.position>=0&&t.position<=1})},render:function(){var t=this.state,e=[];return e.push.apply(e,I(this.state.concreteNodeBuilder.build({settings:this.state.settings,scale:this.state.pxScale,innerRect:this.state.innerRect,outerRect:this.state.outerRect,measureText:this.renderer.measureText,textBounds:this.renderer.textBounds,ticks:this.state.ticks,state:t}))),Ds.multiple(e),e}},cc="axis";function uc(t,e,n){var r="";if("function"==typeof t)r=t();else if("string"==typeof t)r=t;else if(n){r=(n.data().fields||[]).map(function(t){return t.title()}).join(e)}return r}var lc={require:["renderer","chart"],defaultSettings:{dock:"bottom",displayOrder:0,prioOrder:0,settings:{paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,anchor:"center",join:", ",maxLengthPx:NaN},style:{text:"$title"}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.definitionSettings=this.settings.settings;var t=this.settings.text,e=this.definitionSettings.join;this.title=uc(t,e,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.style.text.fontSize,fontFamily:this.style.text.fontFamily}).height+this.definitionSettings.paddingStart+this.definitionSettings.paddingEnd},beforeRender:function(t){k(this.rect,t.size)},render:function(){var t=this.title,e=this.definitionSettings,n=this.rect,r=[];return r.push(function(t){var e=t.title,n=t.definitionSettings,r=t.dock,i=t.rect,a=t.measureText,o=t.style,s={type:"text",text:e,x:0,y:0,dx:0,dy:0,anchor:function(t,e){var n="middle";return"left"===t?"top"===e?n="end":"bottom"===e&&(n="start"):"right"===t?"top"===e?n="start":"bottom"===e&&(n="end"):"left"===e?n="start":"right"===e&&(n="end"),n}(r,n.anchor),baseline:"alphabetical"};k(s,o.text);var c=a(s);if("top"===r||"bottom"===r){var u=i.width/2;"left"===n.anchor?u=n.paddingLeft||0:"right"===n.anchor&&(u=i.width-(n.paddingRight||0)),s.x=u,s.y="top"===r?i.height-n.paddingStart:n.paddingStart+c.height,s.dy="top"===r?-c.height/6:-c.height/3,s.maxWidth=.8*i.width}else{var l=i.height/2;"top"===n.anchor?l=n.paddingStart:"bottom"===n.anchor&&(l=i.height-n.paddingStart),s.y=l,s.x="left"===r?i.width-n.paddingStart:n.paddingStart,s.dx="left"===r?-c.height/3:c.height/3;var h="left"===r?270:90;s.transform="rotate(".concat(h,", ").concat(s.x+s.dx,", ").concat(s.y+s.dy,")"),s.maxWidth=.8*i.height}return isNaN(n.maxLengthPx)||(s.maxWidth=Math.min(s.maxWidth,n.maxLengthPx)),s}({title:t,dock:this.settings.dock,definitionSettings:e,rect:n,measureText:this.renderer.measureText,style:this.style})),r},beforeUpdate:function(t){t.settings&&(k(this.settings,t.settings),this.definitionSettings=t.settings.settings);var e=this.settings.text,n=this.definitionSettings.join;this.title=uc(e,n,this.scale)}};function hc(t,e){var n,r=t.settings.dock,i=t.settings.settings.invert,a="top"===r||"bottom"===r,o=a?"width":"height",s=t.rect[o],c=t.chart.scroll(t.settings.scroll),u=e[a?"x":"y"];i&&(u=s-u);var l=c.getState();n={startOffset:u,startScroll:l.start,swipe:!1};var h=u/s*(l.max-l.min)+l.min;h<l.start?n.startScroll=h:h>l.start+l.viewSize&&(n.startScroll=h-l.viewSize);return{update:function(t){var e=t[a?"x":"y"];if(i&&(e=s-e),!n.swipe){if(Math.abs(n.startOffset-e)<=1)return;n.swipe=!0}var r=c.getState(),o=(e-n.startOffset)/s*(r.max-r.min),u=n.startScroll+o;c.moveTo(u)},end:function(t){var e=t[a?"x":"y"];i&&(e=s-e);var r=c.getState();if(n.swipe){var o=(e-n.startOffset)/s*(r.max-r.min),u=n.startScroll+o;c.moveTo(u)}else{var l=e/s*(r.max-r.min)+r.min-r.viewSize/2;c.moveTo(l)}}}}function fc(t,e){var n=e.element().getBoundingClientRect();return{x:t.center.x-n.left,y:t.center.y-n.top}}var dc={require:["chart","renderer"],on:{panStart:function(t){var e=fc(t,this.renderer),n={x:e.x-t.deltaX,y:e.y-t.deltaY};this.currentMove=hc(this,n),this.currentMove.update(e)},panMove:function(t){if(this.currentMove){var e=fc(t,this.renderer);this.currentMove.update(e)}},panEnd:function(t){if(this.currentMove){var e=fc(t,this.renderer);this.currentMove.end(e),this.currentMove=null}},panCancel:function(){this.currentMove=null},tap:function(t){var e=fc(t,this.renderer);hc(this,e).end(e)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},created:function(){this.rect={x:0,y:0,width:0,height:0}},preferredSize:function(t){var e=this.chart.scroll(this.settings.scroll).getState();return e.viewSize>=e.max-e.min?Math.max(t.width,t.height):this.settings.settings.width},resize:function(t){var e=t.inner;return this.rect=e,e},render:function(t){var e,n=this.settings.dock,r=this.settings.settings.invert,i="top"===n||"bottom"===n,a=i?"width":"height",o=this.rect[a],s=this.chart.scroll(this.settings.scroll).getState(),c=o*(s.start-s.min)/(s.max-s.min),u=o*s.viewSize/(s.max-s.min);return r&&(c=o-c-u),t("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor,pointerEvents:"auto"}},[].concat(t("div",{class:"scroller",style:(e={position:"absolute"},C(e,i?"left":"top","".concat(c,"px")),C(e,i?"top":"left","25%"),C(e,i?"height":"width","50%"),C(e,a,"".concat(Math.max(1,u),"px")),C(e,"background",this.settings.settings.thumbColor),e)})))},renderer:"dom"};var pc=5,gc=0;function yc(t){var e=t.h,n=t.isVertical,r=t.value,i=t.pos,a=t.align,o=t.borderHit,s=t.state,c=t.idx,u="end"!==a,l=u?{left:"0",top:"0"}:{right:"0",bottom:"0"},h=0,f="100%",d="100%";return s.targetRect&&"start"===s.settings.bubbles.align?(f="".concat(s.targetRect.x+s.targetRect.width,"px"),d="".concat(s.targetRect.y+s.targetRect.height,"px")):s.targetRect&&"end"===s.settings.bubbles.align&&(h=n?s.targetRect.x:s.targetRect.y,f="".concat(s.rect.width-h,"px"),d="".concat(s.rect.height-h,"px")),u||(i-=o),e("div",{onmouseover:function(t){t.srcElement.children[0].style.backgroundColor="#000",t.srcElement.children[0].style[n?"height":"width"]="2px"},onmouseout:function(t){t.srcElement.children[0].style.backgroundColor=s.style.line.stroke,t.srcElement.children[0].style[n?"height":"width"]="1px"},"data-value":r,"data-key":[s.key,"edge",c].join("-"),style:{cursor:n?"ns-resize":"ew-resize",position:"absolute",left:"".concat(n?h:i,"px"),top:"".concat(n?i:h,"px"),height:n?"".concat(o,"px"):d,width:n?f:"".concat(o,"px"),pointerEvents:"auto"}},[e("div",{style:k({backgroundColor:s.style.line.stroke,position:"absolute",height:n?"".concat(1,"px"):"100%",width:n?"100%":"".concat(1,"px"),pointerEvents:"none"},l)})])}function vc(t){var e,n,r=t.h,i=t.isVertical,a=t.label,o=t.otherValue,s=t.idx,c=t.pos,u=t.align,l=t.state,h="end"!==u,f="outside"===l.settings.bubbles.placement,d="none";return i?(n=h?"left":"right",f&&(d=h?"translate(-100%,  0px)":"translate(100%,  0px)")):(n=h?"top":"bottom",f&&(d=h?"translate(0px, -100%)":"translate(0px,  100%)")),r("div",{style:(e={position:"absolute"},C(e,n,"0"),C(e,i?"top":"left","".concat(c,"px")),C(e,"transform",d),e)},[r("div",{"data-key":[l.key,"bubble",s].join("-"),"data-other-value":o,"data-idx":s,style:k({position:"relative",borderRadius:"".concat(l.style.bubble.borderRadius,"px"),border:"".concat(l.style.bubble.strokeWidth,"px solid ").concat(l.style.bubble.stroke),backgroundColor:l.style.bubble.fill,color:l.style.bubble.color,fontFamily:l.style.bubble.fontFamily,fontSize:l.style.bubble.fontSize,padding:"4px 8px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px",minWidth:"50px",minHeight:"1em",pointerEvents:"auto",transform:i?"translate(0,-50%)":"translate(-50%,0)"})},[a])])}function mc(t){var e=t.borderHit,n=t.els,r=t.isVertical,i=t.state,a=t.vStart,o=t.vEnd,s=t.idx,c=0;i.targetRect&&(c=r?i.targetRect.y:i.targetRect.x);var u=!!i.scale,l=u?i.scale.norm(a)*i.size:a,h=u?i.scale.norm(o)*i.size:o,f=Math.abs(l-h),d=Math.min(l,h)+c,p=d+f;if(i.targetRect){var g=i.targetFillRect||i.targetRect,y=r?g.height:g.width,v=u?i.scale.norm(a)*y:a,m=u?i.scale.norm(o)*y:o,x=Math.abs(v-m),b=Math.min(v,m),w={h:i.h,isVertical:r,top:b,height:x,color:i.style.target.fill,opacity:i.style.target.opacity};i.style.target.opacity<.8&&(w.on={onmouseover:function(t){t.srcElement.style.opacity=i.style.target.opacity+.1},onmouseout:function(t){t.srcElement.style.opacity=i.style.target.opacity}}),n.push(i.h("div",{style:{position:"absolute",left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),height:"".concat(g.height,"px"),width:"".concat(g.width,"px")}},[function(t){var e=t.h,n=t.isVertical,r=t.top,i=t.height,a=t.color,o=t.on,s=t.opacity;return e("div",k({style:{backgroundColor:a,opacity:s,position:"absolute",left:n?0:"".concat(r,"px"),top:n?"".concat(r,"px"):0,height:n?"".concat(i,"px"):"100%",width:n?"100%":"".concat(i,"px"),pointerEvents:"auto"}},o),[])}(w)]))}var M=l<h?a:o,_=l<h?o:a,S=P(u?i.scale.domain():[a,o],2),R=S[0],A=S[1];M>=R&&M<=A&&n.push(yc({h:i.h,isVertical:r,borderHit:e,value:M,pos:d,align:"start",state:i,idx:s})),_<=A&&_>=R&&n.push(yc({h:i.h,isVertical:r,borderHit:e,value:_,pos:p,align:"end",state:i,idx:s}));var C=i.settings.bubbles;if(C&&C.show){var N={fontSize:C.fontSize,fontFamily:C.fontFamily,color:C.fill},O=[a,o];M>=R&&M<=A&&n.push(vc({h:i.h,isVertical:r,align:C.align,style:N,idx:s,otherValue:_,label:"".concat(i.format(M,O)),pos:d,state:i})),_<=A&&_>=R&&n.push(vc({h:i.h,isVertical:r,align:C.align,style:N,idx:s,otherValue:M,label:"".concat(i.format(_,O)),pos:p,state:i}))}}function xc(t){var e=t.active.limitHigh-t.active.end,n=t.active.limitLow-t.active.start,r=t.current-t.start;return r=r<0?Math.max(r,n):Math.min(r,e)}function bc(t){var e=[],n=t.direction===gc;if(Array.isArray(t.ranges)&&t.ranges.forEach(function(r,i){t.active&&i===t.active.idx||mc({borderHit:pc,els:e,isVertical:n,state:t,vStart:Math.min(r.min,r.max),vEnd:Math.max(r.min,r.max),idx:i})}),t.active){var r=t.start,i=t.current;if(-1!==t.active.idx)if("foo"===t.active.mode)r=Math.min(t.active.start,t.active.end),i=Math.max(t.active.start,t.active.end);else if("modify"===t.active.mode)r=Math.min(t.start,t.current),i=Math.max(t.start,t.current);else{var a=xc(t);r=t.active.start+a,i=t.active.end+a}mc({borderHit:pc,els:e,isVertical:n,state:t,vStart:r,vEnd:i,idx:t.active.idx})}return e}function wc(t){return{min:t.scale.min(),max:t.scale.max()}}function kc(t){return{min:0,max:t.direction?t.rect.width:t.rect.height}}function Mc(t,e,n){var r,i,a=t.ranges,o=-1;for(r=0;r<a.length;r++){if(a[r].min<=e&&e<=a[r].max){o=r,n.min=r?a[r-1].max:n.min,n.max=r+1<a.length?a[r+1].min:n.max;break}if(e<a[r].min){n.max=a[r].min,n.min=r?a[r-1].max:n.min;break}}-1===o&&a.length&&r>=a.length&&(n.min=a[a.length-1].max),-1!==o&&(i={idx:o,start:a[o].min,end:a[o].max,limitLow:n.min,limitHigh:n.max,mode:"foo"}),t.active=i}function _c(t){t.renderer.render(bc(t))}function Sc(t,e){if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map(function(t){return t.id()}),i=e.brushes().filter(function(t){return"range"===t.type&&-1!==r.indexOf(t.id)})[0];return i?i.brush.ranges():[]}function Rc(t,e){for(var n,r=1/0,i=e.domain(),a=e.bandwidth()/2,o=0;o<i.length;++o){var s=Math.abs(t-a-e(i[o]));s<r&&(r=s,n=i[o])}return n}function Ac(t,e){return Math.min.apply(Math,I(t))<=Math.max.apply(Math,I(e))&&Math.max.apply(Math,I(t))>=Math.min.apply(Math,I(e))}function Cc(t){return Y(t.reduce(function(t,e){return t.push.apply(t,I($(e.bounds))),t},[]))}var Nc={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{rangeStart:function(t){this.start(t)},rangeMove:function(t){this.move(t)},rangeEnd:function(t){this.end(t)},rangeClear:function(t){this.clear(t)}},created:function(){this.state={key:this.settings.key||"brush-range"}},beforeRender:function(t){this.state.rect=t.size.computedInner},renderRanges:function(){this.state.started||(this.state.ranges=Sc(this.state,this.state.brushInstance),this.state.active=null,_c(this.state))},render:function(t){var e=this,n=this.settings.settings;this.state.direction="vertical"===n.direction?gc:1;var r=this.renderer.element().getBoundingClientRect(),i=this.state.rect[this.state.direction===gc?"height":"width"],a=Xa(this.chart.scale(n.scale),i),o=function(t){var e={targetRect:null,targetFillRect:null,scale:null,size:null},n=t.settings.settings,r=n.target?t.chart.component(n.target.component):null,i=n.target&&n.target.selector?t.chart.findShapes(n.target.selector):[],a=n.target&&n.target.fillSelector?t.chart.findShapes(n.target.fillSelector):[];if(i.length>0){var o=Cc(i);if(e.size=o[t.state.direction===gc?"height":"width"],e.scale=Xa(t.chart.scale(n.scale),e.size),e.targetRect=o,a.length>0){var s=Cc(a);e.targetFillRect=s}}else if(r&&r.rect){var c=r.rect.computedInner;e.targetRect={x:c.x-t.state.rect.x,y:c.y-t.state.rect.y,width:c.width,height:c.height}}return e}(this);if(a=o.scale?o.scale:a,this.state.targetRect=o.targetRect,this.state.targetFillRect=o.targetFillRect,this.state.size=null===o.size?i:o.size,this.state.settings=n,this.state.style=this.style,this.state.offset=r,this.state.brush="object"===_(n.brush)?n.brush.context:n.brush,this.state.brushInstance=this.chart.brush(this.state.brush),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.cssCoord={offset:this.state.direction===gc?"top":"left",coord:this.state.direction===gc?"y":"x",pos:this.state.direction===gc?"deltaY":"deltaX"},this.state.format="function"==typeof n.bubbles.label&&function(t,r){return n.bubbles.label.call(void 0,{datum:t,data:r,scale:a,resources:{scale:e.chart.scale,formatter:e.chart.formatter}})},{}.hasOwnProperty.call(a,"norm")){this.state.observeBrush="object"===_(n.brush)&&n.brush.observe,this.state.fauxBrushInstance=null,this.state.findValues=null,this.state.scale=a;var s=this.state.scale.data();!this.state.format&&s&&s.fields&&s.fields[0]&&(this.state.format=s.fields[0].formatter())}else this.state.scale=sa(),this.state.scale.data=a.data,this.state.format||(this.state.format=function(t,e){return Ac(a.range(),e)?function(t,e){var n=e.ticks(),r=e.domain().indexOf(Rc(t,e));return-1!==r?n[r].label:"-"}(t,a):"-"}),this.state.fauxBrushInstance=Fa(),this.state.findValues=function(t){return function(t,e){var n=e.domain(),r=e.range(),i=[];return t.forEach(function(t){if(Ac(r,[t.min,t.max])){var a=n.indexOf(Rc(t.min,e)),o=n.indexOf(Rc(t.max,e));i.push.apply(i,n.slice(Math.min(a,o),Math.max(a,o)+1))}}),i}(t,a)};return this.state.ranges=Sc(this.state,this.state.brushInstance),[bc(this.state)]},mounted:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.on("update",this.renderRanges)},beforeDestroy:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.removeListener("update",this.renderRanges)},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,a=t.targetSize;if(!e.started){var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(o,s);r.element().contains(c)||(c=null);var u={started:!0};e.offset=k({},r.element().getBoundingClientRect());var l=o-e.offset.left,h=s-e.offset.top;e.offset.left+=e.targetRect?e.targetRect.x:0,e.offset.top+=e.targetRect?e.targetRect.y:0,e.ranges=i(e,e.fauxBrushInstance||e.brushInstance);var f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset];u.current=e.scale.normInvert(d/e.size),u.start=e.scale.normInvert(f/e.size);var p,g,y=e.ranges,v=wc(e),m=-1;if(c&&c.hasAttribute("data-idx"))m=parseInt(c.getAttribute("data-idx"),10),v.min=m>0?y[m-1].max:v.min,v.max=m+1<y.length?y[m+1].min:v.max;else{for(p=0;p<y.length;p++){if(y[p].min<=u.start&&u.start<=y[p].max){m=p,v.min=p?y[p-1].max:v.min,v.max=p+1<y.length?y[p+1].min:v.max;break}if(u.start<y[p].min){v.max=y[p].min,v.min=p?y[p-1].max:v.min;break}}-1===m&&y.length&&p>=y.length&&(v.min=y[y.length-1].max)}if(-1!==m||e.multi||(u.ranges=[],v.min=e.scale.min(),v.max=e.scale.max()),-1!==m)if(g={idx:m,start:y[m].min,end:y[m].max,limitLow:v.min,limitHigh:v.max,mode:"move"},c&&c.hasAttribute("data-other-value"))u.start=parseFloat(c.getAttribute("data-other-value")),g.mode="modify";else{var x=e.scale.norm(g.start)*e.size,b=e.scale.norm(g.end)*e.size;Math.abs(f-x)<=a?(u.start=g.end,g.mode="modify"):Math.abs(f-b)<=a&&(u.start=g.start,g.mode="modify")}else g={idx:-1,start:u.start,end:u.current,limitLow:v.min,limitHigh:v.max,mode:"current"};u.active=g,"modify"!==g.mode&&e.targetRect&&!Bo(e.targetRect,{x:l,y:h})||Object.keys(u).forEach(function(t){return e[t]=u[t]})}}({e:t,state:this.state,renderer:this.renderer,ranges:Sc,targetSize:pc})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t,t.fauxBrushInstance||t.brushInstance);var n=wc(t);Mc(t,t.current,n)}(this.state,Sc),_c(this.state),this.state.active=null)},move:function(t){this.state.started&&(!function(t,e){var n=(e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset])/t.size,r=t.scale.normInvert(n);t.current=Math.max(Math.min(r,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=xc(t);e[t.active.idx].min+=n,e[t.active.idx].max+=n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});var r=t.scale.data();r&&r.fields&&r.fields.forEach(function(n){if(t.fauxBrushInstance){var r=Sc(t,t.fauxBrushInstance),i=t.findValues(r),a=t.findValues(e),o=a.filter(function(t){return-1===i.indexOf(t)}),s=i.filter(function(t){return-1===a.indexOf(t)}),c=o.map(function(t){return{key:n.id(),value:t}}),u=s.map(function(t){return{key:n.id(),value:t}});t.brushInstance.addAndRemoveValues(c,u),t.fauxBrushInstance.setRange(n.id(),e)}else t.brushInstance.setRange(n.id(),e)})}(this.state),_c(this.state))},clear:function(){this.state.fauxBrushInstance&&this.state.fauxBrushInstance.clear(),this.state.renderer.render([]),this.state.started=!1,this.state.active=null}};function Oc(t){t.renderer.render(bc(t))}function Tc(t){return t.rc.ranges()}var Ec={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaClear:function(t){this.clear(t)}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={key:this.settings.key||"brush-area-dir"}},beforeRender:function(t){this.rect=t.size.computedInner},render:function(t){var e=this;this.state.rect=this.rect;var n=this.settings.settings,r="vertical"===n.direction?gc:1,i=this.state.rect[r===gc?"height":"width"],a=this.renderer.element().getBoundingClientRect(),o=(n.target?n.target.components||[n.target.component]:[]).map(function(t){return e.chart.component(t)}).filter(function(t){return!!t&&!!t.rect}),s=o[0]?o.slice(1).reduce(function(t,e){return{x0:Math.min(t.x0,e.rect.x),y0:Math.min(t.y0,e.rect.y),x1:Math.max(t.x1,e.rect.x+e.rect.width),y1:Math.max(t.y1,e.rect.y+e.rect.height)}},{x0:o[0].rect.x,y0:o[0].rect.y,x1:o[0].rect.x+o[0].rect.width,y1:o[0].rect.y+o[0].rect.height}):null;return this.state.targetRect=s?{x:s.x0-this.rect.x,y:s.y0-this.rect.y,width:s.x1-s.x0,height:s.y1-s.y0}:null,this.state.style=this.style,this.state.chart=this.chart,this.state.direction=r,this.state.settings=n,this.state.offset=a,this.state.rc=Na(),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.size=i,this.state.cssCoord={offset:this.state.direction===gc?"top":"left",coord:this.state.direction===gc?"y":"x",pos:this.state.direction===gc?"deltaY":"deltaX",area:this.state.direction===gc?"height":"width"},this.state.format=function(t,e){return function(t,e,n){var r=Math.min.apply(Math,I(n)),i=Math.max.apply(Math,I(n)),a={x:t.direction?r+t.rect.x:t.rect.x,y:t.direction?t.rect.y:r+t.rect.y,width:t.direction?i-r:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:i-r},o=t.chart.shapesAt(a,t.settings.brush);if(0===o.length)return"-";var s=o.reduce(function(n,i){var a=n.bounds,o=i.bounds;return e===r?a[t.cssCoord.coord]<=o[t.cssCoord.coord]?n:i:a[t.cssCoord.coord]+a[t.cssCoord.area]>=o[t.cssCoord.coord]+o[t.cssCoord.area]?n:i}),c=t.settings.brush.components.reduce(function(t,e){return t.key===s.key?t:e});return"function"==typeof t.settings.bubbles.label?t.settings.bubbles.label(s.data):Array.isArray(c.data)&&c.data.length?s.data[c.data[0]].label:s.data&&s.data.label?s.data.label:"-"}(this,t,e)},[]},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,a=t.targetSize;if(!e.started){var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(o,s);r.element().contains(c)||(c=null);var u={started:!0};e.offset=r.element().getBoundingClientRect(),e.ranges=i(e);var l=o-e.offset.left,h=s-e.offset.top,f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],p=d,g=f;u.start=f,u.current=d;var y,v,m=e.ranges,x=kc(e),b=-1;if(c&&c.hasAttribute("data-idx"))b=parseInt(c.getAttribute("data-idx"),10),x.min=b>0?m[b-1].max:x.min,x.max=b+1<m.length?m[b+1].min:x.max;else{for(y=0;y<m.length;y++){if(m[y].min<=g&&g<=m[y].max){b=y,x.min=y?m[y-1].max:x.min,x.max=y+1<m.length?m[y+1].min:x.max;break}if(g<m[y].min){x.max=m[y].min,x.min=y?m[y-1].max:x.min;break}}-1===b&&m.length&&y>=m.length&&(x.min=m[m.length-1].max)}if(-1!==b||e.multi||(u.ranges=[],x.min=0,x.max=e.direction?e.rect.width:e.rect.height),-1!==b)if(v={idx:b,start:m[b].min,end:m[b].max,limitLow:x.min,limitHigh:x.max,mode:"move"},c&&c.hasAttribute("data-other-value"))u.start=parseFloat(c.getAttribute("data-other-value")),v.mode="modify";else{var w=v.start,k=v.end;Math.abs(f-w)<=a?(u.start=v.end,v.mode="modify"):Math.abs(f-k)<=a&&(u.start=v.start,v.mode="modify")}else v={idx:-1,start:g,end:p,limitLow:x.min,limitHigh:x.max,mode:"current"};u.active=v,"modify"!==v.mode&&e.targetRect&&!Bo(e.targetRect,{x:l,y:h})||Object.keys(u).forEach(function(t){return e[t]=u[t]})}}({e:t,state:this.state,renderer:this.renderer,ranges:Tc,targetSize:pc})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t);var n=kc(t);Mc(t,t.current,n)}(this.state,Tc),Oc(this.state))},move:function(t){this.state.started&&(!function(t,e){var n=e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset];t.current=Math.max(Math.min(n,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=xc(t);e[t.active.idx].min=t.active.start+n,e[t.active.idx].max=t.active.end+n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});t.rc.set(e);var r=[];e.forEach(function(e){r.push.apply(r,I(function(t,e){var n={x:t.direction?e.min+t.rect.x:t.rect.x,y:t.direction?t.rect.y:e.min+t.rect.y,width:t.direction?e.max-e.min:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:e.max-e.min};return t.chart.shapesAt(n,t.settings.brush)}(t,e)))}),function(t,e){t.chart.brushFromShapes(e,t.settings.brush)}(t,r)}(this.state),Oc(this.state))},clear:function(){this.state.rc&&this.state.rc.clear(),this.state.renderer.render([])}};function Dc(t){var e="vertical"===t.direction,n=t.rect[e?"height":"width"],r=t.rect[e?"width":"height"];return function(t){var e=t.brush;if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map(function(t){return t.id()}),i=e.brushes().filter(function(t){return"range"===t.type&&-1!==r.indexOf(t.id)})[0];return i?i.brush.ranges():[]}(t).map(function(i){var a=t.scale(i.min)*n,o=t.scale(i.max)*n,s=Math.min(a,o),c=Math.abs(a-o);return{type:"rect",fill:t.fill,opacity:t.opacity,x:e?0:s,width:e?r:c,y:e?s:0,height:e?c:r}})}function zc(t,e,n,r){function i(){!function(t){t.renderer.render(Dc(t))}(t)}function a(){!function(t){t.renderer.render(Dc(t))}(t)}function o(){!function(t){t.renderer.render(Dc(t))}(t)}t.brush=e,e&&(e.on("start",i),e.on("update",a),e.on("end",o),t.start=i,t.update=a,t.end=o,t.brush=e,t.scale=n,t.renderer=r)}function jc(t){t.brush&&(t.brush.removeListener("start",t.start),t.brush.removeListener("update",t.update),t.brush.removeListener("end",t.end)),t.start=void 0,t.update=void 0,t.end=void 0,t.brush=void 0,t.scale=void 0,t.renderer=void 0}var qc={require:["chart","settings","renderer"],defaultSettings:{settings:{}},preferredSize:function(){return 50},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(){var t=this.settings.settings,e=this.chart.brush(t.brush),n=t.direction||"horizontal",r="horizontal"===n?this.rect.width:this.rect.height,i=Xa(this.chart.scale(t.scale),r);return jc(this.state),zc(this.state,e,i,this.renderer),this.state.rect=this.rect,this.state.fill=t.fill||"#ccc",this.state.opacity=void 0!==t.opacity?t.opacity:1,this.state.direction=n,Dc(this.state)},beforeDestroy:function(){jc(this.state)}};function Pc(t,e){var n=e.center.x,r=e.center.y;return{x:n-t.left,y:r-t.top}}function Ic(t,e,n){return ho(t,e.points[0])<Math.pow(n.settings.snapIndicator.threshold,2)}function Fc(t,e){null==t.path.d?t.path.d="M".concat(e.x," ").concat(e.y," "):t.path.d+="L".concat(e.x," ").concat(e.y," "),t.points.push(e)}function Lc(t){var e=t.state,n=t.start,r=void 0===n?null:n,i=t.end,a=void 0===i?null:i;null!==r&&(e.snapIndicator.x1=r.x,e.snapIndicator.y1=r.y),null!==a&&(e.snapIndicator.x2=a.x,e.snapIndicator.y2=a.y)}function Bc(t,e){t.snapIndicator.visible=e}var Wc={require:["chart","renderer","settings"],defaultSettings:{displayOrder:0,settings:{brush:{components:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.5},lasso:{fill:"transparent",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:"20, 10"},startPoint:{r:10,fill:"green",stroke:"black",strokeWidth:1,opacity:1}}},on:{lassoStart:function(t){this.start(t)},lassoEnd:function(t){this.end(t)},lassoMove:function(t){this.move(t)},lassoCancel:function(){this.cancel()}},created:function(){this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}}},start:function(t){var e,n,r,i;this.state.active=!0,this.state.path={visible:!0,type:"path",d:null,fill:(e=this.settings.settings.lasso).fill,stroke:e.stroke,strokeWidth:e.strokeWidth,opacity:e.opacity,strokeDasharray:e.strokeDasharray,collider:{type:null}},this.state.snapIndicator=function(t){return{visible:!1,type:"line",x1:0,y1:0,x2:0,y2:0,strokeDasharray:t.strokeDasharray,stroke:t.stroke,strokeWidth:t.strokeWidth,opacity:t.opacity,collider:{type:null}}}(this.settings.settings.snapIndicator),this.state.startPoint=function(t){return{visible:!0,type:"circle",cx:0,cy:0,r:t.r,fill:t.fill,opacity:t.opacity,stroke:t.stroke,strokeWidth:t.strokeWidth,collider:{type:null}}}(this.settings.settings.startPoint),this.state.rendererBounds=this.renderer.element().getBoundingClientRect(),this.state.componentDelta=(n=this.chart,r=this.state.rendererBounds,i=n.element.getBoundingClientRect(),{x:r.left-i.left,y:r.top-i.top}),this.state.brushConfig=this.settings.settings.brush.components.map(function(t){return{key:t.key,contexts:t.contexts||["lassoBrush"],data:t.data||[""],action:t.action||"add"}});var a=Pc(this.state.rendererBounds,t);Fc(this.state,a),Lc({state:this.state,start:a}),function(t,e){t.startPoint.cx=e.x,t.startPoint.cy=e.y}(this.state,a)},move:function(t){if(this.state.active){var e,n,r,i=Pc(this.state.rendererBounds,t);Ic(i,this.state,this.settings)?Bc(this.state,!0):Bc(this.state,!1),Fc(this.state,i),Lc({state:this.state,end:i}),e=this.state,n=this.renderer,r=[e.startPoint,e.path,e.snapIndicator].filter(function(t){return t.visible}),n.render(r),function(t,e){if(t.active){var n=t.points[t.points.length-2],r=t.points[t.points.length-1];t.lineBrushShape.x1=n.x+t.componentDelta.x,t.lineBrushShape.y1=n.y+t.componentDelta.y,t.lineBrushShape.x2=r.x+t.componentDelta.x,t.lineBrushShape.y2=r.y+t.componentDelta.y;var i=e.shapesAt(t.lineBrushShape,{components:t.brushConfig});e.brushFromShapes(i,{components:t.brushConfig})}}(this.state,this.chart)}},end:function(t){this.state.active&&(Bc(this.state,!1),Ic(Pc(this.state.rendererBounds,t),this.state,this.settings)&&function(t,e){if(t.active){var n=t.componentDelta.x,r=t.componentDelta.y,i=t.points.map(function(t){return{x:t.x+n,y:t.y+r}}),a=e.shapesAt({vertices:i},{components:t.brushConfig});e.brushFromShapes(a,{components:t.brushConfig})}}(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach(function(t){t.contexts.forEach(function(t){e.brush(t).end()})}),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},render:function(){}};function Vc(t,e,n,r,i){for(var a,o=0,s=e.length-1;o<s;){var c=Math.floor((o+s)/2);(a=i(e[c]))[n]+a[r]<t[n]?o=c+1:s=c}return o}function Hc(t){var e=t.orientation,n=t.targetNodes,r=t.labels,i=t.container,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vc,o=[],s="v"===e?"x":"y",c="v"===e?"width":"height",u=function(t){return t.textBounds},l=function(t){return t.node.localBounds};return function(t,e){var h=r[e],f=h.textBounds,d=h.node;if(!Co(f,i))return!1;for(var p=a(f,o,s,c,u);p<o.length;p++)if(Lo(f,o[p].textBounds))return!1;for(var g=a(f,n,s,c,l),y=f[s]+f[c],v=g;v<n.length;v++){var m=n[v].node;if(y<m.localBounds[s])break;if(Lo(f,m.localBounds)&&d!==m)return!1}return o.push(r[e]),!0}}var Uc=1.5,$c=4;function Yc(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function Xc(t){var e=_(t);return("string"===e||"number"===e)&&""!==t}function Kc(t,e,n){var r={type:"text",text:e,maxWidth:n.rotate?t.height:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:n.rotate?"end":"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(!n.overflow&&(t.width<n.fontSize||t.height<i.height))return!1;if(n.rotate){if(n.overflow&&t.width<i.height)r.x=t.x+t.width/2,r.dx=.35*n.fontSize;else{var a=Math.max(0,t.width-i.height/(.8*Uc));r.x=t.x+i.height/Uc+n.align*a}var o=Math.max(0,t.height-i.width);r.y=t.y+n.justify*o,r.transform="rotate(-90, ".concat(r.x+r.dx,", ").concat(r.y+r.dy,")")}else{if(n.overflow&&t.height<i.height)r.y=t.y+t.height/2,r.dy=.35*n.fontSize;else{var s=Math.max(0,t.height-i.height/(.8*Uc));r.y=t.y+i.height/Uc+n.justify*s}var c=Math.max(0,t.width-i.width);r.x=t.x+n.align*c}return r}function Gc(t){var e=t.bar,n=t.view,r=t.direction,i=t.position,a=t.padding,o=void 0===a?$c:a,s={};if(k(s,e),i&&"inside"!==i)if("up"===r||"down"===r){var c=Math.max(0,Math.min(e.y,n.height)),u=Math.max(0,Math.min(e.y+e.height,n.height));"outside"===i&&"up"===r||"opposite"===i&&"down"===r?(s.y=0,s.height=c):("outside"===i&&"down"===r||"opposite"===i&&"up"===r)&&(s.y=u,s.height=n.height-u)}else{var l=Math.max(0,Math.min(e.x,n.width)),h=Math.max(0,Math.min(e.x+e.width,n.width));"outside"===i&&"left"===r||"opposite"===i&&"right"===r?(s.x=0,s.width=l):("outside"===i&&"right"===r||"opposite"===i&&"left"===r)&&(s.x=h,s.width=n.width-h)}else;return function(t,e){var n=Math.max(0,Math.min(t.y,e.height)),r=Math.max(0,Math.min(t.y+t.height,e.height)),i=Math.max(0,Math.min(t.x,e.width)),a=Math.max(0,Math.min(t.x+t.width,e.width));t.x=i,t.width=a-i,t.y=n,t.height=r-n}(s,n),function(t,e){t.x+=e,t.width-=2*e,t.y+=e,t.height-=2*e}(s,o),s}function Zc(t){var e,n,r,i,a,o=t.direction,s=t.fitsHorizontally,c=t.measured,u=t.node,l=t.orientation,h=t.placementSettings,f=t.rect,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gc,p=[];for(a=0;a<h.length;a++){if(r=h[a],i=d({bar:u.localBounds,view:f,direction:o,position:r.position}),p.push(i),e=!a||i.height>e.height?i:e,"v"===l&&(s&&i.height>c.height*Uc||!s&&i.height>c.width)){n=i;break}if("h"===l&&i.height>c.height&&i.width>c.width){n=i;break}}return n||(n=e,a=p.indexOf(n)),{bounds:n,placement:r=h[a]}}function Jc(t,e,n,r){var i=t.x+t.dx,a=t.y+t.dy,o=n?e.width:Math.min(e.width,r.width),s=n?Math.min(e.height,r.height):e.height,c={x:i-$c-.1,y:a-s-$c-.1,width:o+2*$c-.1,height:s+2*$c-.1};if(n){var u={x:i-s/2,y:a-s/2};return Y($(c).map(function(t){return go(t,io(-90),u)}))}return c}function Qc(t){for(var e,n,r,i,a,o,s,c,u,l,h,f,d,p=t.chart,g=t.targetNodes,y=t.rect,v=t.fitsHorizontally,m=t.collectiveOrientation,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zc,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kc,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hc,k=[],M={container:y,targetNodes:g,labels:[],orientation:m},_=0,S=g.length;_<S;_++){o=null,f=Yc(r=(n=g[_]).node,p),d="left"===(u=n.direction)||"right"===u?"h":"v";for(var R=0;R<n.texts.length;R++)if(Xc(i=n.texts[R])){var A=x({direction:u,fitsHorizontally:v,lblStngs:l=n.labelSettings[R],measured:c=n.measurements[R],node:r,orientation:d,placements:l.placements,placementSettings:n.placementSettings[R],rect:y});if(o=A.bounds,h=A.placement,o&&h){a=h.justify,s="function"==typeof h.fill?h.fill(f,_):h.fill;var C="function"==typeof l.linkData?l.linkData(f,_):void 0,N="function"==typeof h.overflow?h.overflow(f,_):h.overflow;"up"===u&&(a=1-a),"opposite"===h.position&&(a=1-a),"left"===u&&(a=1-a);var O=!("h"===m||v);(e=b(o,i,{fill:s,justify:"h"===d?h.align:a,align:"h"===d?a:h.align,fontSize:l.fontSize,fontFamily:l.fontFamily,textMetrics:c,rotate:O,overflow:!!N}))&&(void 0!==C&&(e.data=C),k.push(e),M.labels.push({node:r,textBounds:Jc(e,c,O,o)}))}}}return k.filter(w(M))}function tu(t){var e=2*Math.PI;return(t%e+e)%e}function eu(t){return{x:t.x,y:t.y-t.height/2,width:t.width,height:t.height}}function nu(t,e,n){var r=e.x,i=e.y;if(r*r+i*i>t*t)return null;var a=Math.sin(n),o=Math.cos(n),s=r*o-i*a,c=t*t-s*s;if(c<0)return null;var u=Math.sqrt(c);return{x:s*o+a*u,y:-s*a+o*u}}function ru(t){var e=t.slice,n=t.padding,r=t.measured,i=e.start,a=e.end,o=e.innerRadius,s=e.outerRadius,c=tu((i+a)/2),u=function(t){var e,n,r=t.radius,i=t.size,a=t.angle,o=i.width,s=i.height,c={x:o/2,y:s/2};switch(Math.floor(a/(Math.PI/2))){case 0:if(!(e=nu(r,c,a)))return null;e.y*=-1,n={x:-o,y:0};break;case 1:if(!(e=nu(r,c,Math.PI-a)))return null;n={x:-o,y:-s};break;case 2:if(!(e=nu(r,c,a-Math.PI)))return null;e.x*=-1,n={x:0,y:-s};break;case 3:if(!(e=nu(r,c,2*Math.PI-a)))return null;e.x*=-1,e.y*=-1,n={x:0,y:0};break;default:throw new Error("invalid angle")}return{x:e.x+n.x,y:e.y+n.y,width:o,height:s}}({radius:s,size:{width:r.width+2*n,height:r.height+2*n},angle:c});return u?(u.baseline="top",Wo(u,{x1:0,y1:0,x2:Math.sin(i)*s,y2:-Math.cos(i)*s})?null:Wo(u,{x1:0,y1:0,x2:Math.sin(a)*s,y2:-Math.cos(a)*s})?null:zo({cx:0,cy:0,r:o},u)?null:(function(t,e){t.x+=e,t.width-=2*e,t.y+=e,t.height-=2*e}(u,n),u)):null}function iu(t){var e=t.slice,n=t.measured,r=t.padding,i=e.start,a=e.end,o=e.innerRadius,s=e.outerRadius,c=s-o-2*r,u=a-i;if(u<Math.PI){var l=(n.height/2+r)/Math.tan(u/2);l>o&&(c=s-l-2*r)}if(c<0)return null;var h=tu((i+a)/2),f=s-r,d={x:Math.sin(h)*f,y:-Math.cos(h)*f,width:c,height:n.height};return h<Math.PI?(d.angle=h-Math.PI/2,d.anchor="end"):(d.angle=h+Math.PI/2,d.anchor="start"),d}function au(t){var e=t.context,n=t.node,r=t.bounds,i=n.desc.slice,a=tu((i.start+i.end)/2);switch(Math.floor(a/(Math.PI/2))){case 0:e.q1maxY=r.y-2,void 0===e.q2minY&&(e.q2minY=r.y+r.height+2);break;case 1:e.q2minY=r.y+r.height+2;break;case 2:e.q3minY=r.y+r.height+2;break;case 3:e.q4maxY=r.y-2,void 0===e.q3minY&&(e.q3minY=r.y+r.height+2)}}function ou(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function su(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:t.x,y:t.y+("top"===t.baseline?t.height/2:0),fill:n.fill,anchor:t.anchor||"start",baseline:"middle",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily};if(!isNaN(t.angle)){var i=t.angle*(360/(2*Math.PI));r.transform="rotate(".concat(i,", ").concat(r.x,", ").concat(r.y,")")}return r}function cu(t){var e,n,r=t.slice,i=t.direction,a=t.position,o=t.padding,s=t.measured,c=t.view,u=t.context,l=r.start,h=r.end,f=r.innerRadius,d=r.offset;switch(a){case"into":e="rotate"===i?iu({slice:r,measured:s,padding:o}):ru({slice:r,measured:s,padding:o});break;case"inside":n={start:l,end:h,innerRadius:0,outerRadius:f},e="rotate"===i?iu({slice:n,measured:s,padding:o}):ru({slice:n,measured:s,padding:o});break;case"outside":e="rotate"===i?function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,a=e.start,o=e.end,s=e.outerRadius,c=e.offset,u=s+r,l=o-a;if(l<Math.PI&&(n.height/2+r)/Math.tan(l/2)>u)return null;var h=tu((a+o)/2),f=Math.sin(h)*u,d=-Math.cos(h)*u,p=n.width,g=h%Math.PI;if(g>Math.PI/2&&(g=Math.PI-g),Math.cos(g)>.001){var y=d<0?i.y:i.y+i.height,v=Math.abs(y-c.y)/Math.cos(g)-Math.tan(g)*(n.height/2)-2*r-s;v<p&&(p=v)}if(Math.sin(g)>.001){var m=f<0?i.x:i.x+i.width,x=Math.abs(m-c.x)/Math.sin(g)-n.height/2/Math.tan(g)-2*r-s;x<p&&(p=x)}if(p<=0)return 0;var b={x:f,y:d,width:p,height:n.height};return h<Math.PI?(b.angle=h-Math.PI/2,b.anchor="start"):(b.angle=h+Math.PI/2,b.anchor="end"),b}({slice:r,measured:s,padding:o,view:c}):function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,a=t.context,o=e.start,s=e.end,c=e.outerRadius,u=e.offset,l=tu((o+s)/2);if(function(t,e,n){switch(e){case 0:return t.q1maxY<0;case 1:return t.q2minY>n.height;case 2:return t.q3minY>n.height;case 3:return t.q4maxY<0;default:return!0}}(a,Math.floor(l/(Math.PI/2)),i))return null;var h=c+r+n.height/2,f=Math.sin(l)*h,d=-Math.cos(l)*h,p=n.width;if(l<Math.PI){var g=Math.abs(i.x+i.width-(f+u.x));g<p&&(p=g)}else{var y=Math.abs(i.x-(f+u.x));y<p&&(p=y)}var v={x:f,y:d,width:p,height:n.height};return l<Math.PI?v.anchor="start":v.anchor="end",v}({slice:r,measured:s,padding:o,view:c,context:u});break;default:throw new Error("not implemented")}return e&&(e.x+=d.x,e.y+=d.y,"outside"===a&&"rotate"!==i&&function(t,e,n){var r=n.start,i=n.end,a=n.offset,o=n.outerRadius,s=tu((r+i)/2);switch(Math.floor(s/(Math.PI/2))){case 0:if(void 0!==e.q1maxY){var c=Math.min(t.y,e.q1maxY-t.height),u=t.y-c;if(t.y=c,u>1){var l=o+2;t.line={type:"line",x1:t.x-2,y1:t.y+2,x2:a.x+Math.sin(s)*l,y2:a.y-Math.cos(s)*l,strokeWidth:1}}}break;case 1:if(void 0!==e.q2minY){var h=Math.max(t.y,e.q2minY),f=h-t.y;if(t.y=h,f>1){var d=o+2;t.line={type:"line",x1:t.x-2,y1:t.y-2,x2:a.x+Math.sin(s)*d,y2:a.y-Math.cos(s)*d,strokeWidth:1}}}break;case 2:if(void 0!==e.q3minY){var p=Math.max(t.y,e.q3minY),g=p-t.y;if(t.y=p,g>1){var y=o+2;t.line={type:"line",x1:t.x+2,y1:t.y-2,x2:a.x+Math.sin(s)*y,y2:a.y-Math.cos(s)*y,strokeWidth:1}}}break;case 3:if(void 0!==e.q4maxY){var v=Math.min(t.y,e.q4maxY-t.height),m=t.y-v;if(t.y=v,m>1){var x=o+2;t.line={type:"line",x1:t.x+2,y1:t.y+2,x2:a.x+Math.sin(s)*x,y2:a.y-Math.cos(s)*x,strokeWidth:1}}}}}(e,u,r)),e}function uu(t){for(var e=t.context,n=t.direction,r=t.measured,i=t.node,a=t.placementSettings,o=t.rect,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cu,c=0;c<a.length;c++){var u=a[c],l=s({context:e,slice:i.desc.slice,view:o,direction:n,position:u.position,measured:r,padding:u.padding});if(l)return{bounds:l,placement:u}}return{bounds:null,placement:null}}var lu=1.2,hu=.9;function fu(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function du(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(t.width<n.fontSize)return!1;var a=Math.max(0,t.width-i.width);return r.x=t.x+n.align*a,r.y=t.y+i.height/lu,r}function pu(t){return{type:"circle",bounds:{cx:t.cx,cy:t.cy,r:t.r}}}function gu(t){return t.desc&&t.desc.slice?function(t){var e=t.start,n=t.end,r=t.innerRadius,i=t.outerRadius,a=t.offset;if(Math.abs(e+2*Math.PI-n)>1e-12)return{type:null,bounds:null};var o=0!==r?r:i;return pu({cx:a.x,cy:a.y,r:o})}(t.desc.slice):"circle"===t.type?pu(t.attrs):"rect"===t.type?{type:"rect",bounds:t.bounds}:{type:null,bounds:null}}var yu={bar:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,a=t.renderer,o=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qc,c=k({fontSize:12,fontFamily:"Arial",align:.5,justify:0,fill:"#333"},o.label);c.fontSize=parseInt(c.fontSize,10);var u=e.labels.map(function(t){return k({},c,e,t)}),l=e.labels.map(function(t){return t.placements.map(function(n){return k({},c,e,t,n)})}),h=function(t){for(var e,n,r,i,a,o,s,c=t.nodes,u=t.rect,l=t.chart,h=t.labelSettings,f=t.placementSettings,d=t.settings,p=t.renderer,g={},y=[],v=!0,m=!1,x=0;x<c.length;x++)if(Lo(i=(n=c[x]).localBounds,u)){var b=Yc(n,l);e={node:n,texts:[],measurements:[],labelSettings:[],placementSettings:[]};for(var w=0;w<h.length;w++)Xc(r="function"==typeof(o=h[w]).label?o.label(b,x):void 0)&&(s="function"==typeof d.direction?d.direction(b,x):d.direction||"up",m=m||"left"===s||"right"===s,g.fontFamily=o.fontFamily,g.fontSize="".concat(o.fontSize,"px"),g.text=r,a=p.measureText(g),e.measurements.push(a),e.texts.push(r),e.labelSettings.push(o),e.placementSettings.push(f[w]),e.direction=s,v=v&&a.width<=i.width-2*$c);y.push(e)}return{targetNodes:y,fitsHorizontally:v,hasHorizontalDirection:m}}({nodes:r,chart:n,renderer:a,settings:e,rect:i,labelSettings:u,placementSettings:l}),f=h.fitsHorizontally,d=h.hasHorizontalDirection,p=h.targetNodes,g=d?"y":"x",y=d?"height":"width";return p.sort(function(t,e){return t.node.localBounds[g]+t.node.localBounds[y]-(e.node.localBounds[g]+e.node.localBounds[y])}),s({chart:n,targetNodes:p,stngs:e,rect:i,fitsHorizontally:f,collectiveOrientation:d?"h":"v"})},slice:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,a=t.renderer,o=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uu,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:su,u=k({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,position:"into"},o.label);u.fontSize=parseInt(u.fontSize,10);var l=e.labels.map(function(t){return k({},u,e,t)}),h=e.labels.map(function(t){return t.placements.map(function(n){return k({},u,e,t,n)})}),f={},d=[];r=function(t){for(var e=[],n=[],r=[],i=[],a=0;a<t.length;++a){var o=t[a].desc.slice,s=tu((o.start+o.end)/2);switch(Math.floor(s/(Math.PI/2))){case 0:e.push(t[a]);break;case 1:n.push(t[a]);break;case 2:r.push(t[a]);break;case 3:i.push(t[a])}}var c=function(t,e){return tu((t.desc.slice.start+t.desc.slice.end)/2)-tu((e.desc.slice.start+e.desc.slice.end)/2)},u=function(t,e){return c(e,t)};return e.sort(u),n.sort(c),r.sort(u),i.sort(c),e.concat(n,i,r)}(r);for(var p={},g=0,y=r.length;g<y;g++)for(var v=r[g],m=ou(v,n),x=0;x<l.length;x++){var b=l[x],w="function"==typeof b.label?b.label(m,g):"";if(w){var M="function"==typeof b.direction?b.direction(m,g):b.direction||"horizontal",_="function"==typeof b.linkData?b.linkData(m,g):void 0;f.fontFamily=b.fontFamily,f.fontSize="".concat(b.fontSize,"px"),f.text=w;var S=a.measureText(f),R=s({context:p,direction:M,lblStngs:b,measured:S,node:v,placementSettings:h[x],rect:i}),A=R.bounds,C=R.placement;if(A&&C){if("outside"===C.position&&"rotate"!==M&&(au({context:p,node:v,bounds:A}),!Co(eu(A),i)))continue;var N="function"==typeof C.fill?C.fill(m,g):C.fill,O=c(A,w,{fill:N,fontSize:b.fontSize,fontFamily:b.fontFamily,textMetrics:S});O&&(void 0!==_&&(O.data=_),d.push(O),A.line&&(A.line.stroke=N,d.push(A.line)))}}}return d},rows:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.renderer,a=t.style,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:du,s=k({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,align:.5,justify:.5},a.label);s.fontSize=parseInt(s.fontSize,10);for(var c=k({},s,e),u=e.labels.map(function(t){return k({},c,t)}),l={},h=[],f=0,d=r.length;f<d;f++){var p=r[f],g=fu(p,n),y=gu(p),v=y.type,m=y.bounds;if(m){var x=0,b=[],w=[],M="circle"===v?2*m.r*hu:m.height;x+=c.padding;var _=void 0;for(_=0;_<u.length;_++){var S=u[_],R="function"==typeof S.label?S.label(g,f):"";l.fontFamily=S.fontFamily,l.fontSize="".concat(S.fontSize,"px"),l.text=R;var A=i.measureText(l);if((x+=A.height+S.padding)>M)break;w.push(R),b.push(A)}var C=_,N=Math.max(0,M-x),O=void 0;for(O="circle"===v?m.cy-m.r*hu:m.y,O+=c.justify*N+c.padding,_=0;_<C;_++){var T=u[_],E=void 0;if("circle"===v){var D=Math.max(Math.abs(O-m.cy),Math.abs(O+b[_].height-m.cy)),z=Math.sqrt(m.r*m.r-D*D);E={x:m.cx-z+c.padding,y:O,width:2*z-2*c.padding,height:b[_].height}}else E={x:m.x+c.padding,y:O,width:m.width-2*c.padding,height:b[_].height};O+=b[_].height+c.padding;var j="function"==typeof T.fill?T.fill(g,f):T.fill,q="function"==typeof T.linkData?T.linkData(g,f):void 0,P=o(E,w[_],{fill:j,align:T.align,fontSize:T.fontSize,fontFamily:T.fontFamily,textMetrics:b[_]});P&&(void 0!==q&&(P.data=q),h.push(P))}}}return h}};var vu={require:["chart","renderer","settings"],defaultSettings:{settings:{},style:{label:"$label"}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(){var t=this,e=this.settings.settings,n=[];return(e.sources||[]).forEach(function(e){e.strategy&&yu[e.strategy.type]&&e.component&&n.push.apply(n,I(function(t,e){var n=t.chart,r=t.source,i=t.rect,a=t.renderer,o=t.style;if(!n.component(r.component))return[];var s=n.findShapes(r.selector).filter(function(t){return t.key===r.component});return e({chart:n,settings:r.strategy.settings,nodes:s,rect:{x:0,y:0,width:i.width,height:i.height},renderer:a,style:o})}({chart:t.chart,rect:t.rect,renderer:t.renderer,source:e,style:t.style},yu[e.strategy.type])))}),n}};var mu={layout:{size:1,direction:"ltr",scrollOffset:0},item:{show:!0,justify:.5,align:.5,label:{fontSize:"12px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:136,lineHeight:1.2},shape:{type:"square",size:12}},title:{show:!0,text:void 0,anchor:"start",fontSize:"16px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:156,lineHeight:1.25},navigation:{button:{class:void 0,content:void 0}}};function xu(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=t.item,a=t.globalMetrics,o=t.symbolFn,s=void 0===o?mo:o,c=t.direction,u=void 0===c?"ltr":c,l=i.label.displayObject,h=i.label.bounds,f=i.symbol.meta,d="rtl"===u,p={x:d?n+a.maxLabelBounds.width:n+a.maxSymbolSize+a.spacing,y:r,width:a.maxLabelBounds.width,height:Math.max(a.maxSymbolSize,a.maxLabelBounds.height)},g=function(t,e,n){var r=Math.max(0,t.width-e),i=Math.max(0,t.height-e);return{x:t.x+e/2+n.align*r,y:t.y+e/2+n.justify*i}}({x:d?n+a.maxLabelBounds.width+a.spacing:n,y:r,width:a.maxSymbolSize,height:p.height},f.size,{align:void 0===f.align?.5:f.align,justify:void 0===f.justify?.5:f.justify}),y=s(k({},f,g));return delete y.collider,l.anchor=d?"end":"start",function(t,e,n){var r=n.textMetrics;if(t.height<r.height)return!1;var i=Math.max(0,t.width-r.width);e.baseline="hanging";var a=Math.max(0,t.height-r.height);e.x=t.x+n.align*i,e.y=t.y+n.justify*a}(p,l,{textMetrics:h,fontSize:parseInt(l.fontSize,10),align:0,justify:.5}),{item:{type:"container",data:i.label.displayObject.data,children:[y,l],collider:{type:"rect",x:n,y:r,width:a.maxItemBounds.width,height:a.maxItemBounds.height}},metrics:p}}function bu(t,e){var n=t.items.length,r=Math.ceil(n/e),i="horizontal"===t.layout.orientation?"width":"height",a="width"===i?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[i]*r+(r-1)*t.layout.margin[a]}function wu(t,e){var n,r,i,a,o=e.onScroll,s=void 0===o?function(){}:o,c=null,u=0,l={itemize:function(e){n=function(t,e){for(var n,r,i=t.resolved,a=t.dock,o=[],s=i.items.items,c=i.symbols.items,u=i.labels.items,l=0,h=0,f=0,d=0;d<s.length;d++)if(!1!==s[d].show){var p=void 0!==u[d].text?u[d].text:u[d].data.label||"";n=k({},u[d],{type:"text",fontSize:"".concat(parseInt(u[d].fontSize,10),"px"),text:p,title:p}),r={symbol:{meta:c[d]},label:{displayObject:n,bounds:e.textBounds(n)}},o.push(r),l=Math.max(c[d].size,l),h=Math.max(r.label.bounds.width,h),f=Math.max(r.label.bounds.height,f)}return{items:o,globalMetrics:{spacing:8,maxSymbolSize:l,maxItemBounds:{height:Math.max(l,f),width:l+8+h},maxLabelBounds:{width:h,height:f}},layout:{margin:{vertical:void 0!==i.layout.item.vertical?i.layout.item.vertical:8,horizontal:void 0!==i.layout.item.horizontal?i.layout.item.horizontal:8},mode:i.layout.item.mode,size:i.layout.item.size,orientation:"top"===a||"bottom"===a?"horizontal":"vertical",direction:i.layout.item.direction,scrollOffset:i.layout.item.scrollOffset}}}(e,t.renderer),c=null!==c||isNaN(n.layout.scrollOffset)?c:n.layout.scrollOffset},getItemsToRender:function(t){i=t.viewRect,u=l.getContentOverflow(i);var e=l.extent();c=Math.max(0,Math.min(c,u)),a=k({},i);var o="horizontal"===l.orientation()?"x":"y";return a[o]-=c,a["x"===o?"width":"height"]=e,function(t,e,n){for(var r=t.viewRect,i=n.itemized,a=n.create,o=void 0===a?xu:a,s=n.parallels,c=i.layout.direction,u=i.globalMetrics,l=i.items,h="horizontal"===i.layout.orientation,f=0,d=[],p=u.maxItemBounds.height,g=u.maxItemBounds.width,y=i.layout.margin.vertical+p,v=i.layout.margin.horizontal+g,m=e.x,x=e.y,b=r.x-e.x,w=0;w<l.length;w++){var k=o({y:x,x:"rtl"===c?r.x+b+r.width-g-(m-e.x):m,item:l[w],globalMetrics:u,direction:c});if((h&&m>=r.x-g||!h&&x>=r.y-p)&&d.push(k.item),++f>=s?(f=0,h?(m+=v,x=e.y):(x+=y,m=e.x)):h?x+=y:m+=v,!h&&x>r.y+r.height)break;if(h&&m>r.x+r.width)break}return d}(t,a,{itemized:n,parallels:r})},parallelize:function(t,e){return r=function(t,e,n){var r=n.items.length,i="horizontal"===n.layout.orientation?"width":"height",a="width"===i?"horizontal":"vertical",o=n.globalMetrics.maxItemBounds[i]*r+(r-1)*n.layout.margin[a],s=Math.ceil(o/t);if(null!=e){var c="horizontal"===n.layout.orientation?"height":"width",u=Math.floor(e/(4+n.globalMetrics.maxItemBounds[c]));s=Math.min(s,u)}var l=isNaN(n.layout.size)?1:n.layout.size;return Math.max(1,Math.min(s,l))}(t,e,n)},hasContentOverflow:function(){var t="horizontal"===n.layout.orientation?"width":"height";return bu(n,r)>i[t]},getContentOverflow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e="horizontal"===n.layout.orientation?"width":"height";return Math.max(0,bu(n,r)-t[e])},getNextSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},getPrevSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},hasNext:function(){return"horizontal"===l.orientation()?i.x+i.width<a.x+a.width:i.y+i.height<a.y+a.height},hasPrev:function(){return"horizontal"===l.orientation()?a.x<i.x:a.y<i.y},next:function(){l.scroll(-l.getNextSize())},prev:function(){l.scroll(l.getPrevSize())},scroll:function(t){var e=Math.max(0,Math.min(u,c-t));e!==c&&(c=e,s())},offset:function(){return c},orientation:function(){return n.layout.orientation},direction:function(){return n.layout.direction},extent:function(){return bu(n,r)},spread:function(){return function(t,e){var n=e,r="horizontal"===t.layout.orientation?"height":"width",i="width"===r?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[r]*n+(n-1)*t.layout.margin[i]}(n,r)}};return l}function ku(t){return Object.keys(t).filter(function(e){return t[e]}).join(" ")}var Mu={up:"▲",right:"▶",down:"▼",left:"◀"};function _u(t,e){var n=e.size,r=e.isActive,i=e.direction,a=e.nav,o=e.attrs,s={},c="";a&&a.button&&("function"==typeof a.button.class?s=a.button.class({direction:i}):a.button.class&&(s=a.button.class),"function"==typeof a.button.content&&(c=a.button.content(t,{direction:i})));var u={width:"".concat(n,"px"),minWidth:"".concat(n,"px"),height:"".concat(n,"px")};Object.keys(s).length||(u.border="0",u.background="none");var l=o;return r||(l.disabled="disabled"),t("button",k({class:ku(s),style:u},l),[c||t("span",{style:{pointerEvents:"none"}},[Mu[i]])])}function Su(t){var e,n={itemize:function(t){var n,r;r=(n=t).dock,e={layout:{orientation:"top"===r||"bottom"===r?"vertical":"horizontal"},navigation:n.navigation}},render:function(r){return function(t,e,n,r){var i=e.rect,a=e.itemRenderer;if(t&&t.renderArgs){t.size(i);var o=t.renderArgs[0],s="vertical"===n.layout.orientation,c="rtl"===a.direction(),u=a.hasNext(),l=a.hasPrev();if(l||u){var h=s?["right","left"]:["down","up"];c&&s&&h.reverse();var f=[o("div",{style:{position:"relative",display:"flex","flex-direction":s?"column":"row","justify-content":"center",height:"100%",pointerEvents:"auto"},dir:c&&!s?"rtl":"ltr"},[_u(o,{size:32,isActive:u,direction:h[0],attrs:{"data-action":"next","data-component-key":r.settings.key},nav:n.navigation}),_u(o,{size:32,isActive:l,direction:h[1],attrs:{"data-action":"prev","data-component-key":r.settings.key},nav:n.navigation})])];t.render(f)}else t.render([])}}(n.renderer,r,e,t)},extent:function(){return 32},spread:function(){return 64}};return n}function Ru(t){var e,n={itemize:function(n){e=function(t,e){var n=t.resolved;if(!1===n.title.item.show)return null;var r=k({},n.title.item,{type:"text"});if("rtl"===n.layout.item.direction&&(r.anchor&&"start"!==r.anchor?"end"===r.anchor&&(r.anchor="start"):r.anchor="end"),void 0===n.title.settings.text){var i=e.scale.data().fields;r.text=i&&i[0]?i[0].title():""}return{displayObject:r,bounds:e.renderer.textBounds(r)}}(n,t)},render:function(t){!function(t,e,n){var r=t.rect;if(e){var i=[];if(e.size(r),n){var a={start:0,end:r.width,middle:r.width/2};i.push(k({},n.displayObject,{x:a[n.displayObject.anchor]||0,y:0,baseline:"hanging",title:n.displayObject.text}))}e.render(i)}}(t,n.renderer,e)},spread:function(){return e?e.bounds.height:0},extent:function(){return e?e.bounds.width:0}};return n}function Au(t,e,n,r){var i,a,o,s=r.itemRenderer,c=r.navigationRenderer,u=r.titleRenderer,l=r.isPreliminary,h=void 0!==l&&l,f=0,d={x:e.spacing,y:e.spacing,width:t.width-2*e.spacing,height:t.height-2*e.spacing};if(i={x:d.x,y:d.y,width:d.width,height:u.spread()},"horizontal"===n){i={x:d.x,y:d.y,width:u.extent(),height:u.spread()};var p=d.width-i.width-(i.width?e.spacing:0),g=d.height;s.parallelize(p,h?void 0:g);var y=s.extent()>p?c.extent():0,v=s.spread(),m=y?c.spread():0;o={x:(a={x:i.x+i.width+(i.width?e.spacing:0),y:d.y+Math.max(0,(m-v)/2),width:d.width-y-i.width-(y?e.spacing:0)-(i.width?e.spacing:0),height:g}).x+a.width+(y?e.spacing:0),y:d.y,width:y,height:d.height},i.y=a.y,"rtl"===s.direction()&&(o.x=d.x,a.x=o.x+o.width+(o.width?e.spacing:0),i.x=a.x+a.width+(i.width?e.spacing:0)),f=Math.max(i.height,m,s.spread())}else{var x=d.height-i.height-(i.height?e.spacing:0),b=d.width;s.parallelize(x,h?void 0:b);var w=s.extent()>x?c.extent():0;o={x:d.x,y:d.y+d.height-w,width:d.width,height:w},a={x:d.x,y:i.y+i.height+(i.height?e.spacing:0),width:d.width,height:d.height-i.height-(i.height?e.spacing:0)-o.height-(o.height?e.spacing:0)},f=Math.max(u.extent(),w?c.spread():0,s.spread())}return a=k({},t,{x:t.x+a.x,y:t.y+a.y,width:a.width,height:a.height}),o.x+=t.x,o.y+=t.y,i.x+=t.x,i.y+=t.y,{title:k({},t,i),content:k({},t,a),navigation:k({},t,o),orientation:n,preferredSize:f}}function Cu(t){t.state.resolved=function(t){var e=t.scale.domain(),n={items:[]};if("threshold-color"===t.scale.type){var r=t.scale.data().fields[0],i=function(t){return String(t)};t.settings.formatter?i=t.chart.formatter(t.settings.formatter):r&&(i=r.formatter());for(var a=0;a<e.length-1;a++){var o={value:e[a],label:"".concat(i(e[a])," - < ").concat(i(e[a+1]))};r&&(o.source={field:r.id()}),n.items.push(o)}"vertical"==("top"===t.settings.dock||"bottom"===t.settings.dock?"horizontal":"vertical")&&n.items.reverse()}else{var s=t.scale.labels?t.scale.labels():null;n.items=e.map(function(e,n){var r=t.scale.datum?k({},t.scale.datum(e)):{value:e};return t.scale.datum&&((r=k({},t.scale.datum(e))).value=e),t.scale.label?r.label=t.scale.label(e):s&&(r.label=s[n]),r})}var c=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:k(!0,{},mu.title,t.style.title),settings:t.settings.settings.title}),u=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:mu.layout,settings:t.settings.settings.layout}),l=t.resolver.resolve({data:n,defaults:k(!0,{},mu.item.label,t.style.item.label),settings:(t.settings.settings.item||{}).label}),h=k(!0,{},(t.settings.settings.item||{}).shape);void 0===h.fill&&t.settings.scale&&(h.fill={scale:t.settings.scale});var f=t.resolver.resolve({data:n,defaults:k(!0,{},mu.item.shape,t.style.item.shape),settings:h}),d=t.resolver.resolve({data:n,defaults:k(!0,{},{show:mu.item.show}),settings:{show:(t.settings.settings.item||{}).show}});function p(t,n){var r=t.data.value,i=e[n+1];t.data.value=[r,i]}return"threshold-color"===t.scale.type&&("vertical"==("top"===t.settings.dock||"bottom"===t.settings.dock?"horizontal":"vertical")?(d.items.reverse().forEach(p),d.items.reverse()):d.items.forEach(p)),{title:c,labels:l,symbols:f,items:d,layout:u}}(t),t.titleRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center"}),t.itemRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center"}),t.navigationRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center",navigation:t.settings.settings.navigation}),t.state.display={spacing:8}}function Nu(t){var e=t.rect,n=t.settings,r=t.state,i=t.itemRenderer,a=t.navigationRenderer,o=t.titleRenderer,s="top"===n.dock||"bottom"===n.dock?"horizontal":"vertical",c=Au(e,r.display,s,{itemRenderer:i,navigationRenderer:a,titleRenderer:o});t.renderer.size(c.content);var u=i.getItemsToRender({viewRect:k({},c.content,{x:0,y:0})});return a.render({rect:c.navigation,itemRenderer:i}),o.render({rect:c.title}),t.state.views={layout:c},u}var Ou={require:["chart","settings","renderer","update","resolver","registries"],defaultSettings:{settings:{},style:{item:{label:"$label",shape:"$shape"},title:"$title"}},mounted:function(t){t&&t.parentNode&&(this.navigationRenderer.renderer.appendTo(t.parentNode),this.titleRenderer.renderer.appendTo(t.parentNode)),this.navigationRenderer.render({rect:this.state.views.layout.navigation,itemRenderer:this.itemRenderer}),this.titleRenderer.render({rect:this.state.views.layout.title})},beforeUnmount:function(){this.navigationRenderer.renderer.clear(),this.titleRenderer.renderer.clear()},on:{panstart:function(){this.state.interaction.started||this.itemRenderer.getContentOverflow()&&(this.state.interaction.started=!0,this.state.interaction.delta=0)},panmove:function(t){if(this.state.interaction.started){var e="horizontal"===this.itemRenderer.orientation()?("rtl"===this.itemRenderer.direction()?-1:1)*t.deltaX:t.deltaY;this.itemRenderer.scroll(e-this.state.interaction.delta),this.state.interaction.delta=e}},panend:function(){this.state.interaction.started=!1},scroll:function(t){this.itemRenderer.scroll(-t)},next:function(){this.itemRenderer.next()},prev:function(){this.itemRenderer.prev()}},created:function(){var t=this;this.rect={x:0,y:0,width:0,height:0},this.state={interaction:{}},this.onScroll=function(){var e=Nu(t);t.update(e)},this.itemRenderer=wu(this,{onScroll:this.onScroll}),this.navigationRenderer=Su(this),this.titleRenderer=Ru(this),this.navigationRenderer.renderer=this.registries.renderer("dom")(),this.titleRenderer.renderer=this.registries.renderer(this.settings.renderer)(),Cu(this)},preferredSize:function(t){return n=t,r=0,i=(e=this).settings.dock||"center",a="top"===i||"bottom"===i?"horizontal":"vertical",o=e.state.display,s=Au(n.inner,o,a,{itemRenderer:e.itemRenderer,navigationRenderer:e.navigationRenderer,titleRenderer:e.titleRenderer,isPreliminary:!0}),r+=o.spacing,r+=s.preferredSize,r+=o.spacing;var e,n,r,i,a,o,s},beforeUpdate:function(){Cu(this)},beforeRender:function(t){this.rect=t.size},render:function(){return Nu(this)},beforeDestroy:function(){this.navigationRenderer.renderer.destroy(),this.titleRenderer.renderer.destroy()},_DO_NOT_USE_getInfo:function(){return{offset:this.itemRenderer.offset()}}},Tu="legend-cat";function Eu(t,e){var n=0,r=t.state.isVertical?"justify":"align",i=t.state.isVertical?"y":"x",a=t.state.isVertical?"height":"width",o=t.state.isVertical?"requiredHeight":"requiredWidth";n=t.state.rect[a]-t.state.legend.length()-t.state.title[o](),n*=Math.min(1,Math.max(t.stgns[r],0)),e[i]+=n}function Du(t,e,n){var r=n[t];return"object"===_(r)?-1!==r.valid.indexOf(e)?e:r.default:n.default}function zu(t,e){var n={x:0,y:0,width:0,height:0},r=t.stgns.padding;return n.x=r.left,n.y=r.top,n.width=e.width-r.left-r.right,n.height=e.height-r.top-r.bottom,n}function ju(t){var e,n="top"!==t.settings.dock&&"bottom"!==t.settings.dock,r=t.stgns.title,i=t.chart.scale(t.stgns.fill),a=t.chart.scale(t.stgns.major),o=function(t,e){var n=e.domain(),r=n,i=t.stgns.tick.label;return!i&&t.formatter?i=t.formatter:!i&&e.data().fields&&(i=e.data().fields[0].formatter()),"function"==typeof i&&(r=n.map(i).map(String)),n.map(function(n,i){var a=r[i];return{value:n,label:a,pos:e.norm(parseFloat(n,10)),textMetrics:t.renderer.measureText({text:a,fontSize:t.stgns.tick.fontSize,fontFamily:t.stgns.tick.fontFamily})}})}(t,a),s=Du((e=t.settings).dock,e.settings.tick.anchor,{left:{valid:["left","right"],default:"left"},right:{valid:["left","right"],default:"right"},top:{valid:["top","bottom"],default:"top"},bottom:{valid:["top","bottom"],default:"bottom"},default:"right"});if(void 0===r.text){var c=a.data().fields;r.text=c&&c[0]?c[0].title():""}var u=t.renderer.measureText({text:r.text,fontSize:r.fontSize,fontFamily:r.fontFamily}),l=t.renderer.textBounds({text:r.text,fontSize:r.fontSize,fontFamily:r.fontFamily,maxLines:r.maxLines,maxWidth:r.maxLengthPx,wordBreak:r.wordBreak,hyphens:r.hyphens,lineHeight:r.lineHeight}),h={isVertical:n,nodes:[],title:{anchor:function(t){return Du(t.dock,t.settings.title.anchor,{left:{valid:["top"],default:"top"},right:{valid:["top"],default:"top"},top:{valid:["left","right"],default:"left"},bottom:{valid:["left","right"],default:"left"},default:"top"})}(t.settings),textMetrics:u,textBounds:l,requiredWidth:function(){if(!r.show)return 0;var t=l.width,e=r.maxLengthPx;return n||(t+=r.padding,e+=r.padding),Math.min(t,e,h.rect.width)},requiredHeight:function(){if(!r.show)return 0;var t=l.height;return n&&(t+=r.padding),Math.min(t,h.rect.height)}},ticks:{values:o,anchor:s,length:Math.min(Math.max.apply(Math,I(o.map(function(t){return t.textMetrics.width}))),t.stgns.tick.maxLengthPx),requiredHeight:function(){return"top"===s?Math.max.apply(Math,I(h.ticks.values.map(function(t){return t.textMetrics.height})))+t.stgns.tick.padding:0},height:Math.max.apply(Math,I(o.map(function(t){return t.textMetrics.height})))},legend:{fillScale:i,majorScale:a,length:function(){var e=n?"height":"width",r=n?"requiredHeight":"requiredWidth",i=Math.min(h.rect[e],h.rect[e]*t.stgns.length)-h.title[r]();return Math.max(0,Math.min(i,t.stgns.maxLengthPx))}}};return h}var qu={require:["chart","settings","renderer"],defaultSettings:{displayOrder:0,dock:"right",settings:{size:15,length:.5,maxLengthPx:250,align:.5,justify:0,padding:{left:5,right:5,top:5,bottom:5},tick:{label:null,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,anchor:null,padding:5},title:{show:!0,text:void 0,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,padding:5,maxLines:2,wordBreak:"none",lineHeight:1.2,hyphens:"auto",anchor:null}}},preferredSize:function(t){var e=this.state;e.rect=zu(this,t.inner);var n=this.stgns.size,r=e.isVertical?this.stgns.padding.left+this.stgns.padding.right:this.stgns.padding.top+this.stgns.padding.bottom;n+=r;var i=Math.max(t.inner.width,t.inner.height);if("left"===e.ticks.anchor||"right"===e.ticks.anchor){if(e.ticks.values.reduce(function(t,e){return t+e.textMetrics.height},0)>this.state.legend.length())return i;n+=e.ticks.length}else{if(e.ticks.length>this.state.legend.length())return i;n+=Math.max.apply(Math,I(e.ticks.values.map(function(t){return t.textMetrics.height})))}return n+=this.stgns.tick.padding,this.stgns.title.show&&(n="left"===e.title.anchor||"right"===e.title.anchor?Math.max(e.title.textBounds.height+r,n):Math.max(n,e.title.requiredWidth()+r)),this.state.preferredSize=n,n},created:function(){this.stgns=this.settings.settings,this.state=ju(this)},beforeUpdate:function(t){this.stgns=t.settings.settings,this.state=ju(this)},beforeRender:function(t){if(this.state.nodes=[],this.state.rect=zu(this,t.size),this.stgns.title.show){var e=function(t){var e=t.state,n=t.stgns,r="left"===e.ticks.anchor,i="top"===e.ticks.anchor,a=e.rect.x,o=e.rect.y,s="start";"left"===e.title.anchor?(a+=e.title.requiredWidth()-n.title.padding,o+=e.title.textMetrics.height,o+=i?e.rect.height-e.title.textBounds.height:0,s="end"):"right"===e.title.anchor?(a+=e.legend.length(),a+=n.title.padding,o+=e.title.textMetrics.height,o+=i?e.rect.height-e.title.textBounds.height:0):"top"===e.title.anchor&&(a+=r?e.rect.width:0,o+=e.title.textMetrics.height,s=r?"end":"start");var c={tag:"legend-title",type:"text",x:a,y:Math.min(o,e.rect.y+e.rect.height),text:n.title.text,fill:n.title.fill,fontSize:n.title.fontSize,fontFamily:n.title.fontFamily,maxWidth:n.title.maxLengthPx,maxLines:n.title.maxLines,wordBreak:n.title.wordBreak,hyphens:n.title.hyphens,lineHeight:n.title.lineHeight,anchor:s,title:n.title.text};return Eu(t,c),c}(this);this.state.nodes.push(e)}var n,r,i,a=function(t,e){var n=t.state,r=t.stgns,i=n.rect,a=i.x,o=i.y,s=n.isVertical?r.size:n.legend.length(),c=n.isVertical?n.legend.length():r.size;"left"===n.ticks.anchor?a+=n.rect.width-r.size:"top"===n.ticks.anchor&&(o+=n.rect.height-r.size),"top"===n.title.anchor?o+=n.title.requiredHeight():"left"===n.title.anchor&&(a+=n.title.requiredWidth());var u={type:"rect",x:a,y:o,width:s,height:c,fill:{type:"gradient",stops:e,degree:n.isVertical?90:180}};return Eu(t,u),u}(this,(r=(n=this).state.legend.fillScale,i=n.state.legend.majorScale,r.domain().map(function(t){return{type:"stop",color:r(t),offset:Math.min(1,Math.max(0,i.norm(t)))}}).sort(function(t,e){return t.offset-e.offset}))),o={id:"legend-seq-target",type:"container",children:[a,function(t,e){var n=t.state,r=t.stgns,i="start",a={type:"rect",x:e.x,y:e.y,width:n.isVertical?0:e.width,height:n.isVertical?e.height:0,fill:"transparent"};return{type:"container",id:"legend-seq-ticks",children:I(n.ticks.values.map(function(o){var s=0,c=0,u=0;return n.isVertical?(c=e.y+e.height*o.pos,u=1===o.pos?-o.textMetrics.height/5:o.textMetrics.height):s=e.x+e.width*o.pos,"right"===n.ticks.anchor?(s=e.x+r.size+r.tick.padding,a.x=e.x+e.width):"left"===n.ticks.anchor?(s=e.x-r.tick.padding,i="end"):"top"===n.ticks.anchor?(c=e.y-r.tick.padding,u-=.25*o.textMetrics.height,i=0===o.pos?"start":"end"):"bottom"===n.ticks.anchor&&(c=e.y+e.height+r.tick.padding,u=.8*o.textMetrics.height,i=0===o.pos?"start":"end",a.y=e.y+e.height),{type:"text",x:s,y:c,dx:0,dy:u,text:o.label,fontSize:r.tick.fontSize,fontFamily:r.tick.fontFamily,fill:r.tick.fill,maxWidth:n.isVertical?r.tick.maxLengthPx:Math.min(r.tick.maxLengthPx,n.legend.length()/2),anchor:i,textBoundsFn:t.renderer.textBounds,title:o.label}})).concat([a])}}(this,a)]};this.state.nodes.push(o)},render:function(){return this.state.nodes}};var Pu={step:function(t){return new ee(t,.5)},stepAfter:function(t){return new ee(t,1)},stepBefore:function(t){return new ee(t,0)},linear:Et,basis:function(t){return new Lt(t)},cardinal:Vt.tension(0),catmullRom:Ut,monotonex:function(t){return new Gt(t)},monotoney:function(t){return new Zt(t)},natural:function(t){return new Qt(t)}},Iu={coordinates:{minor:.5,major:.5,layerId:0},orientation:"horizontal",layers:{curve:"linear",show:!0,sort:void 0,line:{stroke:"#ccc",strokeWidth:1,strokeLinejoin:"miter",strokeDasharray:void 0,opacity:1,show:!0},area:{fill:"#ccc",opacity:.8,show:!0}}};function Fu(t,e){var n=e.generator,r=e.item,i=e.data,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o={type:"path",d:n(t),opacity:r.opacity,stroke:r.stroke,strokeWidth:r.strokeWidth,strokeLinejoin:r.strokeLinejoin,fill:a||r.fill,data:i};return r.strokeDasharray&&(o.strokeDasharray=r.strokeDasharray),o}function Lu(t){var e=function(t){for(var e=t.data,n=t.stngs,r=t.rect,i=t.resolver,a=t.style,o=r.width,s=r.height,c=i.resolve({data:e,defaults:Iu.coordinates,settings:n.coordinates||{},scaled:{major:"vertical"===n.orientation?s:o,minor:"vertical"===n.orientation?o:s}}),u={},l=0,h=0;h<c.items.length;h++){var f=c.items[h],d=f.layerId;u[d]=u[d]||{order:l++,id:d,items:[],firstPoint:f.data},u[d].items.push(f)}var p=Object.keys(u).map(function(t){return u[t]}),g={items:p.map(function(t){return t.firstPoint})},y=n.layers||{};return{coordinates:c,metaLayers:p,layers:i.resolve({data:g,defaults:{curve:Iu.layers.curve,show:Iu.layers.show},settings:{curve:y.curve,show:y.show}}),lines:i.resolve({data:g,defaults:k({},Iu.layers.line,a.line),settings:y.line}),areas:i.resolve({data:g,defaults:k({},Iu.layers.area,a.area),settings:y.area})}}(t),n=e.metaLayers,r=e.coordinates,i=e.layers,a=e.lines,o=e.areas,s=[];return n.forEach(function(e,n){var c=i.items[n];if(!1!==c.show){c.datum=c.data,c.data=[],c.id=e.id;for(var u,l,h=[],f=[],d=0;d<e.items.length;d++)l=(u=e.items[d]).data,isNaN(u.major)||(t.missingMinor0&&(u.minor0=r.settings.minor.scale?r.settings.minor.scale(l.minor0?l.minor0.value:0):0),isNaN(u.minor)||h.push(u.minor),f.push(u),c.data.push(u.data));var p=h.sort(function(t,e){return t-e})[Math.floor((h.length-1)/2)];s.push({layerObj:c,lineObj:a.items[n],areaObj:o.items[n],median:p,points:f,firstPoint:e.firstPoint})}}),s}var Bu={require:["chart","resolver"],defaultSettings:{style:{area:"$shape",line:"$shape-outline"}},created:function(){},beforeRender:function(t){var e=t.size;this.rect=e},render:function(t){var e=t.data,n=this.rect,r=n.width,i=n.height;this.stngs=this.settings.settings||{};var a=!this.stngs.coordinates||void 0===this.stngs.coordinates.minor0,o=Lu({data:e,stngs:this.stngs,rect:this.rect,resolver:this.resolver,style:this.style,missingMinor0:a});if(this.stngs.layers&&this.stngs.layers.sort){var s=o.map(function(t){return{id:t.layerObj.id,data:t.layerObj.data}});s.sort(this.stngs.layers.sort).map(function(t){return t.id}),o.sort(function(t,e){return s.indexOf(e.layerObj.id)-s.indexOf(t.layerObj.id)})}else o.sort(function(t,e){return t.median-e.median});return function(t,e){var n=e.width,r=e.height,i=e.missingMinor0,a=e.stngs,o=[],s=a.layers||{};return t.forEach(function(t){var e,c,u=t.lineObj,l=t.layerObj,h=t.areaObj,f=t.points,d=jt(),p={size:r,p:"y"},g={size:n,p:"x"};if("vertical"===a.orientation){var y=k(!0,{},g);g=k(!0,{},p),p=k(!0,{},y)}d[g.p](function(t){return t.major*g.size})["".concat(p.p,"1")](function(t){return t.minor*p.size})["".concat(p.p,"0")](function(t){return t.minor0*p.size}).defined(function(t){return"number"==typeof t.minor&&!isNaN(t.minor)}).curve(Pu["monotone"===l.curve?"monotone".concat(g.p):l.curve]),e=d["line".concat(p.p.toUpperCase(),"1")](),c=d["line".concat(p.p.toUpperCase(),"0")](),s.area&&!1!==h.show&&o.push(Fu(f,{data:t.firstPoint,item:h,generator:d})),u&&!1!==u.show&&(o.push(Fu(f,{data:t.firstPoint,item:u,generator:e},"none")),!i&&s.area&&!1!==h.show&&o.push(Fu(f,{data:t.firstPoint,item:u,generator:c},"none")))}),o}(o,{width:r,height:i,missingMinor0:a,stngs:this.stngs})}},Wu="line";function Vu(t,e){var n,r,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"object"===_(e.center)?(n=e.center.x,r=e.center.y):(n=e.clientX,r=e.clientY);var a=n-t.state.boundingRect.left,o=r-t.state.boundingRect.top;return{x:i?Math.max(0,Math.min(a,t.rect.width)):a,y:i?Math.max(0,Math.min(o,t.rect.height)):o}}function Hu(t,e){return{x:e.x+t.rect.x,y:e.y+t.rect.y}}function Uu(t,e){var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return{x:n,y:r,width:Math.max(t.x,e.x)-n,height:Math.max(t.y,e.y)-r}}var $u={require:["chart","renderer"],defaultSettings:{displayOrder:99,settings:{brush:{components:[]}},style:{area:"$selection-area-target"}},on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaCancel:function(){this.cancel()}},created:function(){this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1}},preferredSize:function(){return 0},render:function(){},beforeRender:function(t){var e=t.size;this.rect=e.computedInner},start:function(t){this.state.boundingRect=this.renderer.element().getBoundingClientRect();var e=Vu(this,t,!1);Bo({x:0,y:0,width:this.rect.width,height:this.rect.height},e)&&(this.state.brushConfig=this.settings.settings.brush.components.map(function(t){return{key:t.key,contexts:t.contexts,data:t.data,action:t.action||"set"}}),this.state.start=Vu(this,t),this.state.active=!0)},move:function(t){var e;this.state.active&&(this.state.end=Vu(this,t),function(t){if(t.state.active){var e=Hu(t,t.state.start),n=Hu(t,t.state.end),r=t.chart.shapesAt(Uu(e,n),{components:t.state.brushConfig});t.chart.brushFromShapes(r,{components:t.state.brushConfig})}}(this),(e=this).renderer.render([k({type:"rect"},Uu(e.state.start,e.state.end),e.style.area)]))},end:function(){this.state.active&&(this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach(function(t){Array.isArray(t.contexts)&&t.contexts.forEach(function(t){e.brush(t).end()})}),this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))}};function Yu(t,e,n){var r=n.renderer,i=n.style,a=n.props,o=n.h,s=function(t,e){return{tooltip:"function"==typeof t.tooltipClass?t.tooltipClass({dock:e.dock}):t.tooltipClass,content:"function"==typeof t.contentClass?t.contentClass({dock:e.dock}):t.contentClass,arrow:"function"==typeof t.arrowClass?t.arrowClass({dock:e.dock}):t.arrowClass}}(a,e),c=function(t,e,n,r){return r.content({h:t,style:n,data:e})}(o,t,i,a),u=o("div",{dir:a.direction,class:ku(k({"pic-tooltip":!0},s.tooltip)),style:k({position:"relative",display:"inline-block"},e.computedTooltipStyle)},o("div",{style:i.content,class:ku(k({"pic-tooltip-content":!0},s.content))},c),o("div",{class:ku(k({"pic-tooltip-arrow":!0},s.arrow)),style:k({},i.arrow,i["arrow-".concat(e.dock)],e.computedArrowStyle)}));return r.render(u),r.element().children[0]}function Xu(t){var e=t.defaultDuration,n=t.defaultDelay,r=null,i=null,a=!1,o=function(){var t=function(){},e={pending:[],debounced:[],active:[],cancelled:[],rejected:[],fulfilled:[]};return t.set=function(t){e[t].forEach(function(e){return e(t)})},t.on=function(t,n){Array.isArray(t)?t.forEach(function(t){return e[t].push(n)}):e[t].push(n)},t}(),s=function(){},c=function(){r=null,i=null,a=!1,o.set("fulfilled")};return s.invoke=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;r&&(clearTimeout(r),o.set("debounced")),o.set("pending"),r=setTimeout(function(){t(),a=!0,r=null,o.set("active")},u),s>0&&(i&&clearTimeout(i),i=setTimeout(c,s+Math.max(u,0)))},s.clear=function(){a?o.set("cancelled"):r&&(clearTimeout(r),o.set("rejected")),i&&clearTimeout(i),r=null,i=null,a=!1},s.on=function(t,e){o.on(t,e)},s}function Ku(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{left:"translate(-100%,-50%) translateX(".concat(-t,"px)"),right:"translate(".concat(t,"px, -50%)"),top:"translate(-50%, -100%) translateY(".concat(-t,"px)"),bottom:"translate(-50%, ".concat(t,"px)")}}function Gu(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{left:{x:-t-n,y:-e/2},right:{x:n,y:-e/2},top:{x:-t/2,y:-e-n},bottom:{x:-t/2,y:n}}}function Zu(t){return{left:{left:"100%",top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},right:{left:"".concat(2*-t,"px"),top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},top:{left:"calc(50% - ".concat(t,"px)"),top:"100%",borderWidth:"".concat(t,"px")},bottom:{left:"calc(50% - ".concat(t,"px)"),top:"".concat(2*-t,"px"),borderWidth:"".concat(t,"px")}}}function Ju(t,e,n,r,i,a){var o=e+a.x,s=n+a.y,c=i;return!(o<0||s<0)&&!(o+r>t.width||s+c>t.height)}function Qu(t){var e=t.area,n=t.vx,r=t.vy,i=t.width,a=t.height,o=t.offset,s=n+o.x,c=r+o.y,u=i,l=a,h=s<0?-s:0,f=c<0?-c:0;return{x:h+=s+u>e.width?-(s+u-e.width):0,y:f+=c+l>e.height?-(c+l-e.height):0}}function tl(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,a=t.dockOrder,o=t.x,s=t.y,c=n.targetBounds,u=Ku(e.offset),l=u[e.dock];if(l)return{computedTooltipStyle:{left:"".concat(o,"px"),top:"".concat(s,"px"),transform:l},computedArrowStyle:Zu(e.offset)[e.dock],dock:e.dock};for(var h={width:"target"===e.area?c.width:window.innerWidth,height:"target"===e.area?c.height:window.innerHeight},f=Gu(r,i,e.offset),d=[],p="target"===e.area?o:c.left+o,g="target"===e.area?s:c.top+s,y=0;y<a.length;y+=1){var v=a[y],m=Qu({area:h,vx:p,vy:g,width:r,height:i,offset:f[v]}),x={left:"".concat(o,"px"),top:"".concat(s,"px"),transform:u[v]},b=Zu(e.offset)[v];0!==m.x&&(x.width="".concat(r-20-Math.abs(m.x),"px"),"top"!==v&&"bottom"!==v||(x.left="".concat(o+m.x,"px"),b.left="calc(50% ".concat(m.x>0?"-":"+"," ").concat(Math.abs(m.x),"px)")));var w={computedTooltipStyle:x,computedArrowStyle:b,dock:v,rect:{width:r,height:i}};if(0===m.x&&0===m.y)return w;w.offset=m,d.push(w)}return d.sort(function(t,e){return Math.abs(t.offset.x)-Math.abs(e.offset.x)}),d[0]}function el(t,e,n){var r=t.key?n.component(t.key):n.componentsFromPoint({x:e.clientX,y:e.clientY})[0];if(!r)return{x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};var i=r.rect;return k({scaleRatio:i.scaleRatio},i.computedInner)}var nl,rl={bounds:function(t){var e=t.resources,n=t.nodes,r=t.pointer,i=t.width,a=t.height,o=t.options,s=r.targetBounds,c=e.getNodeBoundsRelativeToTarget(n[0]),u=c.x,l=c.y,h=c.width,f=c.height,d={left:{x:u,y:l+f/2},right:{x:u+h,y:l+f/2},top:{x:u+h/2,y:l},bottom:{x:u+h/2,y:l+f}},p=Ku(o.offset),g=p[o.dock];if(g)return{computedTooltipStyle:{left:"".concat(d[o.dock].x,"px"),top:"".concat(d[o.dock].y,"px"),transform:g},computedArrowStyle:Zu(o.offset)[o.dock],dock:o.dock};for(var y={width:"target"===o.area?s.width:window.innerWidth,height:"target"===o.area?s.height:window.innerHeight},v=Gu(i,a,o.offset),m=["top","left","right","bottom"],x=0;x<m.length;x+=1){var b=m[x];if(Ju(y,"target"===o.area?d[b].x:s.left+d[b].x,"target"===o.area?d[b].y:s.top+d[b].y,i,a,v[b]))return{computedTooltipStyle:{left:"".concat(d[b].x,"px"),top:"".concat(d[b].y,"px"),transform:p[b]},computedArrowStyle:Zu(o.offset)[b],dock:b}}return{computedTooltipStyle:{left:"".concat(d.top.x,"px"),top:"".concat(d.top.y,"px"),transform:p.top},computedArrowStyle:Zu(o.offset).top,dock:"top"}},pointer:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height;return tl({x:n.x,y:n.y,pointer:n,width:r,height:i,options:e,dockOrder:["top","left","right","bottom"]})},slice:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,a=t.nodes,o=t.resources,s=a[0],c=n.dx,u=n.dy,l=o.getComponentBoundsFromNode(s),h=c+l.x+l.width/2,f=u+l.y+l.height/2,d=s.desc.slice,p=d.start,g=d.end,y=d.outerRadius,v=(p+g)/2-Math.PI/2,m=2*Math.PI,x=(v%m+m)%m,b=["top","left","right","bottom"];return"auto"===e.dock&&(b=x<=Math.PI/4||x>=7*Math.PI/4?["right","top","bottom","left"]:x<=3*Math.PI/4?["bottom","left","right","top"]:x<=5*Math.PI/4?["left","top","bottom","right"]:["top","left","right","bottom"]),tl({x:h+y*l.scaleRatio.x*Math.cos(x),y:f+y*l.scaleRatio.y*Math.sin(x),pointer:n,width:r,height:i,options:e,dockOrder:b})}};function il(t,e){var n=t.width,r=t.height,i=e.chart,a=e.state,o=e.props,s={resources:{formatter:i.formatter,scale:i.scale,component:i.component,getComponentBoundsFromNode:function(t){return el(t,a.pointer,i)},getNodeBoundsRelativeToTarget:function(t){return function(t,e,n){var r=el(t,e,n),i=t.bounds;return{x:r.x+e.dx+i.x,y:r.y+e.dy+i.y,width:i.width,height:i.height}}(t,a.pointer,i)}},nodes:a.activeNodes,pointer:a.pointer,width:n,height:r},c=_(o.placement);if("object"===c&&"function"==typeof o.placement.fn)return o.placement.fn(s);var u={type:"pointer",offset:8,dock:"auto",area:"viewport"};"function"===c&&(u=k(u,o.placement(s))),"object"===c&&rl[o.placement.type]?u=k(u,o.placement):"string"===c&&rl[o.placement]&&(u=k(u,{type:o.placement})),s.options=u;var l=rl[u.type](s),h=s.resources.getComponentBoundsFromNode(s.nodes[0]),f=h.x,d=h.y,p=h.width,g=h.height;return p+=f+=s.pointer.dx,g+=d+=s.pointer.dy,l.computedTooltipStyle.left="".concat(Math.min(Math.max(0,f,parseFloat(l.computedTooltipStyle.left)),p),"px"),l.computedTooltipStyle.top="".concat(Math.min(Math.max(0,d,parseFloat(l.computedTooltipStyle.top)),g),"px"),l}var al={require:["chart","renderer"],defaultSettings:{settings:{duration:8e3,delay:500,filter:function(t){return t.filter(function(t){return t.data&&void 0!==t.data.value})},extract:function(t){return t.node.data.value},content:function(t){var e=t.h;return t.data.map(function(t){return e("div",{},t)})},isEqual:function(t,e){return t.length&&t.length===e.length&&t.every(function(t,n){return e[n]&&JSON.stringify(t.data)===JSON.stringify(e[n].data)})},placement:{type:"pointer",dock:"auto",offset:8,area:"viewport"},tooltipClass:{},contentClass:{},arrowClass:{},direction:"ltr",appendTo:void 0,beforeShow:void 0,afterShow:void 0,beforeHide:void 0,onHide:void 0,afterHide:void 0},style:{tooltip:{},content:{backgroundColor:"$gray-25",color:"$font-color--inverted",fontFamily:"$font-family",fontSize:"$font-size",lineHeight:"$line-height",borderRadius:"4px",padding:"8px",opacity:.9},arrow:{position:"absolute",width:"0px",height:"0px",borderStyle:"solid",color:"$gray-25",opacity:.9},"arrow-bottom":{borderTopColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-top":{borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-right":{borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomColor:"transparent"},"arrow-left":{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightColor:"transparent"}}},renderer:"dom",on:{hide:function(){this.hide()},show:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.show(t,e)},prevent:function(t){this.prevent(t)}},hide:function(){this.dispatcher.clear(),this.state.activeNodes=[],this.state.pointer={}},show:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.nodes,a=r.duration,o=r.delay;this.state.prevent||(this.state.pointer=function(t,e){var n=e.chart,r=e.state,i=0,a=0;t.center?(i+=t.center.x,a+=t.center.y):(i+=t.clientX,a+=t.clientY);var o=n.element.getBoundingClientRect(),s=r.targetElement.getBoundingClientRect(),c=i,u=a,l=o.left-s.left,h=o.top-s.top,f=i-o.left,d=a-o.top;return{x:i-=s.left,y:a-=s.top,dx:l,dy:h,cx:f,cy:d,clientX:c,clientY:u,targetBounds:s,chartBounds:o}}(t,this),e=Array.isArray(i)?this.props.filter(i):this.props.filter(this.chart.shapesAt({x:this.state.pointer.cx,y:this.state.pointer.cy})),this.props.isEqual(this.state.activeNodes,e)||(this.dispatcher.clear(),this.state.activeNodes=e,this.state.activeNodes.length&&this.dispatcher.invoke(function(){return n.invokeRenderer(n.state.activeNodes)},a,o)))},prevent:function(t){this.state.prevent=!!t},init:function(t){var e=this;this.state={activeNodes:[],pointer:{},targetElement:null,prevent:!1},this.props=t.settings,this.dispatcher=Xu({defaultDuration:this.props.duration,defaultDelay:this.props.delay});var n=this.dispatcher.clear;this.dispatcher.on("pending",function(){var t;t=n,nl&&nl!==t&&nl(),nl=n,"function"==typeof e.props.beforeShow&&e.props.beforeShow.call(void 0,{resources:{formatter:e.chart.formatter,scale:e.chart.scale}})}),this.dispatcher.on(["cancelled","fulfilled"],function(){var t={resources:{formatter:e.chart.formatter,scale:e.chart.scale}};"function"==typeof e.props.beforeHide&&e.props.beforeHide.call(void 0,k({element:e.state.tooltipElm},t)),"function"==typeof e.props.onHide?e.props.onHide.call(void 0,k({element:e.state.tooltipElm},t)):e.renderer.clear([]),"function"==typeof e.props.afterHide&&e.props.afterHide.call(void 0,t),nl===n&&(nl=null),e.state.tooltipElm=void 0}),this.dispatcher.on("active",function(){"function"==typeof e.props.afterShow&&e.props.afterShow.call(void 0,{element:e.state.tooltipElm,resources:{formatter:e.chart.formatter,scale:e.chart.scale}})})},created:function(){this.init(this.settings)},beforeUpdate:function(t){var e=t.settings;this.dispatcher&&this.dispatcher.clear(),this.init(e)},beforeRender:function(t){this.rect=t.size},render:function(t){return this.h=t,[]},beforeDestroy:function(){this.dispatcher.clear()},appendTo:function(){if(this.props.appendTo){this.state.targetElement="function"==typeof this.props.appendTo?this.props.appendTo({resources:{formatter:this.chart.formatter,scale:this.chart.scale}}):this.props.appendTo;var t=this.state.targetElement.getBoundingClientRect(),e={width:t.width,height:t.height,scaleRatio:this.renderer.size().scaleRatio};this.renderer.destroy(),this.rect=this.renderer.size(e),this.renderer.appendTo(this.state.targetElement)}else this.state.targetElement=this.renderer.element()},mounted:function(){this.appendTo()},updated:function(){this.appendTo()},invokeRenderer:function(t){var e=function(t,e){var n=e.chart,r=e.scale,i=e.props,a=e.h,o={resources:{dataset:n.dataset,scale:n.scale,formatter:n.formatter},scale:r,h:a},s=[];return t.forEach(function(t){if("function"==typeof i.extract){var e=k({node:t},o);s.push(i.extract(e))}}),s}(t,this),n=il(Yu(e,{style:{left:"0px",top:"0px",visibility:"hidden"}},this).getBoundingClientRect(),this);this.state.tooltipElm=Yu(e,n,this)}},ol="tooltip";var sl={require:["renderer","chart"],defaultSettings:{settings:{target:"",selector:"*",fill:"rgba(0, 255, 0, 0.1)",stroke:"lime",opacity:1,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes(this.props.selector).filter(function(e){return e.key===t.props.target}).filter(function(t){return t.collider}).map(function(t){return t.collider});e.forEach(function(e){e.fill=t.props.fill,e.stroke=t.props.stroke,e.opacity=t.props.opacity,e.collider={type:null}}),this.renderer.render(e)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}},cl=2*Math.PI;function ul(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function ll(t,e,n,r,i){var a=1-t;return Math.pow(a,3)*e+3*Math.pow(a,2)*t*n+3*a*Math.pow(t,2)*r+Math.pow(t,3)*i}function hl(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(function(t,e,n,r){return Math.abs(t.x+n.x-(e.x+e.x))+Math.abs(t.y+n.y-(e.y+e.y))+Math.abs(e.x+r.x-(n.x+n.x))+Math.abs(e.y+r.y-(n.y+n.y))}(t,e,n,r)<=10)return-1===i.indexOf(t)&&i.push(t),-1===i.indexOf(r)&&i.push(r),i;var a=ul(t,e),o=ul(e,n),s=ul(n,r),c={x:ll(.5,t.x,e.x,n.x,r.x),y:ll(.5,t.y,e.y,n.y,r.y)},u=ul(a,o),l=ul(o,s);return hl(t,a,u,c,i),hl(c,l,s,r,i),i}function fl(t,e,n){var r=function(t,e,n){return{cp1:{x:t.x+2/3*(e.x-t.x),y:t.y+2/3*(e.y-t.y)},cp2:{x:n.x+2/3*(e.x-n.x),y:n.y+2/3*(e.y-n.y)}}}(t,e,n);return hl(t,r.cp1,r.cp2,n)}var dl=1e-12;function pl(t,e,n){var r,i,a,o,s=[],c=!!t[4],u=!!t[5],l=t[3],h=t[6],f=t[7],d=t[1],p=t[2];if("a"===t[0]&&(h+=e,f+=n),e===f&&n===f)return s;if(!d||!p)return s.push({x:h,y:f}),s;var g=function(t,e,n,r,i,a,o,s,c){var u,l,h,f,d,p,g=io(n%360),y=Math.cos(g),v=Math.sin(g),m=(s-a)/2,x=(c-o)/2,b=y*m+v*x,w=y*x-v*m;t=Math.abs(t),e=Math.abs(e),(p=Math.pow(b,2)/Math.pow(t,2)+Math.pow(w,2)/Math.pow(e,2))>1&&(t*=p=Math.sqrt(p),e*=p);var k=t*e,M=t*w,_=e*b,S=Math.pow(M,2)+Math.pow(_,2),R=Math.pow(k,2)-S,A=Math.sqrt(Math.max(R/S,0));r===i&&(A=-A);var C=A*(M/e),N=A*(-_/t);f=y*C-v*N+(s+a)/2,d=v*C+y*N+(c+o)/2;var O=(b-C)/t,T=(w-N)/e,E=(-b-C)/t,D=(-w-N)/e;return u=Math.atan2(T,O),u+=u<0?cl:0,l=Math.atan2(D,E),h=(l+=l<0?cl:0)-u,!i&&u<l?h-=cl:i&&l<u&&(h+=cl),{startAngle:u,sweepAngle:h%=cl,cx:f,cy:d,rx:t,ry:e}}(d,p,l,c,u,h,f,e,n);r=g.cx,i=g.cy,d=g.rx,p=g.ry,a=g.sweepAngle,o=g.startAngle;for(var y=Math.abs(a*Math.sqrt((Math.pow(d,2)+Math.pow(p,2))/2)),v=Math.ceil(y/10),m=a/v,x=1;x<=v;x++){var b=(o+m*x)%cl,w=Math.cos(b),k=Math.sin(b);s.push({x:r+w*d+-k*w,y:i+k*p+w*k})}return s}function gl(t){for(var e=u(t),n=[],r=[],i=0,a=0,o=null,s=null,c=null,l=null,h=0;h<e.length;++h){var f=e[h],d=f[0];switch("S"!==d&&"s"!==d&&"C"!==d&&"c"!==d&&(o=null,s=null),"T"!==d&&"t"!==d&&"Q"!==d&&"q"!==d&&(c=null,l=null),d){case"m":r.length&&n.push(r.splice(0));case"l":i+=f[1],a+=f[2],r.push({x:i,y:a});break;case"M":r.length&&n.push(r.splice(0));case"L":i=f[1],a=f[2],r.push({x:i,y:a});break;case"H":i=f[1],r.push({x:i,y:a});break;case"h":i+=f[1],r.push({x:i,y:a});break;case"V":a=f[1],r.push({x:i,y:a});break;case"v":a+=f[1],r.push({x:i,y:a});break;case"a":r.push.apply(r,I(pl(f,i,a))),i+=f[6],a+=f[7];break;case"A":r.push.apply(r,I(pl(f,i,a))),i=f[6],a=f[7];break;case"c":r.push.apply(r,I(hl({x:i,y:a},{x:f[1]+i,y:f[2]+a},{x:f[3]+i,y:f[4]+a},{x:f[5]+i,y:f[6]+a}))),o=f[3]+i,s=f[4]+a,i+=f[5],a+=f[6];break;case"C":r.push.apply(r,I(hl({x:i,y:a},{x:f[1],y:f[2]},{x:f[3],y:f[4]},{x:f[5],y:f[6]}))),o=f[3],s=f[4],i=f[5],a=f[6];break;case"s":null!==o&&null!==o||(o=i,s=a),r.push.apply(r,I(hl({x:i,y:a},{x:2*i-o,y:2*a-s},{x:f[1]+i,y:f[2]+a},{x:f[3]+i,y:f[4]+a}))),o=f[1]+i,s=f[2]+a,i+=f[3],a+=f[4];break;case"S":null!==o&&null!==o||(o=i,s=a),r.push.apply(r,I(hl({x:i,y:a},{x:2*i-o,y:2*a-s},{x:f[1],y:f[2]},{x:f[3],y:f[4]}))),o=f[1],s=f[2],i=f[3],a=f[4];break;case"Q":r.push.apply(r,I(fl({x:i,y:a},{x:f[1],y:f[2]},{x:f[3],y:f[4]}))),c=f[1],l=f[2],i=f[3],a=f[4];break;case"q":r.push.apply(r,I(fl({x:i,y:a},{x:f[1]+i,y:f[2]+a},{x:f[3]+i,y:f[4]+a}))),c=f[1]+i,l=f[2]+a,i+=f[3],a+=f[4];break;case"T":null!==c&&null!==c||(c=i,l=a),c=2*i-c,l=2*a-l,r.push.apply(r,I(fl({x:i,y:a},{x:c,y:l},{x:f[1],y:f[2]}))),i=f[1],a=f[2];break;case"t":null!==c&&null!==c||(c=i,l=a),c=2*i-c,l=2*a-l,r.push.apply(r,I(fl({x:i,y:a},{x:c,y:l},{x:f[1]+i,y:f[2]+a}))),i+=f[1],a+=f[2];break;case"z":case"Z":r.length&&r.push({x:r[0].x,y:r[0].y})}}return function(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];Math.abs(n.x-r.x)<dl&&Math.abs(n.y-r.y)<dl&&(t.splice(e,1),e--)}}(r),n.push(r.splice(0)),n}var yl={require:["renderer","chart"],defaultSettings:{settings:{target:"",fill:"transparent",stroke:"lime",opacity:1,radius:2,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes("path").filter(function(e){return e.key===t.props.target}),n=[];e.forEach(function(e){gl(e.attrs.d).forEach(function(e){e.forEach(function(e){n.push({type:"circle",cx:e.x,cy:e.y,r:t.props.radius,fill:t.props.fill,stroke:t.props.stroke,opacity:t.props.opacity,collider:{type:null}})})})}),this.renderer.render(n)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}};var vl=[function(t){t.component("box",ks),t.component("box-marker",ks)},function(t){t.component(Cs,As),t.component("point-marker",As)},function(t){t.component("pie",Es)},function(t){t.component("grid-line",Ps)},function(t){t.component("ref-line",Bs)},function(t){t.component(cc,sc)},function(t){t.component("text",lc)},function(t){t.component("scrollbar",dc)},function(t){t.component("brush-range",Nc),t.component("brush-area-dir",Ec)},function(t){t.component("range",qc)},function(t){t.component("brush-lasso",Wc)},function(t){t.component("labels",vu)},function(t){t.component(Tu,Ou)},function(t){t.component("legend-seq",qu)},function(t){t.component(Wu,Bu)},function(t){t.component("brush-area",$u)},function(t){t.component(ol,al)},function(t){t.component("debug-collider",sl)},function(t){t.component("debug-path-to-points",yl)}],ml=function(){function t(e){S(this,t),this._parent=null,this._children=[],this._ancestors=null,this.type=e,this.data=null}return A(t,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"equals",value:function(t){var e=this.children,n=t.children;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map(function(t){return t.toJSON()})}}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){var t;this._ancestors||(this._ancestors=[],this.parent&&(t=this._ancestors).push.apply(t,[this.parent].concat(I(this.parent.ancestors))));return this._ancestors}},{key:"descendants",get:function(){var t,e,n=[],r=this.children.length;for(t=0;t<r;t++)e=this.children[t],n.push(e),e.children.length&&n.push.apply(n,I(e.descendants));return n}}]),t}(),xl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,r=void 0===n?0:n,i=e.y,a=void 0===i?0:i,o=e.width,s=void 0===o?0:o,c=e.height,u=void 0===c?0:c,l=e.minWidth,h=void 0===l?0:l,f=e.minHeight,d=void 0===f?0:f;S(this,t),this.set({x:r,y:a,width:s,height:u,minWidth:h,minHeight:d})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,a=t.width,o=void 0===a?0:a,s=t.height,c=void 0===s?0:s,u=t.minWidth,l=void 0===u?0:u,h=t.minHeight,f=void 0===h?0:h;this.type="rect",o>=0?(this.x=n,this.width=Math.max(o,l)):(this.x=n+Math.min(o,-l),this.width=-Math.min(o,-l)),c>=0?(this.y=i,this.height=Math.max(c,f)):(this.y=i+Math.min(c,-f),this.height=-Math.min(c,-f))}},{key:"containsPoint",value:function(t){return Bo(this,t)}},{key:"intersectsLine",value:function(t){return Wo(this,X(t))}},{key:"intersectsRect",value:function(t){return Lo(this,Y(t))}},{key:"intersectsCircle",value:function(t){return zo(t,this)}},{key:"intersectsPolygon",value:function(t){return Fo(t,this)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),t}();var bl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cx,r=void 0===n?0:n,i=e.cy,a=void 0===i?0:i,o=e.r,s=void 0===o?0:o,c=e.minRadius,u=void 0===c?0:c;S(this,t),this.set({cx:r,cy:a,r:s,minRadius:u})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,r=t.cy,i=void 0===r?0:r,a=t.r,o=void 0===a?0:a,s=t.minRadius,c=void 0===s?0:s;this.type="circle",this.cx=n,this.cy=i,this.r=Math.max(o,c),this.vector={x:this.cx,y:this.cy}}},{key:"containsPoint",value:function(t){return Do(this,t)}},{key:"intersectsLine",value:function(t){return jo(this,X(t))}},{key:"intersectsRect",value:function(t){return zo(this,Y(t))}},{key:"intersectsCircle",value:function(t){return function(t,e){if(To(t)||To(e))return!1;var n=t.cx-e.cx,r=t.cy-e.cy;return Math.pow(n,2)+Math.pow(r,2)<=Math.pow(t.r+e.r,2)}(this,t)}},{key:"intersectsPolygon",value:function(t){return qo(this,t)}},{key:"points",value:function(){return[{x:this.cx,y:this.cy}]}}]),t}();var wl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x1,r=void 0===n?0:n,i=e.y1,a=void 0===i?0:i,o=e.x2,s=void 0===o?0:o,c=e.y2,u=void 0===c?0:c,l=e.tolerance,h=void 0===l?0:l;S(this,t),this.set({x1:r,y1:a,x2:s,y2:u,tolerance:h})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,r=t.y1,i=void 0===r?0:r,a=t.x2,o=void 0===a?0:a,s=t.y2,c=void 0===s?0:s,u=t.tolerance,l=void 0===u?0:u;this.type="line",this.x1=n,this.y1=i,this.x2=o,this.y2=c,this.tolerance=Math.max(0,Math.round(l)),this.vectors=this.points(),this.zeroSize=n===o&&i===c}},{key:"containsPoint",value:function(t){return this.tolerance>0?jo({cx:t.x,cy:t.y,r:this.tolerance},this):Ho(this,t)}},{key:"intersectsLine",value:function(t){return Vo(this,X(t))}},{key:"intersectsRect",value:function(t){return Wo(Y(t),this)}},{key:"intersectsCircle",value:function(t){return jo(t,this)}},{key:"intersectsPolygon",value:function(t){return Io(t,this)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),t}();var kl=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vertices,n=void 0===e?[]:e;S(this,t),this.set({vertices:n})}return A(t,[{key:"set",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vertices,e=void 0===t?[]:t;if(this.type="polygon",this.vertices=e.slice(),this.edges=[],function(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n.x===r.x&&n.y===r.y&&(t.splice(e,1),e--)}}(this.vertices),!(this.vertices.length<=2)){!function(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}(this.vertices),this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var n=0;n<this.vertices.length;n++)n<this.vertices.length-1&&this.edges.push([this.vertices[n],this.vertices[n+1]]),this.xMin=isNaN(this.xMin)?this.vertices[n].x:Math.min(this.xMin,this.vertices[n].x),this.xMax=isNaN(this.xMax)?this.vertices[n].x:Math.max(this.xMax,this.vertices[n].x),this.yMin=isNaN(this.yMin)?this.vertices[n].y:Math.min(this.yMin,this.vertices[n].y),this.yMax=isNaN(this.yMax)?this.vertices[n].y:Math.max(this.yMax,this.vertices[n].y);this._bounds=null,this._boundingRect=null}}},{key:"containsPoint",value:function(t){return Po(this,t)}},{key:"intersectsCircle",value:function(t){return qo(t,this)}},{key:"intersectsLine",value:function(t){return Io(this,X(t))}},{key:"intersectsRect",value:function(t){return Fo(this,Y(t))}},{key:"intersectsPolygon",value:function(t){if(!Lo(this.boundingRect(),t.boundingRect()))return!1;for(var e=!1,n=0,r=this.edges.length;n<r&&!0!==(e=Io(t,X(this.edges[n])));n++);return e}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),t}();function Ml(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(kl,e)}var _l=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).points,n=void 0===e?[]:e;S(this,t),this.set({points:n})}return A(t,[{key:"set",value:function(){var t,e,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).points,r=void 0===n?[]:n;if(this.type="polyline",this.segments=[],this._points=r.slice(),this._points.length>1)for(var i=0,a=this._points.length-1;i<a;i++)t=this._points[i],e=this._points[i+1],(t.x!==e.x||t.y!==e.y)&&this.segments.push({x1:this._points[i].x,y1:this._points[i].y,x2:this._points[i+1].x,y2:this._points[i+1].y})}},{key:"containsPoint",value:function(t){return this.segments.some(function(e){return Ho(e,t)})}},{key:"intersectsCircle",value:function(t){return this.segments.some(function(e){return jo(t,e)})}},{key:"intersectsLine",value:function(t){var e=X(t);return this.segments.some(function(t){return Vo(t,e)})}},{key:"intersectsRect",value:function(t){var e=Y(t);return this.segments.some(function(t){return Wo(e,t)})}},{key:"intersectsPolygon",value:function(t){return this.segments.some(function(e){return Io(t,e)})}},{key:"points",value:function(){return this._points}}]),t}();var Sl=se();function Rl(t,e){return Sl.get(t)(e)}Sl.add("rect",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(xl,e)}),Sl.add("circle",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(bl,e)}),Sl.add("line",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(wl,e)}),Sl.add("polygon",Ml),Sl.add("polyline",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(_l,e)});var Al=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];S(this,t),this.set(e)}return A(t,[{key:"set",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.geometries=[],e.forEach(function(e){var n=Rl(e.type,e);n&&t.geometries.push(n)})}},{key:"containsPoint",value:function(t){return this.geometries.some(function(e){return e.containsPoint(t)})}},{key:"intersectsLine",value:function(t){return this.geometries.some(function(e){return e.intersectsLine(t)})}},{key:"intersectsRect",value:function(t){return this.geometries.some(function(e){return e.intersectsRect(t)})}},{key:"intersectsCircle",value:function(t){return this.geometries.some(function(e){return e.intersectsCircle(t)})}},{key:"intersectsPolygon",value:function(t){return this.geometries.some(function(e){return e.intersectsPolygon(t)})}}]),t}();var Cl=function(){function t(){S(this,t),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return A(t,[{key:"clone",value:function(){return(new t).multiply(this)}},{key:"set",value:function(t){return this._elements=t,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(t){var e,n;for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]+=t;return this}},{key:"translate",value:function(t,e){return this.multiply([[1,0,t],[0,1,e],[0,0,1]]),this}},{key:"rotate",value:function(t){var e=Math.cos(-t),n=Math.sin(-t);return this.multiply([[e,n,0],[-n,e,0],[0,0,1]]),this}},{key:"multiply",value:function(e){var n,r,i,a;if(e instanceof t&&(e=e._elements),Array.isArray(e)){for(i=[[0,0,0],[0,0,0],[0,0,0]],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)for(a=0;a<3;a++)i[n][r]+=this._elements[n][a]*e[a][r];this._elements=i}else for(n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)this._elements[n][r]*=e;return this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.multiply([[t,0,0],[0,e,0],[0,0,1]]),this}},{key:"transform",value:function(t,e,n,r,i,a){return this.multiply([[t,n,i],[e,r,a],[0,0,1]]),this}},{key:"determinant",value:function(){var t=this._elements[0][0],e=this._elements[0][1],n=this._elements[0][2],r=this._elements[1][0],i=this._elements[1][1],a=this._elements[1][2],o=this._elements[2][0],s=this._elements[2][1],c=this._elements[2][2];return t*i*c+e*a*o+n*r*s-n*i*o-e*r*c-t*a*s}},{key:"invert",value:function(){var t=this.determinant(),e=this._elements[0][0],n=this._elements[0][1],r=this._elements[0][2],i=this._elements[1][0],a=this._elements[1][1],o=this._elements[1][2],s=this._elements[2][0],c=this._elements[2][1],u=this._elements[2][2];return this._elements=[[a*u-o*c,r*c-n*u,n*o-r*a],[o*s-i*u,e*u-r*s,r*i-e*o],[i*c-a*s,s*n-e*c,e*a-n*i]],this.multiply(1/t),this}},{key:"transpose",value:function(){var t=Object.create(this._elements);return this._elements=[[t[0][0],t[1][0],t[2][0]],[t[0][1],t[1][1],t[2][1]],[t[0][2],t[1][2],t[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return"".concat(this._elements.map(function(t){return t.join("\t")}).join("\n"))}},{key:"isIdentity",value:function(){var t=this._elements;return 1===t[0][0]&&0===t[0][1]&&0===t[0][2]&&0===t[1][0]&&1===t[1][1]&&0===t[1][2]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]}},{key:"transformPoint",value:function(t){var e,n,r=[t.x,t.y,1],i=this._elements,a=[0,0,0];for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)a[e]+=r[n]*i[e][n];return{x:a[0],y:a[1]}}},{key:"transformPoints",value:function(t){var e,n,r,i,a,o=this._elements,s=[];for(i=0;i<t.length;i++){for(e=[t[i].x,t[i].y,1],a=[0,0,0],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)a[n]+=e[r]*o[n][r];s.push({x:a[0],y:a[1]})}return s}},{key:"elements",get:function(){var t=this._elements;return[[t[0][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[1][2]],[t[2][0],t[2][1],t[2][2]]]}}]),t}(),Nl=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g;function Ol(t,e){var n=e.args[0]*(Math.PI/180);if(e.args.length>2){var r=e.args[1],i=e.args[2];t.translate(r,i),t.rotate(n),t.translate(-r,-i)}else 1===e.args.length&&t.rotate(n)}function Tl(t,e){var n=e.args[0],r=isNaN(e.args[1])?e.args[0]:e.args[1];t.scale(n,r)}function El(t,e){var n=e.args[0],r=isNaN(e.args[1])?0:e.args[1];t.translate(n,r)}function Dl(t,e){e.args.length>=6&&t.transform.apply(t,I(e.args))}function zl(t,e){for(var n,r=function(t){for(var e,n=[];null!==(e=Nl.exec(t));){var r=e[2].trim(),i=-1===r.indexOf(",")?r.split(" "):r.split(",");n.push({cmd:e[1],args:i.filter(function(t){return t.trim().length>0}).map(function(t){return Number(t)})})}return n}(t),i=0,a=r.length;i<a;i++)"rotate"===(n=r[i]).cmd?Ol(e,n):"scale"===n.cmd?Tl(e,n):"matrix"===n.cmd?Dl(e,n):"translate"===n.cmd&&El(e,n)}var jl={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/,tag:/^\.(\w+)/},ql={type:function(t,e){return e.filter(function(e){var n=e.type;return!!n&&n.toLowerCase()===t.toLowerCase()})},attr:function(t,e,n,r){return r.filter(function(r){var i=r.attrs[t];if(!e)return void 0!==i;if(void 0===i)return!1;switch(e){case"=":return n===String(i);case"!=":return n!==String(i);default:return!1}})},universal:function(t){return t},tag:function(t,e){return e.filter(function(e){var n=e.tag;return!!n&&-1!==n.trim().split(/\s+/).indexOf(t.replace(".",""))})}};var Pl={find:function(t,e){var n,r,i=[],a=[];if(e.isBranch){var o;n=function(t){var e,n,r,i,a=[];return t.split(/\s*,\s*/).forEach(function(t){t=t.trim(),e=[];for(var o=function(a){(r=t.match(jl[a]))&&(i=!0,t=t.slice(r[0].length),n={type:a,value:r[0]},"attr"===a&&(r=r[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),n.attribute=r[1],n.operator=r[2],n.attributeValue=r[3]),e.push(n))};t&&(i=!1,(r=t.match(/^\s*([>+~]|\s)\s*/))&&(i=!0,e.push({type:" ",value:r[0]}),t=t.slice(r[0].length)),Object.keys(jl).forEach(o),e&&e.length&&a.indexOf(e)<0&&a.push(e),i););}),a}(t),r=e.descendants;for(var s=function(t,e){o=n[t];var i=[],s=r.slice(),c=!1;o.reverse().forEach(function(t){if(" "===t.type)return i.push(s),s=r.slice(),void(c=!1);s=function(t,e){if(!e||!e.length||!t||"function"!=typeof ql[t.type])return[];switch(t.type){case"type":return ql[t.type](t.value,e);case"attr":return ql[t.type](t.attribute,t.operator,t.attributeValue,e);case"universal":return ql[t.type](e);case"tag":return ql[t.type](t.value,e);default:return[]}}(t,s),c=!0}),c&&i.push(s);var u=i[0].filter(function(t){for(var e,n=t.parent,r=1;r<i.length;r++){for(e=i[r].indexOf(n);n&&e<0;)n=n.parent,e=i[r].indexOf(n);if(e<0)return!1}return!0});a.push(u)},c=0,u=n.length;c<u;c++)s(c);for(var l=0,h=a.length;l<h;l++)for(var f=0,d=a[l].length;f<d;f++)i.indexOf(a[l][f])<0&&i.push(a[l][f])}return i||[]}};function Il(t,e,n){var r=t.type,i=n?n.transformPoints(t.points()):t.points();!function(t,e){for(var n=0,r=t.length;n<r;n++)t[n].x/=e,t[n].y/=e}(i,e);var a=null;if("rect"===r||"bounds"===r)(a=Y(i)).type=r;else if("circle"===r)(a=function(t,e){return{cx:t[0].x,cy:t[0].y,r:e}}(i,t.r)).type=r;else if("line"===r)(a=X(i)).type=r;else if("polygon"===r||"polyline"===r){a={type:"path",d:no(i,"polygon"===r)}}return a}var Fl=function(){function t(e){var n=this;S(this,t),this._bounds=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e.boundingRect?e.boundingRect(t):{x:0,y:0,width:0,height:0};return{x:n.x,y:n.y,width:n.width,height:n.height}},this._attrs=e.attrs,this._type=e.type,this._data=e.data,this._dpi=e.stage?e.stage.dpi:1,this._collider=function(){return function(t,e){if(t.collider){var n=t.modelViewMatrix;return"collection"===t.colliderType?{type:"container",children:t.collider.geometries.map(function(t){return Il(t,e,n)})}:Il(t.collider,e,n)}return null}(e,n._dpi)},this._desc=e.desc,this._tag=e.tag,this._children=function(){return e.children.map(function(e){return new t(e)})},this._parent=function(){return e.parent?new t(e.parent):null},this._cache={elementBoundingRect:null},this._getElementBoundingRect=function(){return!n._cache.elementBoundingRect&&n.element&&(n._cache.elementBoundingRect=n.element.getBoundingClientRect()),n._cache.elementBoundingRect||{left:0,top:0}}}return A(t,[{key:"boundsRelativeTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=_(t),r=e?this.bounds:this.localBounds,i=this._getElementBoundingRect(),a=i.left,o=i.top;if("object"===n&&null!==t&&"function"==typeof t.getBoundingClientRect){var s=t.getBoundingClientRect(),c=s.left,u=void 0===c?0:c,l=s.top;a-=u,o-=void 0===l?0:l}return r.x+=a,r.y+=o,r}},{key:"children",get:function(){return this._children()}},{key:"parent",get:function(){return this._parent()}},{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",set:function(t){this._cache.elementBoundingRect=null,this._element=t},get:function(){return this._element}},{key:"key",set:function(t){this._key=t},get:function(){return this._key}},{key:"bounds",get:function(){var t=this._bounds();return t.x/=this._dpi,t.y/=this._dpi,t.width/=this._dpi,t.height/=this._dpi,t}},{key:"localBounds",get:function(){return this._bounds(!1)}},{key:"collider",get:function(){return this._collider()}},{key:"desc",get:function(){return this._desc}},{key:"tag",get:function(){return this._tag}}]),t}();function Ll(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(Fl,e)}var Bl=function(){function t(e){S(this,t),this._node=Ll(e),this._parent=null,this._input=null}return A(t,[{key:"node",get:function(){return this._node}},{key:"parent",set:function(t){this._parent=t},get:function(){return this._parent}},{key:"input",set:function(t){this._input=t},get:function(){return this._input}}]),t}();function Wl(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(Bl,e)}function Vl(t,e){var n=t.parent;if(n&&"stage"!==n.type){e.parent=Wl(n);var r=n.parent;r&&"stage"!==r.type&&Vl(r,e.parent)}}function Hl(t,e,n){if(null===t.colliderType)return null;var r=function(t,e){var n={};if(t.modelViewMatrix)if(Array.isArray(e))n=t.inverseModelViewMatrix.transformPoints(e);else if(isNaN(e.r))Array.isArray(e.vertices)?n.vertices=t.inverseModelViewMatrix.transformPoints(e.vertices):n=t.inverseModelViewMatrix.transformPoint(e);else{var r={x:e.cx,y:e.cy},i=t.inverseModelViewMatrix.transformPoint(r);n.cx=i.x,n.cy=i.y,n.r=e.r}else n=e;return Array.isArray(n.vertices)&&(n=Ml(n)),n}(t,n);return"frontChild"===t.colliderType?function(t,e,n){for(var r=t.descendants.length-1;r>=0;r--){var i=t.descendants[r];if(null!==i.collider&&i.collider[e](n)){var a=Wl(i);return Vl(i,a),a}}return null}(t,e,r):function(t,e,n){if(t.collider[e](n)){var r=Wl(t);return Vl(t,r),r}return null}(t,e,r)}function Ul(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};switch(K(t)){case"circle":return n.cx=t.cx*e,n.cy=t.cy*e,n.r=t.r,["intersectsCircle",n];case"rect":return["intersectsRect",n=$(t).map(function(t){return co(t,e)})];case"line":return["intersectsLine",n=U(t).map(function(t){return co(t,e)})];case"point":return["containsPoint",n=co(t,e)];case"polygon":return n.vertices=t.vertices.map(function(t){return co(t,e)}),["intersectsPolygon",n];default:return[]}}function $l(t,e){var n=P(Ul(e,t.dpi),2),r=n[0],i=n[1],a=[];return r&&(function t(e,n,r,i){for(var a=e.length,o=0;o<a;o++){var s=e[o],c=Hl(s,n,i);c&&r.push(c),!s.children||c||s.collider||t(s.children,n,r,i)}}([t],r,a,i),function(t,e){for(var n=0,r=e.length;n<r;n++)e[n].input=t}(e,a)),a}function Yl(t,e){var n=P(Ul(e,t.dpi),2);return function t(e,n,r){for(var i=e.length,a=0;a<i;a++){var o=e[a];if(null!==Hl(o,n,r))return!0;if(o.children&&!o.collider)return t(o.children,n,r)}return!1}([t],n[0],n[1])}var Xl=function(t){function e(t){var n;return S(this,e),(n=j(this,T(e).call(this,t)))._stage=null,n._collider={type:null,definition:null,fn:null},n._attrs={},n._node=null,n}return O(e,ml),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.node=t;var e,n,r=t.data,i=t.desc,a=t.tag,o=t.strokeReference,s=t.fillReference;e=this.attrs,n=t,Object.keys(eo).forEach(function(t){var r=n[t];if(void 0!==r){var i=eo[t];e[i]=r}}),void 0!==r&&(this.data=r),"object"===_(i)&&(this.desc=k(!0,{},i)),"string"==typeof a&&(this.tag=a),"string"==typeof o&&(this.strokeReference=o),"string"==typeof s&&(this.fillReference=s)}},{key:"findShapes",value:function(t){return Pl.find(t,this).map(function(t){return Ll(t)})}},{key:"getItemsFrom",value:function(t){return $l(this,t)}},{key:"containsPoint",value:function(t){return Yl(this,t)}},{key:"intersectsLine",value:function(t){return Yl(this,t)}},{key:"intersectsRect",value:function(t){return Yl(this,t)}},{key:"intersectsCircle",value:function(t){return Yl(this,t)}},{key:"intersectsPolygon",value:function(t){return Yl(this,t)}},{key:"resolveLocalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Cl;void 0!==this.attrs.transform&&zl(this.attrs.transform,t),this.modelViewMatrix=t.clone()}},{key:"resolveGlobalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Cl,e=this.ancestors;if(e.length>0)for(var n=e.length-1;n>=0;n--)e[n].resolveLocalTransform(t),t=e[n].modelViewMatrix;this.resolveLocalTransform(t)}},{key:"attr",value:function(t){return this.attrs[t]}},{key:"equals",value:function(t){var n=this.attrs,r=Object.keys(n),i=t.attrs,a=Object.keys(i);if(r.length!==a.length)return!1;for(var o=0;o<r.length;o++){var s=r[o];if(!Object.hasOwnProperty.call(i,s))return!1;if(n[s]!==i[s])return!1}return q(T(e.prototype),"equals",this).call(this,t)}},{key:"toJSON",value:function(){var t=q(T(e.prototype),"toJSON",this).call(this);return t.attrs=this.attrs,t}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",set:function(t){this._mvm=t,this._imvm=null},get:function(){return this._mvm}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",set:function(t){this._node=t},get:function(){return this._node}},{key:"collider",set:function(t){var e=Array.isArray(t)?"collection":t&&t.type;return"string"!=typeof e?(this._collider.type=null,this._collider.definition=null,void(this._collider.fn=null)):null!==this._collider&&this._collider.type===e&&null!==this._collider.fn?(this._collider.fn.set(t),void(this._collider.definition=t)):(this._collider.type=e,void(this._collider.definition=t))},get:function(){if(null!==this._collider.fn)return this._collider.fn;switch(this._collider.type){case"collection":this._collider.fn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(Al,e)}(this._collider.definition);break;case"frontChild":return!0;case"bounds":this._collider.fn=Rl("rect",this.boundingRect());break;case"line":case"rect":case"circle":case"polygon":case"polyline":this._collider.fn=Rl(this._collider.type,this._collider.definition);break;default:return null}return this._collider.fn}},{key:"colliderType",get:function(){return this._collider.type}}]),e}(),Kl=function(t){function e(){return S(this,e),j(this,T(e).apply(this,arguments))}return O(e,ml),A(e,[{key:"addChild",value:function(t){if(!(t&&t instanceof ml))throw new TypeError("Expecting a Node as argument, but got ".concat(t));if(t===this)throw new Error("Can not add itself as child!");if(t._children&&t._children.length&&this.ancestors.indexOf(t)>=0)throw new Error("Can not add an ancestor as child!");return t._parent&&t._parent!==this&&t._parent.removeChild(t),this._children.push(t),t._parent=this,t._ancestors=null,this}},{key:"addChildren",value:function(t){var e,n=t?t.length:0;for(e=0;e<n;e++)this.addChild(t[e]);return this}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return e>=0&&(this._children.splice(e,1),t._parent=null,t._ancestors=null),this}},{key:"removeChildren",value:function(t){var e,n;if(!this._children)return this;if(t)for(n=t.length,e=0;e<n;e++)this.removeChild(t[e]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),e}(),Gl=Kl.prototype,Zl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};S(this,e);var r=n.type,i=void 0===r?"container":r;return(t=j(this,T(e).call(this,i))).set(n),t}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(T(e.prototype),"set",this).call(this,t);var n=t.collider,r=k({type:null},n);this.collider=r,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"appendChildRect",value:function(t,e){if(void 0!==t.bounds){var n=this.__boundingRect[e]||{},r=P(t.bounds(e),3),i=r[0],a=r[2],o=i.x,s=i.y,c=a.x,u=a.y,l=isNaN(n.width)?c:Math.max(c,n.width+n.x),h=isNaN(n.height)?u:Math.max(u,n.height+n.y);n.x=isNaN(n.x)?o:Math.min(o,n.x),n.y=isNaN(n.y)?s:Math.min(s,n.y),n.width=l-n.x,n.height=h-n.y,this.__boundingRect[e]=n}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];for(var e=this.children.length,n=0;n<e;n++)this.appendChildRect(this.children[n],t);return this.__boundingRect[t]=k({x:0,y:0,width:0,height:0},this.__boundingRect[t]),this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}},{key:"addChild",value:function(t){var e=Gl.addChild.call(this,t);if(this._collider&&"bounds"===this._collider.type){this.appendChildRect(t,!0);var n=k({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=n}return e}},{key:"addChildren",value:function(t){var e=Gl.addChildren.call(this,t),n=t.length;if(this._collider&&"bounds"===this._collider.type&&n>0){for(var r=0;r<n;r++)this.appendChildRect(t[r],!0);var i=k({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=i}return e}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;if(Gl.removeChild.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var i=k(this.boundingRect(!0),{type:"bounds"});this.collider=i}return this}},{key:"removeChildren",value:function(t){if(Gl.removeChildren.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var e=k(this.boundingRect(!0),{type:"bounds"});this.collider=e}return this}}]),e}();function Jl(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(Zl,e)}var Ql=function(t){function e(t){var n;return S(this,e),(n=j(this,T(e).call(this,"stage")))._stage=z(z(n)),n._dpiRatio=t||1,n}return O(e,Zl),A(e,[{key:"dpi",get:function(){return this._dpiRatio}}]),e}();var th=Kl.prototype,eh=["x1","x2","y1","y2","id","offset","style"],nh=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};S(this,e);var r=n.type,i=void 0===r?"container":r;return(t=j(this,T(e).call(this,i))).set(n),t._boundingRect={},t}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(T(e.prototype),"set",this).call(this,t);for(var n=this.attrs,r="",i=0,a=eh.length;i!==a;i++)void 0!==t[r=eh[i]]&&(n[r]=t[r])}},{key:"addChild",value:function(t){return th.addChild.call(this,t)}},{key:"addChildren",value:function(t){return th.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return th.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return th.removeChildren.call(this,t),this}}]),e}();function rh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(nh,e)}var ih=Kl.prototype,ah=["patternUnits","x","y","width","height","id"],oh=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};S(this,e);var r=n.type,i=void 0===r?"container":r;return(t=j(this,T(e).call(this,i))).set(n),t._boundingRect={},t}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(T(e.prototype),"set",this).call(this,t);for(var n=this.attrs,r="",i=0,a=ah.length;i!==a;i++)void 0!==t[r=ah[i]]&&(n[r]=t[r])}},{key:"addChild",value:function(t){return ih.addChild.call(this,t)}},{key:"addChildren",value:function(t){return ih.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return ih.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return ih.removeChildren.call(this,t),this}}]),e}();var sh=function(t){function e(){var t,n;return S(this,e),(t=n=j(this,T(e).call(this,"rect"))).set.apply(t,arguments),n}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i,o=t.width,s=void 0===o?0:o,c=t.height,u=void 0===c?0:c,l=t.collider,h=k({type:"rect",x:r,y:a,width:s,height:u},l);q(T(e.prototype),"set",this).call(this,t),s>=0?(this.attrs.x=r,this.attrs.width=s):(this.attrs.x=r+s,this.attrs.width=-s),u>=0?(this.attrs.y=a,this.attrs.height=u):(this.attrs.y=a+u,this.attrs.height=-u),this.collider=h,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=$(this.attrs),n=P(H(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),4),r=n[0],i=n[1],a=n[2],o=n[3];return this.__boundingRect[t]={x:r,y:i,width:a-r,height:o-i},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),e}();var ch=function(t){function e(){var t,n;return S(this,e),(t=n=j(this,T(e).call(this,"circle"))).set.apply(t,arguments),n}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.cx,r=void 0===n?0:n,i=t.cy,a=void 0===i?0:i,o=t.r,s=void 0===o?0:o,c=t.collider,u=k({type:"circle",cx:r,cy:a,r:s},c);q(T(e.prototype),"set",this).call(this,t),this.attrs.cx=r,this.attrs.cy=a,this.attrs.r=s,this.collider=u,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=this.bounds(t);return this.__boundingRect[t]={x:e[0].x,y:e[0].y,width:e[2].x-e[0].x,height:e[2].y-e[0].y},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.attrs,n=e.cx,r=e.cy,i=e.r,a=e.r,o=n-i,s=r-a,c=2*i,u=2*a,l=[{x:o,y:s},{x:o+c,y:s},{x:o+c,y:s+u},{x:o,y:s+u}];if(t&&this.modelViewMatrix){var h=P(H(l=this.modelViewMatrix.transformPoints(l)),4),f=h[0],d=h[1];c=h[2]-f,u=h[3]-d,this.__bounds[t]=[{x:f,y:d},{x:f+c,y:d},{x:f+c,y:d+u},{x:f,y:d+u}]}else this.__bounds[t]=l;return this.__bounds[t]}}]),e}();var uh=function(t){function e(){var t,n;return S(this,e),(t=n=j(this,T(e).call(this,"line"))).set.apply(t,arguments),n}return O(e,Xl),A(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x1,r=void 0===n?0:n,i=t.y1,a=void 0===i?0:i,o=t.x2,s=void 0===o?0:o,c=t.y2,u=void 0===c?0:c,l=t.collider;q(T(e.prototype),"set",this).call(this,t),this.attrs.x1=r,this.attrs.y1=a,this.attrs.x2=s,this.attrs.y2=u;var h={type:"line",x1:r,y1:a,x2:s,y2:u};this.collider=k(h,l),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=U(this.attrs);t&&this.modelViewMatrix&&(e=this.modelViewMatrix.transformPoints(e));var n=P(H(e),4),r=n[0],i=n[1],a=n[2],o=n[3],s=r!==a||i!==o;return this.__boundingRect[t]={x:r,y:i,width:s?Math.max(1,a-r):0,height:s?Math.max(1,o-i):0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),e}();var lh=Math.PI/2;function hh(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x);return n<0?n+2*Math.PI:n}function fh(t,e,n){return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}}var dh=1e-12;var ph=function(t){function e(){var t,n;return S(this,e),(t=n=j(this,T(e).call(this,"path"))).set.apply(t,arguments),n}return O(e,Xl),A(e,[{key:"set",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(T(e.prototype),"set",this).call(this,n),this.segments=[],this.points=[],this.attrs.d=n.d,Array.isArray(n.collider)||"object"===_(n.collider)&&void 0!==n.collider.type?this.collider=n.collider:n.d&&(this.segments=gl(n.d),this.segments.forEach(function(e){if(e.length<=1);else if(function(t){if(t.length<2)return!1;var e=t[0],n=t[t.length-1];return Math.abs(e.x-n.x)<dh&&Math.abs(e.y-n.y)<dh}(e))t.collider=k({type:"polygon",vertices:e},n.collider);else if("object"===_(n.collider)&&n.collider.visual){var r=t.attrs["stroke-width"]/2;t.collider=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i=[];if("h"===n.forceOrientation){var a=t[0].x<t[1].x?-1:1,o=t[t.length-1].x>t[t.length-2].x?1:-1;t.unshift({x:t[0].x+a,y:t[0].y}),t.push({x:t[t.length-1].x+o,y:t[t.length-1].y})}else if("v"===n.forceOrientation){var s=t[0].y<t[1].y?-1:1,c=t[t.length-1].y>t[t.length-2].y?1:-1;t.unshift({x:t[0].x,y:t[0].y+s}),t.push({x:t[t.length-1].x,y:t[t.length-1].y+c})}for(var u=t.length-1,l=1;l<u;l++){var h=t[l-1],f=t[l],d=t[l+1],p=hh(f,h),g=hh(f,d),y=(p+g)/2,v=y+Math.PI,m=Math.max(y,v),x=Math.min(y,v),b=p>g;if(1===l){var w=hh(h,f);r.push(fh(h,w-lh,e)),i.unshift(fh(h,w+lh,e))}var k=b?m:x,M=b?x:m;if(r.push(fh(f,k,e)),i.unshift(fh(f,M,e)),l===u-1){var _=hh(d,f);r.push(fh(d,_+lh,e)),i.unshift(fh(d,_-lh,e))}}return{type:"polygon",vertices:r.concat(i)}}(e,r,n.collider)}else t.collider=k({type:"polyline",points:e},n.collider)})),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];this.points.length||(this.segments=this.segments.length?this.segments:gl(this.attrs.d),this.points=function(t){for(var e,n=[],r=t.length,i=0;i<r;i++){e=t[i];for(var a=0;a<e.length;a++)n.push(e[a])}return n}(this.segments));var e=P(H(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(this.points):this.points),4),n=e[0],r=e[1],i=e[2],a=e[3];return this.__boundingRect[t]={x:n||0,y:r||0,width:i-n||0,height:a-r||0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),e}();var gh=function(t){function e(){var t,n;return S(this,e),(t=n=j(this,T(e).call(this,"text"))).set.apply(t,arguments),n}return O(e,Xl),A(e,[{key:"set",value:function(){var t,n,r,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.x,s=void 0===o?0:o,c=a.y,u=void 0===c?0:c,l=a.dx,h=void 0===l?0:l,f=a.dy,d=void 0===f?0:f,p=a.textBoundsFn,g=a.text,y=a.title,v=a.collider,m=a.boundingRect;q(T(e.prototype),"set",this).call(this,a),this.attrs.x=s,this.attrs.y=u,this.attrs.dx=h,this.attrs.dy=d,this.attrs.text=g,void 0!==y&&(this.attrs.title=String(y)),"object"===_(m)?this._textBoundsFn=function(){return m}:"function"==typeof p&&(this._textBoundsFn=p),this.collider=k({type:(t=this,n=t.data,r=t._boundingRect,i=t._textBoundsFn,null!=n&&(r||i)?"bounds":null)},v),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];if("function"!=typeof this._textBoundsFn)return{x:0,y:0,width:0,height:0};var e=$(this._textBoundsFn(this.attrs)),n=P(H(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),4),r=n[0],i=n[1],a=n[2],o=n[3];return this.__boundingRect[t]={x:r,y:i,width:a-r,height:o-i},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),e}();var yh=se();function vh(t,e){return yh.get(t)(e)}yh.add("rect",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(sh,e)}),yh.add("circle",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(ch,e)}),yh.add("text",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(gh,e)}),yh.add("line",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(uh,e)}),yh.add("path",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(ph,e)}),yh.add("stage",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(Ql,e)}),yh.add("container",Jl),yh.add("defs",Jl),yh.add("linearGradient",rh),yh.add("radialGradient",rh),yh.add("stop",rh),yh.add("pattern",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return D(oh,e)});var mh=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[{}];function n(){return e[e.length-1]}return n.save=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n(),a={},o="",s=0;s<t.length;s++)void 0!==i[o=t[s]]&&(a[o]=i[o]);return k(a,r),e.push(a),n()},n.restore=function(){e.splice(e.length-1,1)},n}(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"]);function xh(t,e){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)e[n](t)}function bh(t,e,n){t.node=n[e],t.index=e}function wh(t){var e=t.items,n=t.stage,r=t.dpi,i=t.on,a=void 0===i?{}:i;return n||(n=vh("stage",r)),function t(e,n,r,i){for(var a={siblings:e,node:null,index:0},o=0,s=e.length;o<s;o++)if(bh(a,o,e),xh(a,i.create),!("function"==typeof a.node.disabled?a.node.disabled():a.node.disabled)){a.node=mh.save(a.node);var c=vh(a.node.type,a.node);c&&(a.node.transform&&(r.save(),zl(a.node.transform,r)),r.isIdentity()||(c.modelViewMatrix=r.clone()),n.addChild(c),a.node.children&&t(a.node.children,c,r,i),a.node.transform&&r.restore()),mh.restore()}}(e,n,new Cl,a),n}var kh=/\n+|\r+|\r\n/,Mh=/\s/,_h=/[a-zA-Z\u00C0-\u00F6\u00F8-\u00FF\u00AD]/,Sh=0,Rh=1,Ah=2;function Ch(t){return"string"==typeof t?-1!==t.search(kh):-1!==String(t).search(kh)}function Nh(t){return-1!==t.search(Mh)}function Oh(t){return-1!==t.search(_h)}function Th(t,e,n){return Math.max(e,Math.min(n,t))}function Eh(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.string,n=t.separator,r=void 0===n?"":n,i=t.reverse,a=void 0!==i&&i,o=t.measureText,s=void 0===o?function(t){return{width:t.length,height:1}}:o,c=t.mandatoryBreakIdentifiers,u=void 0===c?[Ch]:c,l=t.noBreakAllowedIdentifiers,h=void 0===l?[]:l,f=t.suppressIdentifier,d=void 0===f?[Nh,Ch,function(t){return""===t}]:f,p=t.hyphenationIdentifiers,g=void 0===p?[Oh]:p,y=String(e).split(r);!function(t){""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()}(y);var v=y.length,m=a?function(t){return t>=0}:function(t){return t<v},x=a?v:-1;function b(t){var e=Th(t,0,v-1),n=y[e],r=s(n),i=function(t,e,n,r,i){return r.some(function(r){return r(t,e,n)})?Rh:i.some(function(r){return r(t,e,n)})?Sh:Ah}(n,e,y,u,h);return{index:e,value:n,breakOpportunity:i,suppress:d.some(function(t){return t(n,e,y)}),hyphenation:g.some(function(t){return t(n,e,y)}),width:r.width,height:r.height,done:!1}}return{next:function(t){return isNaN(t)?a?x--:x++:x=Th(t,0,v-1),m(x)?b(x):{done:!0}},peek:b,length:v}}var Dh=1.2,zh="‐",jh="…";function qh(t,e){return{lines:[],line:"",width:0,maxLines:function(t,e){var n=t.maxHeight,r=Math.max(t.maxLines,1)||1/0;if(isNaN(n))return r;var i=e*(t.lineHeight||Dh);return Math.max(1,Math.min(Math.floor(n/i),r))}(t,e(t.text).height),maxWidth:t.maxWidth,hyphens:{enabled:"auto"===t.hyphens,char:zh,metrics:e(zh)}}}function Ph(t){t.lines.push(t.line),t.line="",t.width=0}function Ih(t,e){t.line+=e.value,t.width+=e.width}function Fh(t,e,n){if(e.width>t.maxWidth)return e;for(var r=e.index,i=1;i<5;i++){var a=n.peek(e.index-1);if(!e.hyphenation||!a.hyphenation||0===e.index)return e;if(t.width+t.hyphens.metrics.width<=t.maxWidth)return t.line+=t.hyphens.char,e;if(1===t.line.length)return e;e=n.next(r-i),t.line=t.line.slice(0,-1),t.width-=e.width}return e}function Lh(t,e,n){for(var r=Eh({string:e.value,measureText:n});t.lines.length<t.maxLines;){var i=r.next();if(i.done)break;t.width+i.width>t.maxWidth&&i.breakOpportunity===Ah&&t.line.length>0?(i=t.hyphens.enabled?Fh(t,i,r):i,Ph(t),Ih(t,i)):Ih(t,i)}}function Bh(t,e){for(var n=Eh({string:t.text,separator:"",measureText:e,noBreakAllowedIdentifiers:[function(t,e){return 0===e}]}),r=qh(t,e),i=!0;r.lines.length<r.maxLines;){var a=n.next();if(a.done){Ph(r),i=!1;break}a.breakOpportunity===Rh?Ph(r):r.width+a.width>r.maxWidth&&a.breakOpportunity===Ah?a.suppress?r.width+=a.width:(a=r.hyphens.enabled?Fh(r,a,n):a,Ph(r),Ih(r,a)):Ih(r,a)}return{lines:r.lines,reduced:i}}function Wh(t,e){for(var n=Eh({string:t.text,separator:/(\s|-|\u2010)/,measureText:e}),r=qh(t,e),i=!0;r.lines.length<r.maxLines;){var a=n.next();if(a.done){Ph(r),i=!1;break}a.breakOpportunity===Rh?Ph(r):r.width+a.width>r.maxWidth&&a.breakOpportunity===Ah?a.suppress?Ph(r):a.width>r.maxWidth?Lh(r,a,e):(Ph(r),Ih(r,a)):Ih(r,a)}return{lines:r.lines,reduced:i}}function Vh(t){return{"break-all":Bh,"break-word":Wh}[t.wordBreak]}function Hh(t){return function(e){var n=e.node;if(function(t){return"text"===t.type&&!t._lineBreak}(n)){var r=Vh(n);if(!r)return;var i=t(n);if(i.width<=n.maxWidth&&!Ch(n.text))return;var a=(i.height*Math.max(isNaN(n.lineHeight)?Dh:n.lineHeight,0)-i.height)/2,o=r(n,function(t,e){return function(n){return e({text:n,fontSize:t.fontSize,fontFamily:t.fontFamily})}}(n,t));e.node=function(t,e,n,r){var i={type:"container",children:[]};void 0!==e.id&&(i.id=e.id);var a=0;return t.lines.forEach(function(o,s){var c=k({},e);c.text=o,c._lineBreak=!0,a+=n,t.reduced&&s===t.lines.length-1?c.text+=jh:delete c.maxWidth,c.dy=isNaN(c.dy)?a:c.dy+a,a+=r,a+=n,i.children.push(c)}),i}(o,n,a,i.height)}}}function Uh(t,e){var n=t.text,r=t["font-size"],i=t["font-family"],a=t.maxWidth;if(n="string"==typeof n?n:"".concat(n),void 0===a)return n;var o=e({text:n,fontSize:r,fontFamily:i}).width;if(o<=a)return n;for(var s=0,c=n.length-1;s<=c;){var u=Math.floor((s+c)/2);(o=e({text:n.substr(0,u)+jh,fontSize:r,fontFamily:i}).width)<=a?s=u+1:c=u-1}return n.substr(0,c)+jh}function $h(t){var e=t.baseline||t["dominant-baseline"],n=0,r=parseInt(t.fontSize||t["font-size"],10)||0;switch(e){case"hanging":n=.75*r;break;case"text-before-edge":n=.85*r;break;case"middle":n=.25*r;break;case"central":n=.35*r;break;case"mathemetical":n=r/2;break;case"text-after-edge":case"ideographic":n=.2*-r;break;default:n=0}return n}var Yh,Xh={},Kh={};function Gh(t){var e=t.text,n=t.fontSize,r=t.fontFamily,i=Kh[e+n+r];if(void 0!==i)return i;var a=(Yh=Yh||document.createElement("canvas")).getContext("2d");a.font="".concat(n," ").concat(r);var o=a.measureText(e).width;return Kh[e+n+r]=o,o}function Zh(t){var e=t.text,n=t.fontSize,r=t.fontFamily;return{width:Gh({text:e,fontSize:n,fontFamily:r}),height:function(t){var e=t.fontSize,n=t.fontFamily,r=Xh[e+n];if(void 0!==r)return r;var i=1.2*Gh({text:"M",fontSize:e,fontFamily:n});return Xh[e+n]=i,i}({fontSize:n,fontFamily:r})}}function Jh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zh,n=t["font-size"]||t.fontSize,r=t["font-family"]||t.fontFamily,i=e({text:t.text,fontFamily:r,fontSize:n}),a=Math.min(t.maxWidth||i.width,i.width),o=t.x||0,s=t.y||0,c=t.dx||0,u={x:0,y:s+((t.dy||0)+$h(t))-.75*i.height,width:a,height:i.height},l=t["text-anchor"]||t.anchor;return u.x="middle"===l?o+c-a/2:"end"===l?o+c-a:o+c,u}function Qh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zh,n=Vh(t);if(n){for(var r=t["font-size"]||t.fontSize,i=t["font-family"]||t.fontFamily,a=n(t,function(t){return e({text:t,fontFamily:i,fontSize:r})}),o=k({},t),s=0,c="",u=0,l=a.lines.length;u<l;u++){var h=a.lines[u];h+=u===l-1&&a.reduced?jh:"";var f=e({text:h,fontSize:r,fontFamily:i}).width;f>=s&&(s=f,c=h)}o.text=c;var d=Jh(o,e),p=d.height*Math.max(isNaN(t.lineHeight)?Dh:t.lineHeight,0)-d.height;return d.height=(d.height+p)*a.lines.length,d}return Jh(t,e)}function tf(t,e,n){var r=n.orientation,i=n.degree,a=n.stops,o=void 0===a?[]:a,s=null;if("radial"===r){var c=e.boundingRect();s=t.createRadialGradient(c.x+c.width/2,c.y+c.height/2,1e-5,c.x+c.width/2,c.y+c.height/2,Math.max(c.width,c.height)/2)}else{var u=ao(i),l=e.boundingRect();s=t.createLinearGradient(l.x+u.x1*l.width,l.y+u.y1*l.height,l.x+u.x2*l.width,l.y+u.y2*l.height)}for(var h=0,f=o.length;h<f;h++){var d=o[h];s.addColorStop(d.offset,d.color)}return s}function ef(t,e,n){return e.width=t.width,e.height=t.height,n.save(),n.fillStyle=t.fill,t.shapes.forEach(function(t){switch(t.type){case"rect":n.rect(t.x,t.y,t.width,t.height)}}),n.fill(),n.restore(),n.createPattern(e,"repeat")}function nf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.width,i=t.height,a=t.scaleRatio,o=t.margin,s=t.edgeBleed,c={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0},edgeBleed:{left:0,right:0,top:0,bottom:0,bool:!1}};return c.x=isNaN(e)?c.x:e,c.y=isNaN(n)?c.y:n,c.width=isNaN(r)?c.width:r,c.height=isNaN(i)?c.height:i,void 0!==a&&(c.scaleRatio.x=isNaN(a.x)?c.scaleRatio.x:a.x,c.scaleRatio.y=isNaN(a.y)?c.scaleRatio.y:a.y),void 0!==o&&(c.margin.left=isNaN(o.left)?0:o.left,c.margin.top=isNaN(o.top)?0:o.top),"object"===_(s)&&["left","right","top","bottom"].forEach(function(t){!isNaN(s[t])&&s[t]>0&&(c.edgeBleed[t]=s[t],c.edgeBleed.bool=!0)}),c.computedPhysical={x:Math.round(c.margin.left+(c.x-c.edgeBleed.left)*c.scaleRatio.x),y:Math.round(c.margin.top+(c.y-c.edgeBleed.top)*c.scaleRatio.y),width:Math.round((c.width+c.edgeBleed.left+c.edgeBleed.right)*c.scaleRatio.x),height:Math.round((c.height+c.edgeBleed.top+c.edgeBleed.bottom)*c.scaleRatio.y)},c}function rf(){var t={element:function(){},root:function(){},appendTo:function(){},render:function(){return!1},itemsAt:function(){return[]},findShapes:function(){return[]},clear:function(){},destory:function(){},size:function(){},measureText:Zh,textBounds:Qh,setKey:function(e){t.element().setAttribute("data-key",e)}};return t}function af(t){return function(e){var n=e.node;"text"!==n.type||null==n.data||n.textBoundsFn||(n.textBoundsFn=t.textBounds)}}var of=se();function sf(t){return Array.isArray(t)?t:"string"==typeof t?-1!==t.indexOf(",")?t.split(","):t.split(" "):[]}function cf(t,e){e.setTransform(t[0][0],t[1][0],t[0][1],t[1][1],t[0][2],t[1][2])}function uf(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Object.keys(r),a=0,o=n.length;a<o;a++){var s=n[a],c=s[0],u=s[1],l=s[2];if(c in e.attrs&&!(u in r)&&t[u]!==e.attrs[c]){var h=l?l(e.attrs[c]):e.attrs[c];"function"==typeof t[u]?t[u](h):t[u]=h}}for(var f=0,d=i.length;f<d;f++){var p=i[f];t[p]=r[p]}}function lf(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wh,i=!1,a=nf(),o=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"],["stroke-linejoin","lineJoin"],["stroke-dasharray","setLineDash",sf]],s=rf();return s.element=function(){return t},s.root=function(){return t},s.appendTo=function(e){return t||((t=e.ownerDocument.createElement("canvas")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),e.appendChild(t),t},s.render=function(c){if(!t)return!1;var u,l,h,f;n||(u=t.ownerDocument,l=u.createElement("canvas"),h=l.getContext("2d"),f={},n={create:function(t){var e=t.key;return e?(f[e]=f[e]||ef(t,l,h),f[e]):ef(t,l,h)},clear:function(){f={}}});var d=t.getContext("2d"),p=function(t){return("undefined"==typeof window?1:window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(d),g=a.scaleRatio.x,y=a.scaleRatio.y;i&&(t.style.left="".concat(a.computedPhysical.x,"px"),t.style.top="".concat(a.computedPhysical.y,"px"),t.style.width="".concat(a.computedPhysical.width,"px"),t.style.height="".concat(a.computedPhysical.height,"px"),t.width=Math.round(a.computedPhysical.width*p),t.height=Math.round(a.computedPhysical.height*p));var v={type:"container",children:c,transform:a.edgeBleed.bool?"translate(".concat(a.edgeBleed.left*p*g,", ").concat(a.edgeBleed.top*p*y,")"):""};1===p&&1===g&&1===y||(v.transform+="scale(".concat(p*g,", ").concat(p*y,")"));var m=r({items:[v],dpi:p,on:{create:[Hh(s.measureText),af(s)]}}),x=!e||!m.equals(e);n.clear();var b=i||x;return b&&(s.clear(),function t(e,n,r,i){for(var a=0,o=e.length;a<o;a++){var s=e[a],c={};n.save(),s.attrs&&(s.attrs.fill||s.attrs.stroke)&&(s.attrs.fill&&"object"===_(s.attrs.fill)&&"gradient"===s.attrs.fill.type?c.fillStyle=tf(n,s,s.attrs.fill):s.attrs.fill&&"object"===_(s.attrs.fill)&&"pattern"===s.attrs.fill.type&&(c.fillStyle=i.patterns.create(s.attrs.fill)),s.attrs.stroke&&"object"===_(s.attrs.stroke)&&"gradient"===s.attrs.stroke.type?c.strokeStyle=tf(n,s,s.attrs.stroke):s.attrs.stroke&&"object"===_(s.attrs.stroke)&&"pattern"===s.attrs.stroke.type&&(c.strokeStyle=i.patterns.create(s.attrs.stroke))),uf(n,s,r,c),s.modelViewMatrix&&cf(s.modelViewMatrix.elements,n),of.has(s.type)&&of.get(s.type)(s.attrs,{g:n,doFill:"fill"in s.attrs&&"none"!==s.attrs.fill,doStroke:"stroke"in s.attrs&&0!==s.attrs["stroke-width"]}),s.children&&t(s.children,n,r,i),n.restore()}}(m.children,d,o,{patterns:n})),i=!1,e=m,b},s.itemsAt=function(t){return e?e.getItemsFrom(t):[]},s.findShapes=function(t){return e?e.findShapes(t):[]},s.clear=function(){return t&&(t.width=t.width),e=null,s},s.size=function(t){if(t){var e=nf(t);JSON.stringify(a)!==JSON.stringify(e)&&(i=!0,a=e)}return a},s.destroy=function(){t&&(t.parentElement&&t.parentElement.removeChild(t),t=null),e=null},s}function hf(t,e){of.add(t,e)}var ff=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),df=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),pf=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]");function gf(t){return ff.test(t)}function yf(t){return df.test(t)||pf.test(t)}function vf(t){var e,n,r=t?t.length:0;for(e=0;e<r;e++){if(gf(n=t[e]))return"ltr";if(yf(n))return"rtl"}return"ltr"}var mf={start:"end",end:"start",center:"center",middle:"middle"};function xf(t,e){return"rtl"===e?mf[t]:t}function bf(t,e,n){for(var r=0,i=t.length;r<i;r++)t[r].object=n(t[r].content.type,e)}function wf(t,e){for(var n=0,r=t.length;n<r;n++)null!==t[n].object&&void 0!==t[n].object&&(e(t[n].object),t[n].object=null)}function kf(t,e,n,r,i,a){var o=function t(e,n){var r,i,a,o=[],s=[],c=[],u=[],l=function(t){return t.id},h=function(t,e){var n;return n="object"===_(t)?"id"in t?t.id:e:t,{content:t,id:"".concat(n,"__").concat(t.type||"")}};e.isTree||(e=e.map(h)),n=n.map(h),i=e.map(l),a=n.map(l);for(var f=0,d=n.length;f<d;f++)-1===i.indexOf(n[f].id)?o.push(n[f]):c.push(n[f]);for(var p=0,g=e.length;p<g;p++)-1===a.indexOf(e[p].id)?s.push(e[p]):u.push(e[p]);for(var y=0,v=o.length;y<v;y++)o[y].content.children&&(o[y].diff=t([],o[y].content.children),o[y].children=o[y].diff.updatedNew.concat(o[y].diff.added),o[y].children.isTree=!0);for(var m=0,x=c.length;m<x;m++)c[m].diff=t(u[m].children||[],c[m].content.children||[]),c[m].object=u[m].object,c[m].children=c[m].diff.items;return r=c.concat(o),o.isTree=!0,s.isTree=!0,c.isTree=!0,u.isTree=!0,r.isTree=!0,{added:o,updatedNew:c,updatedOld:u,removed:s,items:r}}(t,e);return bf(o.added,n,r),wf(o.removed,a),function t(e,n,r,i){for(var a,o=0,s=e.length;o<s;o++)null!==(a=e[o]).object&&void 0!==a.object&&(r(a.object,a.content),a.diff&&(bf(a.diff.added,a.object,n),wf(a.diff.removed,i),t(a.diff.items,n,r,i)))}(o.items,r,i,a),o.items}hf("rect",function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),n.rect(t.x,t.y,t.width,t.height),r&&n.fill(),i&&n.stroke()}),hf("circle",function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),n.moveTo(t.cx+t.r,t.cy),n.arc(t.cx,t.cy,t.r,0,2*Math.PI,!1),r&&n.fill(),i&&n.stroke()}),hf("line",function(t,e){var n=e.g,r=e.doStroke;n.beginPath(),n.moveTo(t.x1,t.y1),n.lineTo(t.x2,t.y2),r&&n.stroke()}),hf("path",function(t,e){var n=e.g,r=e.doStroke,i=e.doFill,a=new Path2D(t.d);i&&n.fill(a),r&&n.stroke(a)}),hf("text",function(t,e){var n=e.g,r=Uh(t,Zh);n.font="".concat(t["font-size"]," ").concat(t["font-family"]),n.canvas.dir=vf(t.text);var i="middle"===t["text-anchor"]?"center":t["text-anchor"];n.textAlign=xf(i,n.canvas.dir);var a=$h(t);n.fillText(r,t.x+t.dx,t.y+t.dy+a)});var Mf="http://www.w3.org/2000/svg",_f=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid type: ".concat(t));var n=e.ownerDocument.createElementNS(Mf,"container"===t?"g":t);return e.appendChild(n),n},Sf=function(t){t.parentNode&&t.parentNode.removeChild(t)},Rf=function(t,e){for(var n in e.attrs)if("stroke"===n&&e.strokeReference)t.setAttribute("stroke",e.strokeReference);else if("fill"===n&&e.fillReference)t.setAttribute("fill",e.fillReference);else if("text"===n){t.setAttribute("style","white-space: pre"),t.textContent=Uh(e.attrs,Zh);var r=vf(e.attrs.text);"rtl"===r&&(t.setAttribute("direction","rtl"),t.setAttribute("dir","rtl"),t.setAttribute("text-anchor",xf(t.getAttribute("text-anchor"),r)))}else if("text"!==e.type||"dy"!==n&&"dominant-baseline"!==n)if("text"===e.type&&"title"===n&&e.attrs.title){var i=t.ownerDocument.createElementNS(Mf,"title");i.textContent=e.attrs.title,t.appendChild(i)}else t.setAttribute(n,e.attrs[n]);else{var a=+t.getAttribute(n)||0,o=0;o="dominant-baseline"===n?$h(e.attrs):e.attrs[n],t.setAttribute("dy",o+a)}if("string"==typeof e.data||"number"==typeof e.data||"boolean"==typeof e.data)t.setAttribute("data",e.data);else if("object"===_(e.data)&&null!==e.data)for(var s in e.data)"string"!=typeof e.data[s]&&"number"!=typeof e.data[s]&&"boolean"!=typeof e.data[s]||t.setAttribute("data-".concat(s),e.data[s])},Af=function(){function t(e,n,r,i){S(this,t),this.create=e,this.nodeCreator=n,this.nodeMaintainer=r,this.nodeDestroyer=i}return A(t,[{key:"render",value:function(t,e){return this.create([],t,e,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),t}();function Cf(){return new Af(kf,_f,Rf,Sf)}function Nf(t){var e,n,r=0;if(0===(t=JSON.stringify(t)).length)return r;for(e=0,n=t.length;e<n;e++)r=(r<<5)-r+t.charCodeAt(e),r&=r;return r}function Of(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cf,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wh,o=r(),s=!1,c=nf(),u=rf(),l={type:"defs",children:[]},h=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nf,n={},r=Date.now();return{onCreate:function(i){var a={};i.node&&"object"===_(i.node.fill)&&"pattern"===i.node.fill.type&&i.node.fill.shapes&&(a.fill=i.node.fill),i.node&&"object"===_(i.node.stroke)&&"pattern"===i.node.stroke.type&&i.node.stroke.shapes&&(a.stroke=i.node.stroke),Object.keys(a).forEach(function(o){var s="",c=a[o],u=e(c),l="picasso-pattern-".concat(r,"-").concat(u);if("undefined"!=typeof window&&(s=window.location.href.split("#")[0]),!n[u]){var h={patternUnits:"userSpaceOnUse",x:0,y:0,width:c.width,height:c.height,type:"pattern",id:l,children:[],fill:c.fill};c.shapes.forEach(function(t){h.children.push(t)}),t.push(h),n[u]=!0}i.node["".concat(o,"Reference")]="url('".concat(s,"#").concat(l,"')")})},clear:function(){n={}}}}(l.children),f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nf,n={},r=Date.now(),i={getOrCreateGradient:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e(i[a]),c="picasso-gradient-".concat(r,"-").concat(s);if(!n[s]){var u=i[a],l=u.orientation,h=u.degree,f=u.stops,d=void 0===f?[]:f,p={};void 0===h&&(h=90),"radial"===l?p.type="radialGradient":(p=ao(h)).type="linearGradient",p.id=c,p.children=d.map(function(t){var e=t.offset,n=t.color,r=t.opacity;return{type:"stop",offset:"".concat(100*e,"%"),style:"stop-color:".concat(n,";stop-opacity:").concat(void 0!==r?r:1)}}),t.push(p),n[s]=c}return"url('".concat(o,"#").concat(c,"')")},onCreate:function(t){var e="";"undefined"!=typeof window&&(e=window.location.href.split("#")[0]);var n=t.node;n.fill&&"object"===_(n.fill)&&"gradient"===n.fill.type&&(n.fillReference=i.getOrCreateGradient(n,"fill",e)),n.stroke&&"object"===_(n.stroke)&&"gradient"===n.stroke.type&&(n.strokeReference=i.getOrCreateGradient(n,"stroke",e))},clear:function(){n={}}};return i}(l.children);return u.element=function(){return t},u.root=function(){return e},u.appendTo=function(n){return t||((t=n.ownerDocument.createElementNS(i,"svg")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none",t.setAttribute("xmlns",i),(e=n.ownerDocument.createElementNS(i,"g")).style.pointerEvents="auto",t.appendChild(e)),n.appendChild(t),t},u.render=function(r){if(!t)return!1;var i=c.scaleRatio.x,d=c.scaleRatio.y;s&&(t.style.left="".concat(c.computedPhysical.x,"px"),t.style.top="".concat(c.computedPhysical.y,"px"),t.setAttribute("width",c.computedPhysical.width),t.setAttribute("height",c.computedPhysical.height)),f.clear(),h.clear(),l.children.length=0;var p={type:"container",children:Array.isArray(r)?I(r).concat([l]):r,transform:c.edgeBleed.bool?"translate(".concat(c.edgeBleed.left*i,", ").concat(c.edgeBleed.top*d,")"):""};1===i&&1===d||(p.transform+="scale(".concat(i,", ").concat(d,")"));var g=a({items:[p],on:{create:[function(t){t.node.fillReference=void 0,t.node.strokeReference=void 0},f.onCreate,h.onCreate,Hh(u.measureText),af(u)]}}),y=!n||!g.equals(n),v=s||y;return v&&(u.clear(),o.render(g.children,e)),s=!1,n=g,v},u.itemsAt=function(t){return n?n.getItemsFrom(t):[]},u.findShapes=function(t){return n?n.findShapes(t):[]},u.clear=function(){if(!e)return u;n=null;var r=e.cloneNode(!1);return t.replaceChild(r,e),e=r,u},u.destroy=function(){t&&t.parentNode&&t.parentNode.removeChild(t),t=null,e=null},u.size=function(t){if(t){var e=nf(t);JSON.stringify(c)!==JSON.stringify(e)&&(s=!0,c=e)}return c},u}var Tf=function(){},Ef={},Df=[],zf=[];function jf(t,e){var n,r,i,a,o=zf;for(a=arguments.length;a-- >2;)Df.push(arguments[a]);for(e&&null!=e.children&&(Df.length||Df.push(e.children),delete e.children);Df.length;)if((r=Df.pop())&&void 0!==r.pop)for(a=r.length;a--;)Df.push(r[a]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&n?o[o.length-1]+=r:o===zf?o=[r]:o.push(r),n=i;var s=new Tf;return s.nodeName=t,s.children=o,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,s}function qf(t,e){for(var n in e)t[n]=e[n];return t}function Pf(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var If="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,Ff=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,Lf=[];function Bf(t){!t._dirty&&(t._dirty=!0)&&1==Lf.push(t)&&If(Wf)}function Wf(){for(var t;t=Lf.pop();)t._dirty&&sd(t)}function Vf(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function Hf(t){var e=qf({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function Uf(t){var e=t.parentNode;e&&e.removeChild(t)}function $f(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)Pf(n,null),Pf(r,t);else if("class"!==e||i)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"===a(r)){if("string"!=typeof n)for(var o in n)o in r||(t.style[o]="");for(var o in r)t.style[o]="number"==typeof r[o]&&!1===Ff.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var s=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,Yf,s):t.removeEventListener(e,Yf,s),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t){try{t[e]=null==r?"":r}catch(t){}null!=r&&!1!==r||"spellcheck"==e||t.removeAttribute(e)}else{var c=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?c?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(c?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function Yf(t){return this._listeners[t.type](t)}var Xf=[],Kf=0,Gf=!1,Zf=!1;function Jf(){for(var t;t=Xf.shift();)t.componentDidMount&&t.componentDidMount()}function Qf(t,e,n,r,i,a){Kf++||(Gf=null!=i&&void 0!==i.ownerSVGElement,Zf=null!=t&&!("__preactattr_"in t));var o=td(t,e,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--Kf||(Zf=!1,a||Jf()),o}function td(t,e,n,r,i){var a=t,o=Gf;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(a=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),ed(t,!0))),a.__preactattr_=!0,a;var s,c,u=e.nodeName;if("function"==typeof u)return function(t,e,n,r){var i=t&&t._component,a=i,o=t,s=i&&t._componentConstructor===e.nodeName,c=s,u=Hf(e);for(;i&&!c&&(i=i._parentComponent);)c=i.constructor===e.nodeName;i&&c&&(!r||i._component)?(od(i,u,3,n,r),t=i.base):(a&&!s&&(cd(a),t=o=null),i=id(e.nodeName,u,n),t&&!i.nextBase&&(i.nextBase=t,o=null),od(i,u,1,n,r),t=i.base,o&&t!==o&&(o._component=null,ed(o,!1)));return t}(t,e,n,r);if(Gf="svg"===u||"foreignObject"!==u&&Gf,u=String(u),(!t||!Vf(t,u))&&(s=u,(c=Gf?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,a=c,t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),ed(t,!0)}var l=a.firstChild,h=a.__preactattr_,f=e.children;if(null==h){h=a.__preactattr_={};for(var d=a.attributes,p=d.length;p--;)h[d[p].name]=d[p].value}return!Zf&&f&&1===f.length&&"string"==typeof f[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=f[0]&&(l.nodeValue=f[0]):(f&&f.length||null!=l)&&function(t,e,n,r,i){var a,o,s,c,u,l=t.childNodes,h=[],f={},d=0,p=0,g=l.length,y=0,v=e?e.length:0;if(0!==g)for(var m=0;m<g;m++){var x=l[m],b=x.__preactattr_,w=v&&b?x._component?x._component.__key:b.key:null;null!=w?(d++,f[w]=x):(b||(void 0!==x.splitText?!i||x.nodeValue.trim():i))&&(h[y++]=x)}if(0!==v)for(var m=0;m<v;m++){c=e[m],u=null;var w=c.key;if(null!=w)d&&void 0!==f[w]&&(u=f[w],f[w]=void 0,d--);else if(p<y)for(a=p;a<y;a++)if(void 0!==h[a]&&(k=o=h[a],_=i,"string"==typeof(M=c)||"number"==typeof M?void 0!==k.splitText:"string"==typeof M.nodeName?!k._componentConstructor&&Vf(k,M.nodeName):_||k._componentConstructor===M.nodeName)){u=o,h[a]=void 0,a===y-1&&y--,a===p&&p++;break}u=td(u,c,n,r),s=l[m],u&&u!==t&&u!==s&&(null==s?t.appendChild(u):u===s.nextSibling?Uf(s):t.insertBefore(u,s))}var k,M,_;if(d)for(var m in f)void 0!==f[m]&&ed(f[m],!1);for(;p<=y;)void 0!==(u=h[y--])&&ed(u,!1)}(a,f,n,r,Zf||null!=h.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||$f(t,r,n[r],n[r]=void 0,Gf);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||$f(t,r,n[r],n[r]=e[r],Gf)}(a,e.attributes,h),Gf=o,a}function ed(t,e){var n=t._component;n?cd(n):(null!=t.__preactattr_&&Pf(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||Uf(t),nd(t))}function nd(t){for(t=t.lastChild;t;){var e=t.previousSibling;ed(t,!0),t=e}}var rd=[];function id(t,e,n){var r,i=rd.length;for(t.prototype&&t.prototype.render?(r=new t(e,n),ud.call(r,e,n)):((r=new ud(e,n)).constructor=t,r.render=ad);i--;)if(rd[i].constructor===t)return r.nextBase=rd[i].nextBase,rd.splice(i,1),r;return r}function ad(t,e,n){return this.constructor(t,n)}function od(t,e,n,r,i){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===Ef.syncComponentUpdates&&t.base?Bf(t):sd(t,1,i)),Pf(t.__ref,t))}function sd(t,e,n,r){if(!t._disable){var i,a,o,s=t.props,c=t.state,u=t.context,l=t.prevProps||s,h=t.prevState||c,f=t.prevContext||u,d=t.base,p=t.nextBase,g=d||p,y=t._component,v=!1,m=f;if(t.constructor.getDerivedStateFromProps&&(c=qf(qf({},c),t.constructor.getDerivedStateFromProps(s,c)),t.state=c),d&&(t.props=l,t.state=h,t.context=f,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,c,u)?v=!0:t.componentWillUpdate&&t.componentWillUpdate(s,c,u),t.props=s,t.state=c,t.context=u),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!v){i=t.render(s,c,u),t.getChildContext&&(u=qf(qf({},u),t.getChildContext())),d&&t.getSnapshotBeforeUpdate&&(m=t.getSnapshotBeforeUpdate(l,h));var x,b,w=i&&i.nodeName;if("function"==typeof w){var k=Hf(i);(a=y)&&a.constructor===w&&k.key==a.__key?od(a,k,1,u,!1):(x=a,t._component=a=id(w,k,u),a.nextBase=a.nextBase||p,a._parentComponent=t,od(a,k,0,u,!1),sd(a,1,n,!0)),b=a.base}else o=g,(x=y)&&(o=t._component=null),(g||1===e)&&(o&&(o._component=null),b=Qf(o,i,u,n||!d,g&&g.parentNode,!0));if(g&&b!==g&&a!==y){var M=g.parentNode;M&&b!==M&&(M.replaceChild(b,g),x||(g._component=null,ed(g,!1)))}if(x&&cd(x),t.base=b,b&&!r){for(var _=t,S=t;S=S._parentComponent;)(_=S).base=b;b._component=_,b._componentConstructor=_.constructor}}for(!d||n?Xf.push(t):v||t.componentDidUpdate&&t.componentDidUpdate(l,h,m);t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);Kf||r||Jf()}}function cd(t){var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?cd(n):e&&(null!=e.__preactattr_&&Pf(e.__preactattr_.ref,null),t.nextBase=e,Uf(e),rd.push(t),nd(e)),Pf(t.__ref,null)}function ud(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function ld(){var t,e,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).createElement,r=void 0===n?document.createElement.bind(document):n,i=nf(),a=rf();return a.element=function(){return t},a.root=function(){return t},a.appendTo=function(e){return t||((t=r("div")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),e.appendChild(t),t},a.render=function(n){return!!t&&(t.style.left="".concat(i.computedPhysical.x,"px"),t.style.top="".concat(i.computedPhysical.y,"px"),t.style.width="".concat(i.computedPhysical.width,"px"),t.style.height="".concat(i.computedPhysical.height,"px"),r=Array.isArray(n)?jf("div",null,n):n,e=Qf(e,r,{},!1,t,!1),!0);var r},a.renderArgs=[jf],a.clear=function(){if(t){for(var n=t.firstChild;n;)t.removeChild(n),n=t.firstChild;e=null}return a},a.destroy=function(){t&&t.parentElement&&t.parentElement.removeChild(t),t=null,e=null},a.size=function(t){return t&&(i=nf(t)),i},a}qf(ud.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=qf(qf({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),Bf(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),sd(this,2)},render:function(){}});var hd=[function(t){t.renderer("svg",Of)},function(t){t.renderer("canvas",lf)},function(t){t.renderer("dom",ld)}],fd={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},dd=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.level,r=void 0===n?fd.OFF:n,i=e.pipe,a=void 0===i?console:i,o=r,s=(C(t={},fd.OFF,function(){}),C(t,fd.ERROR,function(){return a.error.apply(a,arguments)}),C(t,fd.WARN,function(){return a.warn.apply(a,arguments)}),C(t,fd.INFO,function(){return a.info.apply(a,arguments)}),C(t,fd.DEBUG,function(){return a.log.apply(a,arguments)}),t),c=function(t){if(t&&!(o<t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(s[t]||s[fd.DEBUG]).apply(void 0,n)}};return{log:c,error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[fd.ERROR].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[fd.WARN].concat(e))},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[fd.INFO].concat(e))},debug:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[fd.DEBUG].concat(e))},level:function(t){return"number"==typeof t&&(o=t),o},LOG_LEVEL:fd}};var pd=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=dd(e.logger),i={component:se(n.component),data:se(n.data),formatter:se(n.formatter),interaction:se(n.interaction),renderer:Jo(n.renderer),scale:se(n.scale),symbol:se(n.symbol),logger:r};function a(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t({palettes:e.palettes.concat(n.palettes||[]),style:k({},e.style,n.style),logger:n.logger||e.logger,renderer:n.renderer||e.renderer},i)}return e.renderer&&e.renderer.prio&&i.renderer.default(e.renderer.prio[0]),a.use=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(arguments.length>2?arguments[2]:void 0,e)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i)},a.chart=function(t){return Zo(t,{registries:i,logger:r,style:e.style,palettes:e.palettes})},a.config=function(){return e},Object.keys(i).forEach(function(t){a[t]=i[t]}),a.version=M.version,a}({renderer:{prio:["svg","canvas"]},logger:{level:0},style:{"$font-family":"'Source Sans Pro', Arial, sans-serif","$font-size":"12px","$line-height":"16px","$font-size--l":"16px","$gray-100":"#ffffff","$gray-98":"#f9f9f9","$gray-95":"#f2f2f2","$gray-90":"#e6e6e6","$gray-35":"#595959","$gray-30":"#4d4d4d","$gray-25":"#404040","$gray-20":"#333333","$border-95":"rgba(255, 255, 255, 0.05)","$border-90":"rgba(255, 255, 255, 0.1)","$border-80":"rgba(255, 255, 255, 0.2)","$border-20":"rgba(0, 0, 0, 0.2)","$border-10":"rgba(0, 0, 0, 0.1)","$border-5":"rgba(0, 0, 0, 0.05)","$primary-blue":"#3F8AB3","$primary-green":"#6CB33F","$primary-red":"#DC423F","$primary-orange":"#EF960F","$spacing--s":4,$spacing:8,"$spacing--l":12,"$font-color":"$gray-35","$font-color--inverted":"$gray-90","$guide-color":"$gray-90","$guide-color--inverted":"$gray-35",$border:"$border-80","$border--inverted":"$border-10",$shape:{fill:"$primary-blue",strokeWidth:1,stroke:"$border"},"$shape-outline":{stroke:"$primary-blue",strokeWidth:2},"$shape-guide":{stroke:"$guide-color",strokeWidth:1},"$shape-guide--inverted":{"@extend":"$shape-guide",stroke:"$guide-color--inverted"},$label:{fontSize:"$font-size",fontFamily:"$font-family",fill:"$font-color"},"$label--inverted":{$extend:"$label",fill:"$font-color--inverted"},"$label-overlay":{fontSize:"$font-size--l",fontFamily:"$font-family",fill:"$gray-100",color:"$font-color",stroke:"$guide-color--inverted",strokeWidth:1,borderRadius:4},$title:{"@extend":"$label",fontSize:"$font-size--l"},"$guide-line":{strokeWidth:1,stroke:"$guide-color"},"$guide-line--minor":{strokeWidth:1,stroke:"$gray-95"},"$padding--s":{left:"$spacing--s",right:"$spacing--s",top:"$spacing--s",bottom:"$spacing--s"},$padding:{left:"$spacing",right:"$spacing",top:"$spacing",bottom:"$spacing"},"$selection-area-target":{fill:"$primary-green",strokeWidth:0,opacity:.2}},palettes:[{key:"categorical",colors:[["#a54343","#d76c6c","#ec983d","#ecc43d","#f9ec86","#cbe989","#70ba6e","#578b60","#79d69f","#26a0a7","#138185","#65d3da"]]},{key:"diverging",colors:[["#3d52a1","#3a89c9","#77b7e5","#b4ddf7","#e6f5fe","#ffe3aa","#f9bd7e","#ed875e","#d24d3e","#ae1c3e"]]},{key:"sequential",colors:[["rgb(180,221,212)","rgb(34, 83, 90)"]]}]},{component:Qo,data:fs,formatter:ir,interaction:ds,renderer:Jo(),scale:wa,symbol:vo});vl.forEach(pd.use),hd.forEach(pd.use),[].forEach(pd.use);var gd=pd,yd=n(2),vd="Enter",md="Escape",xd="Esc",bd=[],wd=0,kd=function(t){var e=bd.filter(function(t){return t.selections&&t.selections.isActive()});e.length&&(t.key===vd?e.forEach(function(t){return t.selections.confirm()}):t.key!==md&&t.key!==xd||e.forEach(function(t){return t.selections.cancel()}))},Md=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.selections,n=t.brush,r=t.actions,i=t.picassoQ,a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).path,o=void 0===a?"/qHyperCubeDef":a;if(!e)return{release:function(){}};var s=++wd,c=null,u=[];e.on=e.on.bind(e),e.isActive=e.isActive.bind(e),e.addListener=e.addListener.bind(e),e.removeListener=e.removeListener.bind(e);var l=function(t){return n.brushes().forEach(function(e){"range"===e.type?n.clear([]):t[0]&&t[0].key!==e.id&&n.clear([])}),t.filter(function(t){return-2!==t.value})},h=function(t){return n.brushes().filter(function(t){return"value"===t.type}).length?(n.clear([]),t):(n.brushes().forEach(function(e){var r=e.id===t[0].key||-1!==u.indexOf(e.id)&&-1!==u.indexOf(t[0].key);"range"!==e.type||r||n.clear([])}),t)};n.intercept("set-ranges",h),n.intercept("toggle-ranges",h),n.intercept("toggle-values",l),n.intercept("set-values",l),n.intercept("add-values",l),n.on("start",function(){return e.begin(o)});var f,d,p={activate:function(){},deactivated:function(){return n.end()},cleared:function(){return n.clear()},canceled:function(){return n.end()}};return f=e,d=p,Object.keys(d).forEach(function(t){f.on(t,d[t])}),r&&r.select?(r.select.on("start",function(){n.start()}),r.select.on("end",function(){i.selections(n,{},c).forEach(function(t){return e.select(t)})})):n.on("update",function(){i.selections(n,{},c).forEach(function(t){return e.select(t)})}),0===bd.length&&document.addEventListener("keyup",kd),bd.push({key:s,selections:e}),{layout:function(t){c=t},allowSimultaneous:function(t){u=t},release:function(){c=null;var t,n,r=bd.indexOf(bd.filter(function(t){return t.key===s})[0]);-1!==r&&bd.splice(r,1),bd.length||document.removeEventListener("keyup",kd),t=e,n=p,Object.keys(n).forEach(function(e){t.removeListener(e,n[e])})}}},_d=n(0),Sd=n.n(_d);function Rd(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",e);return r.items.map(function(t){return i[t.value%i.length]})},valueAccessor:t.value}}function Ad(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",e);return r.items.map(function(t){return i[t.row.value%i.length]})},valueAccessor:t.value}}function Cd(t,e,n,r,i){var a=i.byRow,o=i.byElemNo;if(r&&(e.input.useDimColVal&&"libraryItem"===n.type||e.input.persistent||t.hc.qDimensionInfo.length>1||void 0===n.activeDimensionIndex&&t.hc.qSize.qcy>t.hc.qDataPages[0].qArea.qHeight))return o(r,r.raw().qCardinal);if(r){var s=e.pic.extract({field:r.key(),trackBy:r.value}).length;return a(r,s)}return{}}function Nd(t,e){var n=e.input.byDimDef||{activeDimensionIndex:0};if(n.activeDimensionIndex>=0){var r=t.hc.qDimensionInfo[n.activeDimensionIndex];n=r.coloring&&r.coloring.colorMapRef?{type:"libraryItem",key:r.coloring.colorMapRef,activeDimensionIndex:n.activeDimensionIndex}:{activeDimensionIndex:n.activeDimensionIndex}}return n}function Od(t,e){var n;return e.activeDimensionIndex>=0?n=t.pic.fields().filter(function(t){return"dimension"===t.type()})[e.activeDimensionIndex]:"libraryItem"===e.type?n=e.key?t.pic.field(function(t){return t.raw().colorMapRef===e.key}):void 0:"expression"===e.type&&(n=t.pic.field(function(t){return"colorByAlternative"===t.raw().id})),n}var Td=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.getCDef,a=void 0===i?Nd:i,o=r.getCByField,s=void 0===o?Od:o,c=r.getPersistence,u=void 0===c?Cd:c,l=a(e,n),h=s(n,l),f=h?h.raw():{},d=n&&n.pic?n.pic.raw():{};if(f.qError||f.qSize&&0===f.qSize.qcy&&!d.qHasOtherValues)return{invalid:!0};var p={mode:"field",fieldType:"dimension",type:"categorical",field:h?h.key():void 0};return("expression"===l.type||l.activeDimensionIndex<0)&&(p.label=l.label,"color.altLabel"===f.labelExpRef&&(p.label=n.input.altLabel)),!p.label&&h&&(p.label=h.title()),n.input.dimensionScheme&&(p.palettes={categorical:n.input.dimensionScheme}),n.input.useDimColVal&&"libraryItem"===l.type&&(p.auxiliary=l),Sd()(p,u(e,n,l,h,{byRow:Ad,byElemNo:Rd})),p},Ed=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Dd(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function zd(){}var jd="\\s*([+-]?\\d+)\\s*",qd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Id=/^#([0-9a-f]{3})$/,Fd=/^#([0-9a-f]{6})$/,Ld=new RegExp("^rgb\\("+[jd,jd,jd]+"\\)$"),Bd=new RegExp("^rgb\\("+[Pd,Pd,Pd]+"\\)$"),Wd=new RegExp("^rgba\\("+[jd,jd,jd,qd]+"\\)$"),Vd=new RegExp("^rgba\\("+[Pd,Pd,Pd,qd]+"\\)$"),Hd=new RegExp("^hsl\\("+[qd,Pd,Pd]+"\\)$"),Ud=new RegExp("^hsla\\("+[qd,Pd,Pd,qd]+"\\)$"),$d={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Yd(t){var e;return t=(t+"").trim().toLowerCase(),(e=Id.exec(t))?new Jd((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Fd.exec(t))?Xd(parseInt(e[1],16)):(e=Ld.exec(t))?new Jd(e[1],e[2],e[3],1):(e=Bd.exec(t))?new Jd(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Wd.exec(t))?Kd(e[1],e[2],e[3],e[4]):(e=Vd.exec(t))?Kd(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Hd.exec(t))?tp(e[1],e[2]/100,e[3]/100,1):(e=Ud.exec(t))?tp(e[1],e[2]/100,e[3]/100,e[4]):$d.hasOwnProperty(t)?Xd($d[t]):"transparent"===t?new Jd(NaN,NaN,NaN,0):null}function Xd(t){return new Jd(t>>16&255,t>>8&255,255&t,1)}function Kd(t,e,n,r){return r<=0&&(t=e=n=NaN),new Jd(t,e,n,r)}function Gd(t){return t instanceof zd||(t=Yd(t)),t?new Jd((t=t.rgb()).r,t.g,t.b,t.opacity):new Jd}function Zd(t,e,n,r){return 1===arguments.length?Gd(t):new Jd(t,e,n,null==r?1:r)}function Jd(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Qd(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function tp(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ep(t,e,n,r)}function ep(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function np(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function rp(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}Ed(zd,Yd,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Ed(Jd,Zd,Dd(zd,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Jd(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Jd(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Qd(this.r)+Qd(this.g)+Qd(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Ed(ep,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ep)return new ep(t.h,t.s,t.l,t.opacity);if(t instanceof zd||(t=Yd(t)),!t)return new ep;if(t instanceof ep)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new ep(o,s,c,t.opacity)}(t):new ep(t,e,n,null==r?1:r)},Dd(zd,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ep(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ep(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Jd(np(t>=240?t-240:t+120,i,r),np(t,i,r),np(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var ip=function(t){return function(){return t}};function ap(t,e){return function(n){return t+n*e}}function op(t){return 1==(t=+t)?sp:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):ip(isNaN(e)?n:e)}}function sp(t,e){var n=e-t;return n?ap(t,n):ip(isNaN(t)?e:t)}var cp=function t(e){var n=op(e);function r(t,e){var r=n((t=Zd(t)).r,(e=Zd(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=sp(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function up(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Zd(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}up(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return rp((n-r/e)*e,o,i,a,s)}}),up(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return rp((n-r/e)*e,i,a,o,s)}});function lp(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var hp=/^class(-pyramid)?/,fp=function(t,e,n,r){var i=void 0!==n.min?n.min:r.min(),a=void 0!==n.max?n.max:r.max(),o=e.limits,s={},c="percent"===e.limitType?o.map(function(t){return i+(a-i)*t}):o;i=Math.min.apply(Math,[i].concat(lp(c))),a=Math.max.apply(Math,[a].concat(lp(c))),s.min=i,s.max=a;var u=e.colors.map(function(e){return t.resolveUIColor(e)});if(e.breakTypes&&-1===e.breakTypes.indexOf(!0))s.type="categorical",s.range=[u[0]].concat(lp(u),[u[u.length-1]]),s.domain=[i].concat(lp(c),[a]);else if(e.breakTypes){var l=e.breakTypes;s.type="continuous",s.domain=[i],s.range=[u[0]];for(var h=0;h<c.length;h+=1)if(l[h]){var f=u[h],d=u[h+1],p=cp(f,d)(.5);s.range.push(p),s.domain.push(c[h]),h<c.length-1&&l[h+1]&&(s.range.push(u[h+1]),s.domain.push((c[h]+c[h+1])/2))}else s.range.push(u[h]),s.range.push(u[h+1]),s.domain.push(c[h]),s.domain.push(c[h]+Math.min(1e-6,(a-i)/1e6));s.range.push(u[u.length-1]),s.domain.push(a)}else s.domain=c,s.range=u;return s};var dp=function(t,e,n,r){var i,a,o=e.senseTheme,s=e.hc,c=r.f,u={mode:"field",fieldType:"measure",field:c?c.key():void 0,reverse:n.input.reverseScheme||!1,type:"continuous",range:function(t){return t.resources.theme.palette("quant")}},l=[],h=!0;if(c){if(Number.isNaN(+c.min())||Number.isNaN(+c.max()))return{invalid:!0};(h=!("S"===(i=n.pic.raw()).qMode&&i.qDataPages[0]&&i.qSize.qcy>i.qDataPages[0].qArea.qHeight||"K"===i.qMode&&i.qStackedDataPages[0]&&i.qSize.qcy>i.qStackedDataPages[0].qArea.qHeight))&&(l=n.pic.extract({field:0,props:{num:{field:c.key()},exclude:{fields:s.qDimensionInfo.map(function(t,e){return{field:"qDimensionInfo/".concat(e)}}),value:function(t){return Math.min.apply(Math,lp(t))<0}}}}).filter(function(t){return t.value>=0&&!t.exclude.value}).map(function(t){return t.num.value}).filter(function(t){return"number"==typeof t}))}if(!1===n.input.autoMinMax){if(u.min=n.input.measureMin,u.max=n.input.measureMax,u.max<u.min)return{invalid:!0}}else if(c&&!h)u.min=c.min(),u.max=c.max();else if(c){if(!l.length)return{invalid:!0};u.min=Math.min.apply(Math,lp(l)),u.max=Math.max.apply(Math,lp(l))}if(n.input.measureScheme&&(u.palettes={quant:n.input.measureScheme}),o&&o.properties.scales){var f=o.properties.scales.filter(function(t){return t.propertyValue===n.input.measureScheme})[0];u.type=f&&hp.test(f.type)?"categorical":"continuous","categorical"===u.type&&(a=Math.max.apply(Math,lp(f.scale.map(function(t){return t?t.length:0}))))}if("categorical"===u.type){for(var d=h?function t(e,n,r,i,a){var o,s,c,u=0,l=[],h=(e-n)/(i+1);if(0===h)return 1;for(o=0;o<r.length;o+=1)s=.99*(r[o]-n),c=r[o]>e?Math.floor(e/h):r[o]<n?0:Math.floor(s/h),Number.isNaN(c)||(l[c]?l[c]+=1:l[c]=1);for(o=0;o<l.length;o+=1)l[o]&&(u+=1);return u<=i||u>=a?Math.max(u,i):t(e,n,r,i+1,a)}(u.max,u.min,l,1,a):a,p=(u.max-u.min)/d,g=[],y=0;y<d+1;y+=1)g.push(u.min+p*y);u.domain=g,u.range=function(t){for(var e=t.resources.theme.palette("quant",d),n=Math.max(1,Math.floor(e.length/d)),r=[],i=0;i<d;i+=1)r.push(e[i*n]);return[r[0]].concat(r,[r[r.length-1]])}}return u};function pp(t,e){var n;return e.activeMeasureIndex>=0?n=t.pic.fields().filter(function(t){return"measure"===t.type()})[e.activeMeasureIndex]:"libraryItem"===e.type?n=t.pic.field(function(t){return t.raw().colorMapRef===e.key&&void 0!==e.key}):"expression"===e.type&&(n=t.pic.field(function(t){return"colorByAlternative"===t.raw().id})),n||(n=t.pic.field(function(t){return void 0!==t.raw().matchMeasure}))&&(n=t.pic.fields().filter(function(t){return"measure"===t.type()})[n.raw().matchMeasure]),n}var gp=function(t,e,n){var r=e.senseTheme,i=e.hc,a=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).getCField,o=void 0===a?pp:a,s=n.input.byMeasureDef||{activeMeasureIndex:0},c=o(n,s),u=dp(0,{senseTheme:r,hc:i},n,{f:c});if(u.invalid)return u;if(("expression"===s.type||s.activeMeasureIndex<0)&&(u.label=s.label,c&&"color.altLabel"===c.raw().labelExpRef&&(u.label=n.input.altLabel)),!u.label&&c&&(u.label=c.title()),n.input.useMeasureGradient&&"libraryItem"===s.type)if(s.activeMeasureIndex>=0){var l=c.raw().coloring;l&&l.gradient&&Sd()(u,fp(t,l.gradient,u,c))}else u.auxiliary=s;return u},yp=function(t,e,n,r){var i=e.hc,a=e.senseTheme,o=e.translator,s=n.pic.field(function(t){return"colorByExpression"===t.raw().id});if(!(s&&s.raw().qFallbackTitle&&Number.isFinite(s.raw().qMin)&&Number.isFinite(s.raw().qMax)))return{mode:"constant",type:"constant",primary:r.nil};if(n.input.expressionIsColor)return{mode:"field",fieldType:"expression",field:s?s.key():void 0,type:"color"};var c=dp(0,{hc:i,senseTheme:a},n,{f:s});return c.invalid?c:(c.label=n.input.expressionLabel||o.get("Object.ChartTooltip.ColorExpression"),c)},vp=function(t,e,n,r){var i=e.hc,a=e.senseTheme,o=e.translator,s=n.input.useBaseColors;if(("byMultiple"===n.input.mode||"primary"===n.input.mode&&"measure"===n.input.useBaseColors)&&i.qMeasureInfo.length>1&&(s="measure"),"measure"===s){var c=[],u=[];"measure"===n.input.useBaseColors&&i.qMeasureInfo.forEach(function(e,n){e.coloring&&e.coloring.baseColor&&(c.push(n),u.push(t.resolveUIColor(e.coloring.baseColor)))});var l=n.input.dimensionScheme?{categorical:n.input.dimensionScheme}:void 0;return"measure"===n.input.useBaseColors&&a&&a.properties.palettes&&a.properties.palettes.data[0]&&(l={categorical:a.properties.palettes.data[0].propertyValue}),{mode:"measure",type:"categorical",palettes:l,label:o?o.get("Common.Measures"):void 0,explicit:c.length?{domain:c,range:u}:void 0}}if("dimension"===s){var h=[],f=[];return i.qDimensionInfo.forEach(function(e,n){e.coloring&&e.coloring.baseColor&&(h.push(n),f.push(t.resolveUIColor(e.coloring.baseColor)))}),{mode:"dimension",type:"categorical",field:h.length?h[0]:void 0,explicit:h.length?{domain:h,range:f}:void 0}}var d=r.primary;return void 0!==n.input.paletteColor?n.input.paletteColor&&(d=t.resolveUIColor(n.input.paletteColor)):void 0!==n.input.singleColor&&void 0!==n.input.singleColor&&(d=t.resolveUIColor({index:n.input.singleColor})),{mode:"constant",type:"constant",primary:d}};function mp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xp=function(t,e,n){for(var r={},i=0;i<t.length;i+=1)r[t[i].value]=t[i].baseColor;var a=[];return{domain:function(t){var i=t.data,o=[];a=[];for(var s=0;s<i.items.length;s++){var c=i.items[s],u=(c.text||c).label;r[u]&&-1===o.indexOf(c.value)&&(o.push(c.value),a.push(e.resolveUIColor(r[u])))}return o.push(-3,-2),a.push(n.others),a.push(n.nil),o},range:function(){return a}}};var bp=function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){mp(t,e,n[e])})}return t}({hc:null,colorProps:null,layout:null,senseTheme:null},t),n={},r={auto:function(){return{mode:"primary"}},getDimensionColorMap:function(){return Promise.reject()},getMeasure:function(){return Promise.reject()},getAttributeDimension:function(){return Promise.reject()}},i={auto:function(t){return t?(r.auto=t,i):r.auto},getDimensionColorMap:function(t){return t?(r.getDimensionColorMap=t,i):r.getDimensionColorMap},getAttributeDimension:function(t){return t?(r.getAttributeDimension=t,i):r.getAttributeDimension},getMeasure:function(t){return t?(r.getMeasure=t,i):r.getMeasure},set:function(t){if(!t.colorProps)throw new Error('Missing "colorProps"');if(Sd()(e,t),(n={pic:e.picasso.data("q")({data:e.hc}),input:e.colorProps}).input.auto){var i=r.auto(t.layout);n.input=Sd()(!0,{},n.input,i,{auto:!1});var a=e.senseTheme&&e.senseTheme.properties.palettes;a&&a.data&&(n.input.dimensionScheme=a.data[0].propertyValue);var o=0;n.input.byDimDef&&+n.input.byDimDef.activeDimensionIndex>=0&&(o=+n.input.byDimDef.activeDimensionIndex),e.hc&&e.hc.qDimensionInfo[o]&&e.hc.qDimensionInfo[o].coloring&&e.hc.qDimensionInfo[o].coloring.colorMapRef&&n.input.byDimDef&&(n.input.byDimDef.type="libraryItem",n.input.byDimDef.key=e.hc.qDimensionInfo[o].coloring.colorMapRef)}},palettes:function(){if(!n.palettes){var t=e.senseTheme;if(!t)return n.palettes=[],n.palettes;var r=[];Object.keys(t.properties.dataColors||{}).forEach(function(e){r.push({key:e.replace("Color",""),colors:[t.properties.dataColors[e]]})}),(t.properties.palettes.ui||[]).forEach(function(t){r.push({key:"ui",colors:t.colors})}),n.palettes=r}return n.palettes},getAuxiliaryData:function(t){if(!t.auxiliary&&!/qAttrDimInfo/.test(t.field))return Promise.resolve();var n=(t.auxiliary||{}).key;if("measure"===t.fieldType)return r.getMeasure(n,e).catch(function(){});if("dimension"===t.fieldType){var i="/qHyperCubeDef/".concat(t.field).replace("qDimensionInfo","qDimensions").replace("qAttrDimInfo","qAttributeDimensions");return Promise.all([/qAttrDimInfo/.test(t.field)?r.getAttributeDimension(i,e).catch(function(){}):Promise.resolve(),n?r.getDimensionColorMap(n,e).catch(function(){}):Promise.resolve()])}return Promise.resolve()},getAuxiliarySettings:function(t){var r=this;return t.auxiliary||/qAttrDimInfo/.test(t.field)?(this.palettes(),this.getAuxiliaryData(t).then(function(i){if(!i)return{};if("measure"===t.fieldType){if(i.coloring&&i.coloring.gradient){var a=n.pic.field(t.field);return fp(r,i.coloring.gradient,t,a)}return{}}if("dimension"===t.fieldType){var o={nil:t.nil,others:t.others},s=i[0],c=i[1]?i[1].colorMap:null;if(s){var u=e.picasso.data("q")({data:{qDimensionInfo:[n.pic.field(t.field).raw(),n.pic.field(t.field).raw()],qMeasureInfo:[],qDataPages:s,qInterColumnSortOrder:[0,1],qMode:"S"}});o.legendDataset=u}if(!c)return o;if(c.nul&&(o.nil=r.resolveUIColor(c.nul)),c.oth&&(o.others=r.resolveUIColor(c.oth)),c.usePal){o.palettes={categorical:c.pal};var l=e.senseTheme&&e.senseTheme.properties.palettes;l&&!c.pal&&l.data&&l.data[0]&&(o.palettes.categorical=l.data[0].propertyValue)}else if(!1===c.autoFill&&c.single)o.range=[r.resolveUIColor(c.single)];else if(c.autoFill){var h=e.senseTheme&&e.senseTheme.properties.palettes;h&&h.data&&h.data[0]&&(o.palettes={categorical:h.data[0].propertyValue}),Sd()(o,Rd(n.pic.field(t.field)))}return c.colors&&c.colors.length&&(o.explicit=xp(c.colors,r,o)),o}return{}})):Promise.resolve()},resolveUIColor:function(t){if(t.index<0||void 0===t.index)return t.color;if(void 0===n.uiPalette&&(n.uiPalette=this.palettes().filter(function(t){return"ui"===t.key})[0]||!1),!n.uiPalette)return t.color;var e="none"===n.uiPalette.colors[0]?t.index:t.index-1;return void 0===n.uiPalette.colors[e]?t.color:n.uiPalette.colors[e]},settings:function(){var t=this;if(this.palettes(),!n.settings){var r={primary:"steelblue",others:"#aaa",nil:"#ddd"},i=e.senseTheme;i&&i.properties.dataColors&&(i.properties.dataColors.primaryColor&&(r.primary=i.properties.dataColors.primaryColor),i.properties.dataColors.othersColor&&(r.others=i.properties.dataColors.othersColor),i.properties.dataColors.nullColor&&(r.nil=i.properties.dataColors.nullColor)),n.settings=Sd()(r,function(){if(n.input&&!n.input.auto){if("byMeasure"===n.input.mode)return gp(t,e,n);if("byDimension"===n.input.mode)return Td(t,e,n);if("byExpression"===n.input.mode)return yp(t,e,n,r);if("byMultiple"===n.input.mode)return vp(t,e,n,r);if("primary"===n.input.mode)return vp(t,e,n,r)}return{}}())}return n.settings}};return i},wp=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.auto,n=t.resources;return bp(n).auto(e||function(){return{mode:"byDimension",persistent:!1,useDimColVal:!0,byDimDef:{activeDimensionIndex:0,type:"expression",label:""}}}).getDimensionColorMap(function(t,e){return function(t,e,n){var r=e.layout,i=e.app;return r&&r.snapshotData?r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.dimValsData?n.Promise.resolve({colorMap:r.snapshotData.content.chartData.dimValsData}):n.Promise.reject():i&&i.getObject?i.getObject("ColorMapModel_".concat(t)).then(function(t){return t.getLayout()}):n.Promise.reject()}(t,{layout:e.layout,app:e.app},n)}).getMeasure(function(t,e){return function(t,e,n){var r=e.layout,i=e.app;return r&&r.snapshotData?r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.measureGradient?n.Promise.resolve({coloring:{gradient:r.snapshotData.content.chartData.measureGradient}}):n.Promise.reject():i&&i.getMeasure?i.getMeasure(t).then(function(t){return t.getMeasure()}):n.Promise.reject()}(t,{layout:e.layout,app:e.app},n)}).getAttributeDimension(function(t,e){return function(t,e,n){var r=e.layout,i=e.model,a=e.app;if(r&&r.snapshotData)return r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.legendDataPage?n.Promise.resolve(r.snapshotData.content.chartData.legendDataPage):n.Promise.reject();if(i&&i.session&&a)return i.getHyperCubeData(t,[{qHeight:100,qLeft:0,qTop:0,qWidth:2}]);return n.Promise.reject()}(t,{layout:e.layout,model:e.model,app:e.app},n)})};function kp(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _p(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Sp(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hc,n=t.coloring,r=t.rtl,i=t.key,a=t.source,o=t.picasso,s={},c=i;if(n){var u={override:!0,domain:n.explicit&&"function"==typeof n.explicit.domain?n.explicit.domain:_p((n.explicit||{}).domain||[]).concat([-3,-2]),range:n.explicit&&"function"==typeof n.explicit.range?n.explicit.range:_p((n.explicit||{}).range||[]).concat([n.others,n.nil])};if("field"===n.mode){if("dimension"===n.fieldType){var l,h=0,f={extract:[{source:"dummy",field:0,filter:function(){return h=0,!1}},{source:a,field:n.field,trackBy:n.valueAccessor,reduce:"first",props:{row:{reduce:function(){return h++}},text:{value:function(t){return t.qText},reduce:"first"}}}]};if(n.legendDataset){var d=0,p={};o.data("q")({data:e}).extract({field:n.field,trackBy:n.valueAccessor,reduce:function(t){var e=t[0];return p[e]=d++,t[0]}}),l={source:"attrDim",extract:{field:"qDimensionInfo/0",filter:function(t){return t.qElemNumber>=0},props:{row:{value:function(t){return p[t.qElemNumber]}}}}}}var g={data:f,range:n.range,domain:n.domain,explicit:u,type:"categorical-color",label:function(t){return t.datum.text&&t.datum.text.value?t.datum.text.value:t.datum.label}};s[c]=g,l&&(s["".concat(c,"Legend")]=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Mp(t,e,n[e])})}return t}({},g,{data:l})),e&&e.qHasOtherValues&&l&&((l||g.data).amend=[{label:e.qDimensionInfo[0].othersLabel,source:{key:"qHyperCube",field:"qDimensionInfo/0"},row:{value:-3},value:-3}])}else if("measure"===n.fieldType){var y={data:{field:n.field},min:n.min,max:n.max};s[c]=Sd()({},y,{type:"categorical"===n.type?"threshold-color":"sequential-color",range:n.range,domain:n.domain,invert:n.reverse}),"sequential-color"===s[c].type&&(s["".concat(c,"Range")]=Sd()({},y,{invert:!!r}))}else if("color"!==n.type)throw new Error("UNUSED FIELD")}else if("dimension"===n.mode){var v={data:e.qDimensionInfo.map(function(t,e){return e}),label:function(t){return e.qDimensionInfo[t.datum.value].qFallbackTitle},explicit:u,type:"categorical-color"};s[c]=v}else if("measure"===n.mode){var m={data:e.qMeasureInfo.map(function(t,e){return e}),label:function(t){return e.qMeasureInfo[t.datum.value].qFallbackTitle},explicit:u,type:"categorical-color"};s[c]=m}}return s}var Rp=function(t){var e,n=t.coloring,r=t.scales,i=t.key,a=n.nil,o=n.others,s=n.primary,c=i,u=i;return n.invalid?e=function(t){return-3===t.datum.value||t.datum["".concat(u,"IsAnOther")]&&t.datum["".concat(u,"IsAnOther")].value?o:a}:r[c]?e=function(t){return-3===t.datum.value?o:-2===t.datum.value||-2===t.datum[u].value&&"dimension"===n.fieldType||"NaN"===t.datum[u].value?a:t.datum["".concat(u,"IsAnOther")]&&t.datum["".concat(u,"IsAnOther")].value?o:t.resources.scale(c)(t.datum[u].value)}:"constant"===n.mode?e=function(t){return-3===t.datum.value||t.datum["".concat(u,"IsAnOther")]&&t.datum["".concat(u,"IsAnOther")].value?o:-2===t.datum.value?a:s}:"color"===n.type&&(e=function(t){return-3===t.datum.value||t.datum["".concat(u,"IsAnOther")]&&t.datum["".concat(u,"IsAnOther")].value?o:-2===t.datum.value?a:t.datum[u].value}),e},Ap=function(t,e,n){var r=t&&t.dock||void 0;if("auto"!==r)return r||"right";if(e){var i=e.element.getBoundingClientRect();if(i.height>i.width)return"bottom"}return n?"left":"right"},Cp=function(t,e,n){return!(n.invalid||"color"===n.type||"measure"===n.mode&&e.qMeasureInfo.length<=1||"dimension"===n.mode)&&!1!==t.show};function Np(t,e){var n=t.styleReference,r=t.chart,i=t.rtl,a=e.legendProps,o=e.coloring,s=e.senseTheme,c=e.hc;return{minimumLayoutMode:"MEDIUM",dock:Ap(a,r,i),show:Cp(a,c,o),renderer:"svg",mounted:function(t){t.children[0].style.pointerEvents="none"},settings:{title:{show:!1!==a.showTitle,wordBreak:"break-word",maxLines:2,lineHeight:1.2,text:o.label||"",fill:s?s.getStyle(n,"legend.title","color"):void 0,fontSize:s?s.getStyle(n,"legend.title","fontSize"):void 0}}}}function Op(t,e){return"categorical"===e.coloring.type?function(t,e){var n=Np(t,e),r=t.key,i=t.styleReference,a=t.viewState,o=t.rtl,s=e.scaleKey,c=e.senseTheme,u=e.scales,l={up:"top",down:"bottom",left:"left",right:"right"},h="".concat(s,"Legend");return Sd()(!0,n,{type:"legend-cat",key:"".concat(r,"-cat"),scale:h in u?h:s,settings:{layout:{scrollOffset:function(){return a?a.get("legendScrollOffset"):void 0},size:-1!==["top","bottom"].indexOf(n.dock)?2:1,direction:o?"rtl":"ltr"},item:{show:function(t){return-2!==t.datum.value},label:{fill:c?c.getStyle(i,"legend.label","color"):void 0,fontSize:c?c.getStyle(i,"legend.label","fontSize"):void 0}},navigation:{button:{class:{"lui-fade-button":!0},content:function(t,e){var n=e.direction;return t("span",{style:{"pointer-events":"none"},class:"lui-button__icon lui-icon lui-icon--triangle-".concat(l[n])})}}}},brush:{consume:[{context:"selection",data:["",r],style:{inactive:{opacity:.3}}}]}})}(t,e):"continuous"===e.coloring.type&&function(t,e){var n=t.key,r=t.styleReference,i=t.rtl,a=e.scaleKey,o=e.senseTheme,s=Np(t,e);return Sd()(!0,s,{type:"legend-seq",key:"".concat(n,"-seq"),settings:{fill:a,major:"".concat(a,"Range"),length:1,tick:{fill:o?o.getStyle(r,"legend.label","color"):void 0,fontSize:o?o.getStyle(r,"legend.label","fontSize"):void 0},title:{anchor:!i||"top"!==s.dock&&"bottom"!==s.dock?void 0:"right"}}})}(t,e)}function Tp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ep=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.eventName,r=e.key,i=e.requireFailure,a=e.recognizeWith,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:pan-".concat(r),type:"Pan",requireFailure:i,recognizeWith:a,options:{event:n,pointers:1,threshold:10,enable:function(t,e){return this.started===n||!e||!(o&&o.interact&&!o.interact.enabled())&&this.chart.componentsFromPoint({x:e.center.x,y:e.center.y}).some(function(t){return t.key==="".concat(r,"-cat")})}},events:(t={},Tp(t,"".concat(n,"start"),function(t){t.preventDefault(),this.started!==n&&(this.started=n,this.chart.component("".concat(r,"-cat")).emit("panstart",t))}),Tp(t,"".concat(n,"move"),function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panmove",t)}),Tp(t,"".concat(n,"end"),function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panend",t),this.started=!1}),t)}},Dp=function(t){var e=t.key,n=t.requireFailure,r=t.recognizeWith,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:tap-".concat(e),type:"Tap",requireFailure:n,recognizeWith:r,options:{event:"legendtap",interval:10,pointers:1,enable:function(t,n){if(!n)return!0;if(i&&i.interact&&!i.interact.enabled())return!1;if(!this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some(function(t){return t.key==="".concat(e,"-cat")}))return!1;var r=n.srcEvent.target;return!!(r&&r.hasAttribute("data-action")&&r.hasAttribute("data-component-key"))||!(!r||!r.childNodes[0]||"BUTTON"!==r.childNodes[0].nodeName)}},events:{legendtap:function(t){t.preventDefault();var e=t.srcEvent.target;e&&e.hasAttribute("data-action")&&e.hasAttribute("data-component-key")&&this.chart.component(e.getAttribute("data-component-key")).emit(e.getAttribute("data-action"))}}}},zp=function(t,e,n){var r=[],i=[],a=Op(t,e);return r.push(a),a&&"legend-cat"===a.type&&(i.push(Dp(t,n)),i.push(Ep(t,n))),{interactions:i,components:r}};var jp=function(t){var e,n,r=t.hc,i=t.coloring,a=t.scales,o=t.key,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=o,u=i.nil;a[o]&&"field"===i.mode?e=a[o].data.field||i.field:"field"===i.mode&&i.field&&(e=i.field),e?(n={field:e,reduce:"first"},"color"===i.type&&(n.value=function(t){return"NaN"!==t.qNum?(e=t.qNum,"rgba(".concat([(16711680&e)>>16,(65280&e)>>8,255&e,((4278190080&e)>>>24)/255].join(","),")")):t.qText&&Yd(t.qText)?t.qText:u;var e})):"dimension"===i.mode?n=void 0!==i.field?i.field:r.qDimensionInfo.length-1:"measure"===i.mode&&(n=s);var l=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},c,n);return r.qDimensionInfo.length>1&&(l["".concat(c,"IsAnOther")]={fields:r.qDimensionInfo.map(function(t,e){return{field:"qDimensionInfo/".concat(e)}}),value:function(t){return-1!==t.indexOf(-3)}}),l};function qp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Pp(t,e,n[e])})}return t}function Pp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ip(t){var e=wp({resources:t}),n={},r={},i=function(t){return r.settings||(t||console.warn("settings() called before auxiliarySettings()"),r.settings=e.settings()),r.settings},a={config:function(i){if(n=qp({},i),r={},!n.key)throw new Error("Missing key");e.set(qp({},t,n))},auto:function(t){return t?(e.auto(t),a):e.auto()},getAuxiliarySettings:function(){return r.auxiliarySettings?Promise.resolve(r.auxiliarySettings):e.getAuxiliarySettings(i(!0)).then(function(t){return r.auxiliarySettings=t,r.settings=qp({},r.settings,r.auxiliarySettings),t})},getAuxiliaryData:function(){return e.getAuxiliaryData(i())},resolveUIColor:function(t){return e.resolveUIColor(t)},settings:function(){var t=i();return{mode:t.mode,type:t.type,label:t.label,field:t.field,fieldType:t.fieldType}},palettes:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.colorProps,n=t.coloring,r=t.theme,i=[];if(n&&n.palettes&&r){var a=n.palettes.categorical||e.dimensionScheme,o=r.properties.palettes.data.filter(function(t){return t.propertyValue===a})[0];o&&i.push({key:"categorical",colors:o.scale});var s=n.palettes.metric||e.measureScheme,c=r.properties.scales.filter(function(t){return t.propertyValue===s})[0];if(c){var u=c.scale[0]?c.scale:[[]].concat(kp(c.scale.slice(1)));u=Array.isArray(u[0])?u.map(function(t){return t.slice().reverse()}):u.slice().reverse(),i.push({key:"quant",colors:u})}}return i}({coloring:i(),colorProps:n.colorProps,theme:n.senseTheme})},scales:function(){return r.scales=r.scales||Sp({hc:n.hc,coloring:i(),key:n.key,source:n.source,picasso:t.picasso}),r.scales},color:function(){return r.color=r.color||Rp({coloring:i(),scales:this.scales(),key:n.key}),r.color},datumProps:function(t){return jp({coloring:i(),scales:this.scales(),key:n.key,hc:n.hc},t)},data:function(){var t=i(),e={key:"dummy",data:[["field"],["a"]]};return t.legendDataset?[e,{type:"q",key:"attrDim",data:t.legendDataset.raw(),config:{localeInfo:n.localeInfo}}]:[e]},legend:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.eventName,r=t.key,a=t.viewState,o=t.chart,s=t.rtl,c=t.styleReference,u=void 0===c?"object.legend":c,l=arguments.length>1?arguments[1]:void 0;return zp({eventName:e,key:r,rtl:s,viewState:a,chart:o,styleReference:u},{legendProps:n.legendProps,scaleKey:n.key,coloring:i(),senseTheme:n.senseTheme,hc:n.hc,scales:this.scales()},l)}};return a}var Fp={fill:"steelblue",num:1},Lp=function(t,e,n){var r=0,i=0,a=0,o={},s=0;"labelCenter"===t?(r=e.bottomLeft.x,i=e.topRight.y,a=e.bottomRight.x-e.bottomLeft.x,s=e.bottomRight.y-e.topRight.y,o={share:n.share,fill:n.fill}):(r=180/Math.PI*Math.atan((e.bottomRight.y-e.topRight.y)/(e.topRight.x-e.bottomRight.x))<15?e.topRight.x:(e.topRight.x-e.bottomRight.x)/2+e.bottomRight.x+15,i=e.topRight.y,a=e.width-r,s=e.bottomRight.y-e.topRight.y,o={fill:n.fill});return{tag:t,type:"rect",x:r,y:i,width:a,height:s,data:n.data,desc:o,fill:"none"}},Bp=function(t,e){var n,r,i,a=(r=(n=t)[0].num,i=0,n.slice().reverse().map(function(t){var e={datum:t,s:i/r,e:t.num/r};return i=t.num,e}).reverse()),o=.9*e.width,s=.9*e.height,c=(e.width-o)/2,u=(e.height-s)/2,l=o-(o>150&&s>150?100:0),h=(s-1*(a.length-1))/a.length,f=[];return a.forEach(function(t,n){var r,i,o=(r=t.e,i=n<a.length-1?t.s:t.e,[.5-.5*r,.5+.5*r,.5+.5*i,.5-.5*i]).map(function(t){return Math.round(t*l+c)}),s=h*n+1*n+u,d={bottomRight:{x:o[2],y:Math.round(s+h)},bottomLeft:{x:o[3],y:Math.round(s+h)},topRight:{x:o[1],y:Math.round(s)},topLeft:{x:o[0],y:Math.round(s)},width:e.width},p="M".concat(d.topLeft.x,",").concat(d.topLeft.y," L").concat(d.topRight.x,",").concat(d.topRight.y," ").concat(d.bottomRight.x,",").concat(d.bottomRight.y," ").concat(d.bottomLeft.x,",").concat(d.bottomLeft.y,"Z");f.push({tag:"section",type:"path",d:p,data:t.datum.data,fill:t.datum.fill});var g={share:t.e,fill:t.datum.fill,data:t.datum.data};h>12&&(d.bottomRight.x-d.bottomLeft.x>32&&f.push(Lp("labelCenter",d,g)),f.push(Lp("labelLeft",d,g)))}),f},Wp=function(t,e,n,r){return(r-t)/r*(e-n)+n},Vp=function(t,e,n){var r=t.filter(function(t){return"NaN"!==t.num&&t.num>0}),i=r.length,a=.9*n.width,o=.9*n.height,s=Math.round((n.width-a)/2),c=Math.round((n.height-o)/2),u=a-(a>150&&o>150?100:0),l=o-1*(i-1),h=[],f=r[0].data.num.value,d=c;return r.forEach(function(t,r){var i=e[r]*l,a=Math.round(Wp(d-c,u,.2*u,o)/2),p=Math.round(Wp(d-c+i,u,.2*u,o)/2),g=s+Math.round(u/2),y={bottomRight:{x:g+p,y:Math.round(d+i)},bottomLeft:{x:g-p,y:Math.round(d+i)},topRight:{x:g+a,y:d},topLeft:{x:g-a,y:d},width:n.width},v="M".concat(y.topLeft.x,",").concat(y.topLeft.y," L").concat(y.topRight.x,",").concat(y.topRight.y," ").concat(y.bottomRight.x,",").concat(y.bottomRight.y," ").concat(y.bottomLeft.x,",").concat(y.bottomLeft.y,"Z");h.push({tag:"section",type:"path",d:v,data:t.data,fill:t.fill});var m={share:t.data.num.value/f,fill:t.fill,data:t.data};i>2&&(y.bottomRight.x-y.bottomLeft.x>32&&h.push(Lp("labelCenter",y,m)),h.push(Lp("labelLeft",y,m))),d+=i+1}),h},Hp=function(t,e,n){var r=t.filter(function(t){return"NaN"!==t.num&&t.num>0});if(r&&r.length>0)switch(e){case"WIDTH":return Bp(r,n);case"ORDER":return Vp(r,r.map(function(){return 1/r.length}),n);case"HEIGHT":return Vp(r,function(t){var e=t.reduce(function(t,e){return t+e.data.num.value},0);return t.map(function(t){return t.data.num.value/e})}(r),n);case"AREA":return Vp(r,function(t,e,n){for(var r=t.reduce(function(t,e){return t+e.data.num.value},0),i=.9*e.width,a=.9*e.height,o=i*n,s=a*(i+o)/2,c=(i-o)/2/a,u=[],l=0,h=t.length-1;h>=0;h--){var f=t[h].data.num.value/r,d=2*c*l+o,p=-d/(2*c)+Math.sqrt(d*d/(4*c*c)+f*s/c);u[h]=p/a,l+=p}return u}(r,n,.2),n);default:return Bp(r,n)}return[]},Up={require:["resolver"],defaultSettings:{settings:{},data:{},style:{item:"$shape"}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(t){var e=t.data,n=this.resolver.resolve({data:e,defaults:Sd()({},Fp,this.style.item),settings:this.settings.settings});return Hp(n.items,this.settings.settings.mode,this.rect)}},$p=Math.PI/180,Yp=180/Math.PI,Xp=.96422,Kp=1,Gp=.82521,Zp=4/29,Jp=6/29,Qp=3*Jp*Jp,tg=Jp*Jp*Jp;function eg(t){if(t instanceof ng)return new ng(t.l,t.a,t.b,t.opacity);if(t instanceof ug){if(isNaN(t.h))return new ng(t.l,0,0,t.opacity);var e=t.h*$p;return new ng(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Jd||(t=Gd(t));var n,r,i=og(t.r),a=og(t.g),o=og(t.b),s=rg((.2225045*i+.7168786*a+.0606169*o)/Kp);return i===a&&a===o?n=r=s:(n=rg((.4360747*i+.3850649*a+.1430804*o)/Xp),r=rg((.0139322*i+.0971045*a+.7141733*o)/Gp)),new ng(116*s-16,500*(n-s),200*(s-r),t.opacity)}function ng(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function rg(t){return t>tg?Math.pow(t,1/3):t/Qp+Zp}function ig(t){return t>Jp?t*t*t:Qp*(t-Zp)}function ag(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function og(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function sg(t){if(t instanceof ug)return new ug(t.h,t.c,t.l,t.opacity);if(t instanceof ng||(t=eg(t)),0===t.a&&0===t.b)return new ug(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Yp;return new ug(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function cg(t,e,n,r){return 1===arguments.length?sg(t):new ug(t,e,n,null==r?1:r)}function ug(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function lg(t){var e=t.node.desc&&t.node.desc.share;return e?t.formatter("share")(e):""}function hg(t){return t.formatter("num")(t.node.data.num.value)}function fg(t){var e=t.data;return e?e.label:""}function dg(t){var e=function(e){return{component:"fun",selector:e,strategy:{type:"rows",settings:{align:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,fill:".labelCenter"===e?function(t){var e=t.node;return cg(e.desc.fill).l<70?"#fff":"#444"}:"#444",labels:".labelCenter"===e?[{label:function(t){if(t.dataPoint.auto)return lg;switch(t.dataPoint.labelMode){case"share":return lg;case"value":return hg;case"none":return null;default:return lg}}(t)}]:[{label:fg}]}}}};return{key:"funnel-labels",type:"labels",displayOrder:2,settings:{sources:[e(".labelLeft",0),e(".labelCenter",.5)]}}}Ed(ng,function(t,e,n,r){return 1===arguments.length?eg(t):new ng(t,e,n,null==r?1:r)},Dd(zd,{brighter:function(t){return new ng(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ng(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Jd(ag(3.1338561*(e=Xp*ig(e))-1.6168667*(t=Kp*ig(t))-.4906146*(n=Gp*ig(n))),ag(-.9787684*e+1.9161415*t+.033454*n),ag(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ed(ug,cg,Dd(zd,{brighter:function(t){return new ug(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ug(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return eg(this).rgb()}}));function pg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gg=function(t,e){var n=e.colorModel.datumProps(),r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};return Sd()(e,t.colorModel.scales()),e}(e),i=e.colorModel.color();return{palettes:e.colorModel.palettes(),scales:r,components:[{type:"funnel",key:"fun",data:{extract:{field:"qDimensionInfo/0",props:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){pg(t,e,n[e])})}return t}({num:{field:"qMeasureInfo/0"}},n)}},brush:e.actions.select.enabled()?{trigger:[{contexts:["selection"],data:[""]}],consume:[{context:"selection",filter:function(t){return"section"===t.tag},style:{inactive:{opacity:.3}}}]}:{},settings:{num:{ref:"num"},fill:i,mode:t.funnel.mode}},dg(t),function(t){if(!t.showDimensionTitle||!t.qHyperCube.qDimensionInfo[0].qFallbackTitle)return!1;return{key:"dimension-title",type:"text",text:t.qHyperCube.qDimensionInfo[0].qFallbackTitle,dock:"top",style:{text:{fontFamily:"QlikView Sans",fontSize:"15px"}}}}(t)],formatters:{share:{type:"d3-number",format:".1%"},num:{data:{field:"qMeasureInfo/0"}}}}},yg={qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:2,qHeight:5e3}],qSuppressZero:!1,qSuppressMissing:!0},showTitles:!0,title:"",subtitle:"",footnote:"",color:{auto:!0,mode:"primary",singleColor:3,paletteColor:{index:6,color:void 0},persistent:!1,useDimColVal:!0,expressionLabel:"",expressionIsColor:!0,measureScheme:"sg",reverseScheme:!1,dimensionScheme:"12",dimensionId:void 0,autoMinMax:!0,measureMin:void 0,measureMax:void 0,useBaseColors:"off"},funnel:{mode:"WIDTH"},showDimensionTitle:!0,dataPoint:{auto:!0,labelMode:"share"}};function vg(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mg(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xg=n(1),bg=n.n(xg);function wg(t){return(wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kg(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mg(t){return(Mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _g(t){return(_g="function"==typeof Symbol&&"symbol"===Mg(Symbol.iterator)?function(t){return Mg(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":Mg(t)})(t)}function Sg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Sg(t,e,n[e])})}return t}var Ag=Object.prototype.hasOwnProperty,Cg=Object.prototype.toString,Ng=Object.defineProperty,Og=Object.getOwnPropertyDescriptor,Tg=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Cg.call(t)},Eg=function(t){if(!t||"[object Object]"!==Cg.call(t))return!1;var e,n=Ag.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Ag.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||Ag.call(t,e)},Dg=function(t,e){Ng&&"__proto__"===e.name?Ng(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},zg=function(t,e){if("__proto__"===e){if(!Ag.call(t,e))return;if(Og)return Og(t,e).value}return t[e]},jg=function t(){var e,n,r,i,a,o,s=arguments[0],c=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},c=2),(null==s||"object"!==_g(s)&&"function"!=typeof s)&&(s={});c<u;++c)if(null!=(e=arguments[c]))for(n in e)r=zg(s,n),s!==(i=zg(e,n))&&(l&&i&&(Eg(i)||(a=Tg(i)))?(a?(a=!1,o=r&&Tg(r)?r:[]):o=r&&Eg(r)?r:{},Dg(s,{name:n,newValue:t(l,o,i)})):void 0!==i&&Dg(s,{name:n,newValue:i}));return s},qg={};function Pg(){Pg.init.call(this)}qg.isObject=function(t){return"object"===_g(t)&&null!==t},qg.isNumber=function(t){return"number"==typeof t},qg.isUndefined=function(t){return void 0===t},qg.isFunction=function(t){return"function"==typeof t};var Ig=Pg;Pg.EventEmitter=Pg,Pg.prototype._events=void 0,Pg.prototype._maxListeners=void 0,Pg.defaultMaxListeners=10,Pg.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},Pg.prototype.setMaxListeners=function(t){if(!qg.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Pg.prototype.emit=function(t){var e,n,r,i,a,o;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],qg.isUndefined(n))return!1;if(qg.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];n.apply(this,i)}else if(qg.isObject(n)){for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];for(r=(o=n.slice()).length,a=0;a<r;a++)o[a].apply(this,i)}return!0},Pg.prototype.addListener=function(t,e){var n;if(!qg.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,qg.isFunction(e.listener)?e.listener:e),this._events[t]?qg.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,qg.isObject(this._events[t])&&!this._events[t].warned)&&((n=qg.isUndefined(this._maxListeners)?Pg.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,qg.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),qg.isFunction(console.trace)&&console.trace()));return this},Pg.prototype.on=Pg.prototype.addListener,Pg.prototype.once=function(t,e){if(!qg.isFunction(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},Pg.prototype.removeListener=function(t,e){var n,r,i,a;if(!qg.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||qg.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(qg.isObject(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Pg.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],qg.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},Pg.prototype.listeners=function(t){return this._events&&this._events[t]?qg.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},Pg.listenerCount=function(t,e){return t._events&&t._events[e]?qg.isFunction(t._events[e])?1:t._events[e].length:0};var Fg=function(t){return function(e){var n,r=(n=jg(!0,{},e,{action:function(){"function"==typeof e.action&&e.action.call(r,t),r.emit("changed")},enabled:function(){return"function"!=typeof e.enabled||e.enabled.call(r,t)},active:"function"==typeof e.active?function(){return e.active.call(r,t)}:void 0}),Object.keys(Ig.prototype).forEach(function(t){n[t]=Ig.prototype[t]}),Ig.init(n),n);return r}};var Lg={app:null,model:null,actions:null,selections:null,created:function(){},mounted:function(){},render:function(){},resize:function(){},willUnmount:function(){},destroy:function(){},emit:function(){},getViewState:function(){},setSnapshotData:function(t){return Promise.resolve(t)}},Bg=Object.keys(Lg),Wg=function(t){return Object.keys(Ig.prototype).forEach(function(e){t[e]=Ig.prototype[e]}),Ig.init(t),t};function Vg(t,e){var n=Rg({},Lg);Wg(n);var r={emit:function(){n.emit.apply(n,arguments)}};Object.keys(t.component||{}).forEach(function(e){-1!==Bg.indexOf(e)?n[e]=t.component[e].bind(r):r[e]=t.component[e]});var i=function(t){var e=t.sn,n=t.component,r={},i=[],a=Fg(n);return((e.definition.selectionToolbar||{}).items||[]).forEach(function(t){var e=a(t);r[t.key]=e,i.push(e)}),(e.definition.actions||[]).forEach(function(t){var e=a(t);r[t.key]=e}),{actions:r,selectionToolbarItems:i,destroy:function(){i.length=0}}}({sn:t,component:r});return jg(r,{model:e.model,app:e.app,selections:e.selections,actions:i.actions}),jg(n,{actions:i.actions,model:e.model,app:e.app,selections:e.selections}),{generator:t,component:n,selectionToolbar:{items:i.selectionToolbarItems},logicalSize:t.definition.logicalSize||function(){return!1}}}var Hg={get:function(t){return"$$$".concat(t,"$$$")}},Ug=function(){};function $g(t,e){return void 0===t?function(){return e}:function(){return t}}function Yg(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{min:"function"==typeof t.min?t.min:$g(t.min,0),max:"function"==typeof t.max?t.max:$g(t.max,1e3),add:t.add||Ug,description:t.description||Ug,move:t.move||Ug,remove:t.remove||Ug,replace:t.replace||Ug}}function Xg(t){return{path:t.path||"/qHyperCubeDef",dimensions:Yg(t.dimensions),measures:Yg(t.measures)}}var Kg={type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{uses:"dimensions",items:{others:{items:{suppressOther:{defaultValue:!0,show:!1}}}},disabledRef:""},measures:{uses:"measures",disabledRef:""}}},settings:{uses:"settings",items:{presentation:{type:"items",label:"Presentation",grouped:!0,items:{funnelmode:{ref:"funnel.mode",label:"Funnel Mode",type:"string",component:"dropdown",options:[{value:"AREA",label:"Area"},{value:"HEIGHT",label:"Height"},{value:"WIDTH",label:"Width"},{value:"ORDER",label:"Ordering"}],defaultValue:"WIDTH"},dimensionTitle:{ref:"showDimensionTitle",type:"boolean",component:"switch",label:"Dimension label",defaultValue:!0,options:[{value:!0,label:"Auto"},{value:!1,label:"Off"}]},valuesAuto:{ref:"dataPoint.auto",type:"boolean",label:"Value labels",component:"switch",defaultValue:!0,options:[{value:!0,label:"Auto"},{value:!1,label:"Custom"}]},labelMode:{ref:"dataPoint.labelMode",type:"string",component:"dropdown",options:[{value:"none",label:"None"},{value:"share",label:"Share"},{value:"value",label:"Values"}],defaultValue:"share",show:function(t){return!t.dataPoint.auto}}}},colorsAndLegend:{uses:"colorsAndLegend",translation:"Colors",items:{colors:{items:{colorByLabel:{show:!1},expressionLabel:{show:!1}}},legend:{show:!1}}}}}}},Gg=function(t,e){var n,r=Rg({translator:Hg,Promise:Promise},e),i={qae:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{properties:Rg({},t.properties),data:{targets:((t.data||{}).targets||[]).map(Xg)}}}((n="function"==typeof t?t(r):t).qae),component:n.component||{},create:function(t){return Vg(i,t)},definition:{}};return Object.keys(n).forEach(function(t){i[t]||(i.definition[t]=n[t])}),i}(function(t){var e=gd({renderer:{prio:["canvas"]},style:{"$font-family":"QlikView Sans"}});return e.use(yd.a),e.component("funnel",Up),{qae:{properties:yg},actions:[{key:"select",isActive:!1,isEnabled:!0,action:function(){this.isActive=!this.isActive},enabled:function(){return this.isEnabled},active:function(){return this.isActive}}],component:{created:function(){this.colorModel=Ip({picasso:e,model:this.model,app:this.app,translator:t.translator,Promise:t.Promise})},mounted:function(t){this.chart=e.chart({element:t,data:[],settings:{}}),Md({selections:this.selections,brush:this.chart.brush("selection"),picassoQ:yd.a})},paint:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[{type:"q",key:"qHyperCube",data:e.qHyperCube}].concat(mg(this.colorModel.data())),i=gg(e,Sd()({model:this.model,app:this.app,selections:this.selections,actions:this.actions,colorModel:this.colorModel},n));return this.chart.update({data:r,settings:i}),t.Promise.resolve()},render:function(e){var n=this,r=e.layout,i=e.opts,a=void 0===i?{}:i;this.colorModel.config({senseTheme:a.theme,colorProps:r.color,layout:r,hc:r.qHyperCube,key:"fill"}),t.Promise.all([this.colorModel.getAuxiliarySettings()]).then(function(){return n.paint(r,a)})},destroy:function(){this.chart.destroy(),this.chart=null},setSnapshotData:function(e){if(e&&e.snapshotData){var n={chartData:{}},r=this.colorModel.settings();return this.colorModel.getAuxiliaryData(r).then(function(t){if(t)if("measure"===r.fieldType)n.chartData.measureGradient=t.coloring?t.coloring.gradient:void 0;else if("dimension"===r.fieldType){if(t[0]){var i=vg(t,1);n.chartData.legendDataPage=i[0]}t[1]&&(n.chartData.dimValsData=t[1].colorMap)}return e.snapshotData.content=n,e}).catch(function(){return e.snapshotData.content=n,e})}return t.Promise.resolve(e)}}}});e.default={initialProperties:Gg.qae.properties,definition:Kg,data:{dimensions:{min:1,max:1,description:function(){return"Segments"},add:function(t,e,n){n.setSorting([1,0])}},measures:{min:1,max:1,description:function(t){switch(t.funnel.mode){case"WIDTH":return"Width";case"AREA":return"Area";case"HEIGHT":return"Height";case"ORDER":return"Order";default:return""}},add:function(t,e,n){n.setSorting([1,0])}}},support:{snapshot:!0,exportData:!0,viewData:!1,export:!0},importProperties:null,exportProperties:null,mounted:function(t){var e=function(t){var e=function(t){return Object.keys(bg.a.prototype).forEach(function(e){t[e]=bg.a.prototype[e]}),bg.a.init(t),t};if(!t.backendApi.model.resetMadeSelections)return e({begin:function(){},clear:function(){},confirm:function(){},cancel:function(){},select:function(){},isActive:function(){}});var n={begin:function(){t.selectionsApi.activated(),t.backendApi.beginSelections(),n.emit("activated")},clear:function(){t.backendApi.model.resetMadeSelections()},confirm:function(){t.selectionsApi.confirm()},cancel:function(){t.selectionsApi.cancel()},select:function(e){var n,r=this;"resetMadeSelections"===e.method||t.selectionsApi.selectionsMade||t.backendApi.beginSelections(),(n=t.backendApi.model)[e.method].apply(n,kg(e.params)).then(function(e){e||(t.selectionsApi.selectionsMade=!1,r.clear())}),t.selectionsApi.selectionsMade="resetMadeSelections"!==e.method},isLocked:function(e){var n=[],r=e.filter(function(t){return"object"===wg(t.data)&&Array.isArray(t.data.fields)}).every(function(t){return t.data.fields.every(function(t){return!!t.raw().qLocked&&(n.push(t.raw()),!0)})});return r&&t.selectionsApi.notifyLockedSelections(n),r},isActive:function(){return t.selectionsApi.active},refreshToolbar:function(){t.selectionsApi.refreshToolbar()}};return e(n),t.selectionsApi.confirm=function(){t.backendApi.endSelections(!0).then(function(){t.selectionsApi.deactivated(),n.emit("deactivated")})},t.selectionsApi.clear=function(){t.backendApi.clearSelections(),t.selectionsApi.selectionsMade=!1,n.emit("cleared")},t.selectionsApi.cancel=function(){t.backendApi.endSelections(!1),t.selectionsApi.deactivated(),n.emit("canceled")},n}(this.$scope),n=Gg.create({model:this.backendApi.model,app:this.backendApi.model.session.app,selections:e});this.chart=n.component,this.chart.created({}),this.chart.mounted(t[0])},paint:function(t,e){var n=this;return this.chart.actions.select.isEnabled=1===this.options.interactionState&&!1!==this.options.selections,i.a.currApp(this).theme.getApplied().then(function(t){return n.chart.render({layout:e,opts:{rtl:"rtl"===n.options.direction,theme:t}})})},destroy:function(){this.chart&&this.chart.destroy()},getSelectionToolbar:function(){return[{name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:!0,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function(){this.selectionsApi.clear()},isDisabled:function(){return!this.selectionsApi.selectionsMade}}]},setSnapshotData:function(t){return this.chart.setSnapshotData(t)}}}])});
//# sourceMappingURL=qlik-funnel-chart-ext.js.map